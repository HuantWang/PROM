-----label-----
1
-----code-----
void CWE122_Heap_Based_Buffer_Overflow__c_CWE129_fgets_01_bad()
{
    int data;
    /* Initialize data */
    data = -1;
    {
        char inputBuffer[CHAR_ARRAY_SIZE] = "";
        /* POTENTIAL FLAW: Read data from the console using fgets() */
        if (fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin) != NULL)
        {
            /* Convert to int */
            data = atoi(inputBuffer);
        }
        else
        {
            printLine("fgets() failed.");
        }
    }
    {
        int i;
        int * buffer = (int *)malloc(10 * sizeof(int));
        if (buffer == NULL) {exit(-1);}
        /* initialize buffer */
        for (i = 0; i < 10; i++)
        {
            buffer[i] = 0;
        }
        /* POTENTIAL FLAW: Attempt to write to an index of the array that is above the upper bound
         * This code does check to see if the array index is negative */
        if (data >= 0)
        {
            buffer[data] = 1;
            /* Print the array values */
            for(i = 0; i < 10; i++)
            {
                printIntLine(buffer[i]);
            }
        }
        else
        {
            printLine("ERROR: Array index is negative.");
        }
        free(buffer);
    }
}
-----children-----
1,2
1,3
1,4
3,4
5,6
5,7
5,8
5,9
6,7
7,8
7,9
9,10
11,12
12,13
12,14
13,14
15,16
17,18
17,19
18,19
19,20
19,21
21,22
21,23
21,24
23,24
24,25
26,27
28,29
28,30
28,31
29,30
29,31
30,31
30,32
30,33
30,34
31,32
33,34
35,36
37,38
39,40
41,42
42,43
43,44
43,45
44,45
46,47
46,48
47,48
49,50
51,52
52,53
53,54
53,55
54,55
57,58
57,59
57,60
57,61
57,62
57,63
58,59
59,60
59,61
61,62
63,64
64,65
64,66
66,67
66,68
66,69
69,70
70,71
70,72
71,72
71,73
73,74
75,76
75,77
76,77
78,79
78,80
80,81
81,82
81,83
84,85
84,86
85,86
85,87
86,87
88,89
90,91
91,92
92,93
92,94
93,94
95,96
97,98
97,99
97,100
97,101
98,99
99,100
99,101
100,101
103,104
103,105
104,105
107,108
108,109
110,111
111,112
112,113
112,114
113,114
113,115
114,115
116,117
119,120
119,121
119,122
120,121
120,122
121,122
124,125
124,126
125,126
126,127
126,128
127,128
127,129
128,129
130,131
133,134
133,135
133,136
133,137
134,135
135,136
135,137
136,137
139,140
139,141
140,141
143,144
144,145
146,147
147,148
148,149
148,150
149,150
151,152
151,153
152,153
154,155
156,157
157,158
158,159
158,160
159,160
162,163
163,164
163,165
164,165
166,167
-----nextToken-----
2,4,8,10,14,16,20,22,25,27,32,34,36,38,40,45,48,50,55,56,60,62,65,67,68,72,74,77,79,82,83,87,89,94,96,101,102,105,106,109,115,117,118,122,123,129,131,132,137,138,141,142,145,150,153,155,160,161,165,167
-----computeFrom-----
12,13
12,14
29,30
29,31
43,44
43,45
78,79
78,80
85,86
85,87
99,100
99,101
103,104
103,105
112,113
112,114
120,121
120,122
126,127
126,128
135,136
135,137
139,140
139,141
-----guardedBy-----
34,50
122,131
-----guardedByNegation-----
-----lastLexicalUse-----
-----jump-----
-----attribute-----
FunctionDefinition;SimpleDeclSpecifier;FunctionDeclarator;Name;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;UnaryExpression;LiteralExpression;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;ArrayDeclarator;Name;ArrayModifier;IdExpression;Name;EqualsInitializer;LiteralExpression;IfStatement;BinaryExpression;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;IdExpression;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;LiteralExpression;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Name;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Pointer;Name;EqualsInitializer;CastExpression;TypeId;SimpleDeclSpecifier;Declarator;Pointer;FunctionCallExpression;IdExpression;Name;BinaryExpression;LiteralExpression;TypeIdExpression;TypeId;SimpleDeclSpecifier;Declarator;IfStatement;BinaryExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;UnaryExpression;LiteralExpression;ForStatement;ExpressionStatement;BinaryExpression;IdExpression;Name;LiteralExpression;BinaryExpression;IdExpression;Name;LiteralExpression;UnaryExpression;IdExpression;Name;CompoundStatement;ExpressionStatement;BinaryExpression;ArraySubscriptExpression;IdExpression;Name;IdExpression;Name;LiteralExpression;IfStatement;BinaryExpression;IdExpression;Name;LiteralExpression;CompoundStatement;ExpressionStatement;BinaryExpression;ArraySubscriptExpression;IdExpression;Name;IdExpression;Name;LiteralExpression;ForStatement;ExpressionStatement;BinaryExpression;IdExpression;Name;LiteralExpression;BinaryExpression;IdExpression;Name;LiteralExpression;UnaryExpression;IdExpression;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;ArraySubscriptExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;
-----ast_node-----
void CWE122_Heap_Based_Buffer_Overflow__c_CWE129_fgets_01_bad(){    int data;    /* Initialize data */    data = -1;    {        char inputBuffer[CHAR_ARRAY_SIZE] = "";        /* POTENTIAL FLAW: Read data from the console using fgets() */        if (fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin) != NULL)        {            /* Convert to int */            data = atoi(inputBuffer);        }        else        {            printLine("fgets() failed.");        }    }    {        int i;        int * buffer = (int *)malloc(10 * sizeof(int));        if (buffer == NULL) {exit(-1);}        /* initialize buffer */        for (i = 0; i < 10; i++)        {            buffer[i] = 0;        }        /* POTENTIAL FLAW: Attempt to write to an index of the array that is above the upper bound         * This code does check to see if the array index is negative */        if (data >= 0)        {            buffer[data] = 1;            /* Print the array values */            for(i = 0; i < 10; i++)            {                printIntLine(buffer[i]);            }        }        else        {            printLine("ERROR: Array index is negative.");        }        free(buffer);    }}
void
CWE122_Heap_Based_Buffer_Overflow__c_CWE129_fgets_01_bad()
CWE122_Heap_Based_Buffer_Overflow__c_CWE129_fgets_01_bad
{    int data;    /* Initialize data */    data = -1;    {        char inputBuffer[CHAR_ARRAY_SIZE] = "";        /* POTENTIAL FLAW: Read data from the console using fgets() */        if (fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin) != NULL)        {            /* Convert to int */            data = atoi(inputBuffer);        }        else        {            printLine("fgets() failed.");        }    }    {        int i;        int * buffer = (int *)malloc(10 * sizeof(int));        if (buffer == NULL) {exit(-1);}        /* initialize buffer */        for (i = 0; i < 10; i++)        {            buffer[i] = 0;        }        /* POTENTIAL FLAW: Attempt to write to an index of the array that is above the upper bound         * This code does check to see if the array index is negative */        if (data >= 0)        {            buffer[data] = 1;            /* Print the array values */            for(i = 0; i < 10; i++)            {                printIntLine(buffer[i]);            }        }        else        {            printLine("ERROR: Array index is negative.");        }        free(buffer);    }}
int data;
int data;
int
data
data
data = -1;
data = -1
data
data
-1
1
{        char inputBuffer[CHAR_ARRAY_SIZE] = "";        /* POTENTIAL FLAW: Read data from the console using fgets() */        if (fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin) != NULL)        {            /* Convert to int */            data = atoi(inputBuffer);        }        else        {            printLine("fgets() failed.");        }    }
char inputBuffer[CHAR_ARRAY_SIZE] = "";
char inputBuffer[CHAR_ARRAY_SIZE] = "";
char
inputBuffer[CHAR_ARRAY_SIZE] = ""
inputBuffer
[CHAR_ARRAY_SIZE]
CHAR_ARRAY_SIZE
CHAR_ARRAY_SIZE
= ""
""
if (fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin) != NULL)        {            /* Convert to int */            data = atoi(inputBuffer);        }        else        {            printLine("fgets() failed.");        }
fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin) != NULL
fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin)
fgets
fgets
inputBuffer
inputBuffer
CHAR_ARRAY_SIZE
CHAR_ARRAY_SIZE
stdin
stdin
NULL
NULL
{            /* Convert to int */            data = atoi(inputBuffer);        }
data = atoi(inputBuffer);
data = atoi(inputBuffer)
data
data
atoi(inputBuffer)
atoi
atoi
inputBuffer
inputBuffer
{            printLine("fgets() failed.");        }
printLine("fgets() failed.");
printLine("fgets() failed.")
printLine
printLine
"fgets() failed."
{        int i;        int * buffer = (int *)malloc(10 * sizeof(int));        if (buffer == NULL) {exit(-1);}        /* initialize buffer */        for (i = 0; i < 10; i++)        {            buffer[i] = 0;        }        /* POTENTIAL FLAW: Attempt to write to an index of the array that is above the upper bound         * This code does check to see if the array index is negative */        if (data >= 0)        {            buffer[data] = 1;            /* Print the array values */            for(i = 0; i < 10; i++)            {                printIntLine(buffer[i]);            }        }        else        {            printLine("ERROR: Array index is negative.");        }        free(buffer);    }
int i;
int i;
int
i
i
int * buffer = (int *)malloc(10 * sizeof(int));
int * buffer = (int *)malloc(10 * sizeof(int));
int
* buffer = (int *)malloc(10 * sizeof(int))
*
buffer
= (int *)malloc(10 * sizeof(int))
(int *)malloc(10 * sizeof(int))
int *
int
*
*
malloc(10 * sizeof(int))
malloc
malloc
10 * sizeof(int)
10
sizeof(int)
int
int

if (buffer == NULL) {exit(-1);}
buffer == NULL
buffer
buffer
NULL
NULL
{exit(-1);}
exit(-1);
exit(-1)
exit
exit
-1
1
for (i = 0; i < 10; i++)        {            buffer[i] = 0;        }
i = 0;
i = 0
i
i
0
i < 10
i
i
10
i++
i
i
{            buffer[i] = 0;        }
buffer[i] = 0;
buffer[i] = 0
buffer[i]
buffer
buffer
i
i
0
if (data >= 0)        {            buffer[data] = 1;            /* Print the array values */            for(i = 0; i < 10; i++)            {                printIntLine(buffer[i]);            }        }        else        {            printLine("ERROR: Array index is negative.");        }
data >= 0
data
data
0
{            buffer[data] = 1;            /* Print the array values */            for(i = 0; i < 10; i++)            {                printIntLine(buffer[i]);            }        }
buffer[data] = 1;
buffer[data] = 1
buffer[data]
buffer
buffer
data
data
1
for(i = 0; i < 10; i++)            {                printIntLine(buffer[i]);            }
i = 0;
i = 0
i
i
0
i < 10
i
i
10
i++
i
i
{                printIntLine(buffer[i]);            }
printIntLine(buffer[i]);
printIntLine(buffer[i])
printIntLine
printIntLine
buffer[i]
buffer
buffer
i
i
{            printLine("ERROR: Array index is negative.");        }
printLine("ERROR: Array index is negative.");
printLine("ERROR: Array index is negative.")
printLine
printLine
"ERROR: Array index is negative."
free(buffer);
free(buffer)
free
free
buffer
buffer
-----joern-----
(82,49,0)
(59,61,0)
(53,67,0)
(35,81,0)
(73,57,0)
(52,18,0)
(34,69,0)
(26,34,0)
(3,52,0)
(49,12,0)
(89,64,0)
(2,0,0)
(76,0,0)
(17,28,0)
(62,40,0)
(88,64,0)
(30,35,0)
(25,14,0)
(84,44,0)
(79,86,0)
(45,5,0)
(61,13,0)
(72,73,0)
(39,14,0)
(13,61,0)
(47,14,0)
(69,64,0)
(28,17,0)
(63,68,0)
(52,81,0)
(81,80,0)
(89,69,0)
(83,18,0)
(71,13,0)
(64,57,0)
(70,41,0)
(18,73,0)
(90,32,0)
(35,12,0)
(25,69,0)
(29,64,0)
(10,25,0)
(12,57,0)
(45,21,0)
(75,12,0)
(79,81,0)
(12,49,0)
(19,81,0)
(25,41,0)
(43,65,0)
(55,35,0)
(36,61,0)
(51,79,0)
(48,89,0)
(16,0,0)
(69,28,0)
(85,42,0)
(79,12,0)
(54,53,0)
(68,9,0)
(40,32,0)
(38,69,0)
(27,25,0)
(24,69,0)
(23,40,0)
(20,42,0)
(38,41,0)
(46,34,0)
(4,2,0)
(33,86,0)
(42,14,0)
(86,65,0)
(79,69,0)
(58,77,0)
(38,0,0)
(74,18,0)
(59,28,0)
(50,64,0)
(61,59,0)
(41,15,0)
(84,38,0)
(78,64,0)
(38,84,0)
(60,38,0)
(56,38,0)
(6,57,0)
(32,40,0)
(22,40,0)
(5,45,0)
(40,18,0)
(28,69,0)
(28,59,0)
(8,47,0)
(37,73,0)
(1,77,0)
(81,52,0)
(87,79,0)
(7,14,0)
(31,64,0)
(66,5,0)
(77,0,0)
(45,5,1)
(30,42,1)
(84,38,1)
(34,69,1)
(53,54,1)
(61,13,1)
(76,86,1)
(4,84,1)
(38,69,1)
(49,82,1)
(24,81,1)
(51,87,1)
(0,16,1)
(8,41,1)
(22,18,1)
(77,0,1)
(2,4,1)
(79,69,1)
(47,14,1)
(25,27,1)
(42,20,1)
(39,7,1)
(3,19,1)
(35,12,1)
(38,0,1)
(52,3,1)
(66,34,1)
(74,83,1)
(89,69,1)
(38,41,1)
(54,35,1)
(89,48,1)
(38,60,1)
(32,40,1)
(81,52,1)
(14,39,1)
(87,35,1)
(27,10,1)
(48,77,1)
(85,47,1)
(19,32,1)
(47,8,1)
(71,36,1)
(46,26,1)
(35,55,1)
(5,66,1)
(33,79,1)
(56,77,1)
(86,33,1)
(25,14,1)
(41,70,1)
(13,71,1)
(34,46,1)
(68,63,1)
(26,69,1)
(55,30,1)
(79,81,1)
(25,69,1)
(10,42,1)
(59,61,1)
(32,90,1)
(36,24,1)
(79,51,1)
(79,12,1)
(52,18,1)
(7,34,1)
(63,32,1)
(60,56,1)
(20,85,1)
(18,74,1)
(69,28,1)
(42,14,1)
(7,45,1)
(11,89,1)
(62,23,1)
(16,76,1)
(58,0,1)
(24,68,1)
(2,0,1)
(23,22,1)
(85,14,1)
(48,53,1)
(82,75,1)
(58,2,1)
(40,62,1)
(35,81,1)
(1,58,1)
(70,25,1)
(12,49,1)
(28,17,1)
(77,1,1)
(40,18,1)
(83,12,1)
(90,40,1)
(28,59,1)
(38,77,2)
(12,49,2)
(4,77,2)
(70,42,2)
(28,17,2)
(1,77,2)
(3,32,2)
(76,35,2)
(16,35,2)
(79,69,2)
(56,77,2)
(61,13,2)
(20,42,2)
(2,77,2)
(51,35,2)
(89,69,2)
(25,69,2)
(42,42,2)
(0,35,2)
(38,41,2)
(38,69,2)
(28,59,2)
(27,42,2)
(35,12,2)
(79,12,2)
(8,42,2)
(69,28,2)
(77,35,2)
(84,38,2)
(54,35,2)
(81,52,2)
(10,42,2)
(81,32,2)
(52,18,2)
(32,40,2)
(77,0,2)
(87,35,2)
(68,32,2)
(41,42,2)
(45,34,2)
(33,35,2)
(66,34,2)
(79,35,2)
(52,32,2)
(35,81,2)
(53,35,2)
(38,0,2)
(25,14,2)
(47,14,2)
(40,18,2)
(58,77,2)
(59,61,2)
(84,77,2)
(60,77,2)
(2,0,2)
(58,35,2)
(19,32,2)
(5,34,2)
(42,14,2)
(25,42,2)
(1,35,2)
(45,5,2)
(86,35,2)
(63,32,2)
(77,77,2)
(85,42,2)
(47,42,2)
(34,69,2)
(79,81,2)
-----------------------------------
(0,i = 0)
(1,10)
(2,i++)
(3,inputBuffer)
(4,i)
(5,-1)
(6,data)
(7,i)
(8,i)
(9,)
(10,buffer)
(11,RET)
(12,data = -1)
(13,sizeof(int)
(14,i = 0)
(15,)
(16,0)
(17,int *)
(18,inputBuffer[CHAR_ARRAY_SIZE] = "")
(19,data)
(20,10)
(21,)
(22,inputBuffer)
(23,CHAR_ARRAY_SIZE)
(24,buffer)
(25,buffer[i])
(26,buffer)
(27,i)
(28,(int *)
(29,for (i = 0; i < 10; i++)
(30,data)
(31,i)
(32,fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin)
(33,1)
(34,buffer == NULL)
(35,data >= 0)
(36,10)
(37,if (fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin)
(38,buffer[i])
(39,0)
(40,fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin)
(41,buffer[i] = 0)
(42,i < 10)
(43,for(i = 0; i < 10; i++)
(44,)
(45,exit(-1)
(46,NULL)
(47,i++)
(48,buffer)
(49,-1)
(50,if (data >= 0)
(51,data)
(52,atoi(inputBuffer)
(53,printLine("ERROR: Array index is negative.")
(54,"ERROR: Array index is negative.")
(55,0)
(56,buffer)
(57,)
(58,i)
(59,malloc(10 * sizeof(int)
(60,i)
(61,10 * sizeof(int)
(62,stdin)
(63,"fgets()
(64,)
(65,)
(66,1)
(67,)
(68,printLine("fgets()
(69,* buffer = (int *)
(70,0)
(71,int)
(72,inputBuffer)
(73,)
(74,"")
(75,data)
(76,i)
(77,i < 10)
(78,buffer)
(79,buffer[data])
(80,)
(81,data = atoi(inputBuffer)
(82,1)
(83,inputBuffer)
(84,printIntLine(buffer[i])
(85,i)
(86,buffer[data] = 1)
(87,buffer)
(88,if (buffer == NULL)
(89,free(buffer)
(90,NULL)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^