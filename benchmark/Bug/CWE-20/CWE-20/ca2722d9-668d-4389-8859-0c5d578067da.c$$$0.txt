-----label-----
1
-----code-----
void CWE122_Heap_Based_Buffer_Overflow__c_CWE129_fscanf_16_bad()
{
    int data;
    /* Initialize data */
    data = -1;
    while(1)
    {
        /* POTENTIAL FLAW: Read data from the console using fscanf() */
        fscanf(stdin, "%d", &data);
        break;
    }
    while(1)
    {
        {
            int i;
            int * buffer = (int *)malloc(10 * sizeof(int));
            if (buffer == NULL) {exit(-1);}
            /* initialize buffer */
            for (i = 0; i < 10; i++)
            {
                buffer[i] = 0;
            }
            /* POTENTIAL FLAW: Attempt to write to an index of the array that is above the upper bound
             * This code does check to see if the array index is negative */
            if (data >= 0)
            {
                buffer[data] = 1;
                /* Print the array values */
                for(i = 0; i < 10; i++)
                {
                    printIntLine(buffer[i]);
                }
            }
            else
            {
                printLine("ERROR: Array index is negative.");
            }
            free(buffer);
        }
        break;
    }
}
-----children-----
1,2
1,3
1,4
3,4
5,6
5,7
5,8
5,9
6,7
7,8
7,9
9,10
11,12
12,13
12,14
13,14
15,16
17,18
17,19
19,20
19,21
20,21
21,22
21,23
21,24
21,25
22,23
24,25
27,28
28,29
31,32
31,33
33,34
33,35
34,35
34,36
34,37
34,38
34,39
34,40
35,36
36,37
36,38
38,39
40,41
41,42
41,43
43,44
43,45
43,46
46,47
47,48
47,49
48,49
48,50
50,51
52,53
52,54
53,54
55,56
55,57
57,58
58,59
58,60
61,62
61,63
62,63
62,64
63,64
65,66
67,68
68,69
69,70
69,71
70,71
72,73
74,75
74,76
74,77
74,78
75,76
76,77
76,78
77,78
80,81
80,82
81,82
84,85
85,86
87,88
88,89
89,90
89,91
90,91
90,92
91,92
93,94
96,97
96,98
96,99
97,98
97,99
98,99
101,102
101,103
102,103
103,104
103,105
104,105
104,106
105,106
107,108
110,111
110,112
110,113
110,114
111,112
112,113
112,114
113,114
116,117
116,118
117,118
120,121
121,122
123,124
124,125
125,126
125,127
126,127
128,129
128,130
129,130
131,132
133,134
134,135
135,136
135,137
136,137
139,140
140,141
140,142
141,142
143,144
-----nextToken-----
2,4,8,10,14,16,18,23,25,26,29,30,32,37,39,42,44,45,49,51,54,56,59,60,64,66,71,73,78,79,82,83,86,92,94,95,99,100,106,108,109,114,115,118,119,122,127,130,132,137,138,142,144,145
-----computeFrom-----
12,13
12,14
55,56
55,57
62,63
62,64
76,77
76,78
80,81
80,82
89,90
89,91
97,98
97,99
103,104
103,105
112,113
112,114
116,117
116,118
-----guardedBy-----
99,108
-----guardedByNegation-----
-----lastLexicalUse-----
-----jump-----
-----attribute-----
FunctionDefinition;SimpleDeclSpecifier;FunctionDeclarator;Name;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;UnaryExpression;LiteralExpression;WhileStatement;LiteralExpression;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;LiteralExpression;UnaryExpression;IdExpression;Name;BreakStatement;WhileStatement;LiteralExpression;CompoundStatement;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Name;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Pointer;Name;EqualsInitializer;CastExpression;TypeId;SimpleDeclSpecifier;Declarator;Pointer;FunctionCallExpression;IdExpression;Name;BinaryExpression;LiteralExpression;TypeIdExpression;TypeId;SimpleDeclSpecifier;Declarator;IfStatement;BinaryExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;UnaryExpression;LiteralExpression;ForStatement;ExpressionStatement;BinaryExpression;IdExpression;Name;LiteralExpression;BinaryExpression;IdExpression;Name;LiteralExpression;UnaryExpression;IdExpression;Name;CompoundStatement;ExpressionStatement;BinaryExpression;ArraySubscriptExpression;IdExpression;Name;IdExpression;Name;LiteralExpression;IfStatement;BinaryExpression;IdExpression;Name;LiteralExpression;CompoundStatement;ExpressionStatement;BinaryExpression;ArraySubscriptExpression;IdExpression;Name;IdExpression;Name;LiteralExpression;ForStatement;ExpressionStatement;BinaryExpression;IdExpression;Name;LiteralExpression;BinaryExpression;IdExpression;Name;LiteralExpression;UnaryExpression;IdExpression;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;ArraySubscriptExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;BreakStatement;
-----ast_node-----
void CWE122_Heap_Based_Buffer_Overflow__c_CWE129_fscanf_16_bad(){    int data;    /* Initialize data */    data = -1;    while(1)    {        /* POTENTIAL FLAW: Read data from the console using fscanf() */        fscanf(stdin, "%d", &data);        break;    }    while(1)    {        {            int i;            int * buffer = (int *)malloc(10 * sizeof(int));            if (buffer == NULL) {exit(-1);}            /* initialize buffer */            for (i = 0; i < 10; i++)            {                buffer[i] = 0;            }            /* POTENTIAL FLAW: Attempt to write to an index of the array that is above the upper bound             * This code does check to see if the array index is negative */            if (data >= 0)            {                buffer[data] = 1;                /* Print the array values */                for(i = 0; i < 10; i++)                {                    printIntLine(buffer[i]);                }            }            else            {                printLine("ERROR: Array index is negative.");            }            free(buffer);        }        break;    }}
void
CWE122_Heap_Based_Buffer_Overflow__c_CWE129_fscanf_16_bad()
CWE122_Heap_Based_Buffer_Overflow__c_CWE129_fscanf_16_bad
{    int data;    /* Initialize data */    data = -1;    while(1)    {        /* POTENTIAL FLAW: Read data from the console using fscanf() */        fscanf(stdin, "%d", &data);        break;    }    while(1)    {        {            int i;            int * buffer = (int *)malloc(10 * sizeof(int));            if (buffer == NULL) {exit(-1);}            /* initialize buffer */            for (i = 0; i < 10; i++)            {                buffer[i] = 0;            }            /* POTENTIAL FLAW: Attempt to write to an index of the array that is above the upper bound             * This code does check to see if the array index is negative */            if (data >= 0)            {                buffer[data] = 1;                /* Print the array values */                for(i = 0; i < 10; i++)                {                    printIntLine(buffer[i]);                }            }            else            {                printLine("ERROR: Array index is negative.");            }            free(buffer);        }        break;    }}
int data;
int data;
int
data
data
data = -1;
data = -1
data
data
-1
1
while(1)    {        /* POTENTIAL FLAW: Read data from the console using fscanf() */        fscanf(stdin, "%d", &data);        break;    }
1
{        /* POTENTIAL FLAW: Read data from the console using fscanf() */        fscanf(stdin, "%d", &data);        break;    }
fscanf(stdin, "%d", &data);
fscanf(stdin, "%d", &data)
fscanf
fscanf
stdin
stdin
"%d"
&data
data
data
break;
while(1)    {        {            int i;            int * buffer = (int *)malloc(10 * sizeof(int));            if (buffer == NULL) {exit(-1);}            /* initialize buffer */            for (i = 0; i < 10; i++)            {                buffer[i] = 0;            }            /* POTENTIAL FLAW: Attempt to write to an index of the array that is above the upper bound             * This code does check to see if the array index is negative */            if (data >= 0)            {                buffer[data] = 1;                /* Print the array values */                for(i = 0; i < 10; i++)                {                    printIntLine(buffer[i]);                }            }            else            {                printLine("ERROR: Array index is negative.");            }            free(buffer);        }        break;    }
1
{        {            int i;            int * buffer = (int *)malloc(10 * sizeof(int));            if (buffer == NULL) {exit(-1);}            /* initialize buffer */            for (i = 0; i < 10; i++)            {                buffer[i] = 0;            }            /* POTENTIAL FLAW: Attempt to write to an index of the array that is above the upper bound             * This code does check to see if the array index is negative */            if (data >= 0)            {                buffer[data] = 1;                /* Print the array values */                for(i = 0; i < 10; i++)                {                    printIntLine(buffer[i]);                }            }            else            {                printLine("ERROR: Array index is negative.");            }            free(buffer);        }        break;    }
{            int i;            int * buffer = (int *)malloc(10 * sizeof(int));            if (buffer == NULL) {exit(-1);}            /* initialize buffer */            for (i = 0; i < 10; i++)            {                buffer[i] = 0;            }            /* POTENTIAL FLAW: Attempt to write to an index of the array that is above the upper bound             * This code does check to see if the array index is negative */            if (data >= 0)            {                buffer[data] = 1;                /* Print the array values */                for(i = 0; i < 10; i++)                {                    printIntLine(buffer[i]);                }            }            else            {                printLine("ERROR: Array index is negative.");            }            free(buffer);        }
int i;
int i;
int
i
i
int * buffer = (int *)malloc(10 * sizeof(int));
int * buffer = (int *)malloc(10 * sizeof(int));
int
* buffer = (int *)malloc(10 * sizeof(int))
*
buffer
= (int *)malloc(10 * sizeof(int))
(int *)malloc(10 * sizeof(int))
int *
int
*
*
malloc(10 * sizeof(int))
malloc
malloc
10 * sizeof(int)
10
sizeof(int)
int
int

if (buffer == NULL) {exit(-1);}
buffer == NULL
buffer
buffer
NULL
NULL
{exit(-1);}
exit(-1);
exit(-1)
exit
exit
-1
1
for (i = 0; i < 10; i++)            {                buffer[i] = 0;            }
i = 0;
i = 0
i
i
0
i < 10
i
i
10
i++
i
i
{                buffer[i] = 0;            }
buffer[i] = 0;
buffer[i] = 0
buffer[i]
buffer
buffer
i
i
0
if (data >= 0)            {                buffer[data] = 1;                /* Print the array values */                for(i = 0; i < 10; i++)                {                    printIntLine(buffer[i]);                }            }            else            {                printLine("ERROR: Array index is negative.");            }
data >= 0
data
data
0
{                buffer[data] = 1;                /* Print the array values */                for(i = 0; i < 10; i++)                {                    printIntLine(buffer[i]);                }            }
buffer[data] = 1;
buffer[data] = 1
buffer[data]
buffer
buffer
data
data
1
for(i = 0; i < 10; i++)                {                    printIntLine(buffer[i]);                }
i = 0;
i = 0
i
i
0
i < 10
i
i
10
i++
i
i
{                    printIntLine(buffer[i]);                }
printIntLine(buffer[i]);
printIntLine(buffer[i])
printIntLine
printIntLine
buffer[i]
buffer
buffer
i
i
{                printLine("ERROR: Array index is negative.");            }
printLine("ERROR: Array index is negative.");
printLine("ERROR: Array index is negative.")
printLine
printLine
"ERROR: Array index is negative."
free(buffer);
free(buffer)
free
free
buffer
buffer
break;
-----joern-----
(52,39,0)
(36,57,0)
(38,57,0)
(54,58,0)
(70,45,0)
(45,22,0)
(58,67,0)
(77,41,0)
(66,28,0)
(53,49,0)
(24,62,0)
(2,24,0)
(3,22,0)
(61,47,0)
(24,20,0)
(62,4,0)
(79,44,0)
(82,29,0)
(22,45,0)
(56,18,0)
(82,20,0)
(57,38,0)
(31,62,0)
(6,16,0)
(80,20,0)
(83,28,0)
(63,77,0)
(68,20,0)
(34,73,0)
(49,53,0)
(24,39,0)
(28,20,0)
(23,41,0)
(26,13,0)
(20,82,0)
(9,19,0)
(20,44,0)
(78,77,0)
(35,39,0)
(38,8,0)
(0,37,0)
(29,82,0)
(22,73,0)
(82,64,0)
(27,46,0)
(10,44,0)
(57,13,0)
(12,44,0)
(41,16,0)
(45,19,0)
(57,20,0)
(72,48,0)
(77,20,0)
(44,48,0)
(64,67,0)
(32,49,0)
(80,44,0)
(67,64,0)
(67,58,0)
(19,47,0)
(74,67,0)
(57,62,0)
(25,71,0)
(64,82,0)
(46,13,0)
(15,13,0)
(5,57,0)
(51,37,0)
(65,15,0)
(18,19,0)
(40,50,0)
(75,44,0)
(17,47,0)
(19,18,0)
(69,39,0)
(33,44,0)
(50,19,0)
(1,47,0)
(81,80,0)
(42,22,0)
(37,39,0)
(21,50,0)
(76,24,0)
(7,15,0)
(11,13,0)
(43,52,0)
(71,14,0)
(53,59,0)
(77,19,0)
(24,20,1)
(60,19,1)
(21,40,1)
(35,53,1)
(3,60,1)
(27,38,1)
(63,50,1)
(52,43,1)
(54,74,1)
(24,76,1)
(15,13,1)
(81,71,1)
(69,35,1)
(18,56,1)
(19,18,1)
(57,62,1)
(57,20,1)
(36,5,1)
(45,19,1)
(76,2,1)
(37,39,1)
(77,78,1)
(50,21,1)
(80,20,1)
(51,0,1)
(71,25,1)
(20,82,1)
(74,68,1)
(11,26,1)
(7,65,1)
(25,50,1)
(35,28,1)
(45,70,1)
(24,39,1)
(77,19,1)
(15,7,1)
(80,81,1)
(82,64,1)
(28,66,1)
(5,15,1)
(39,69,1)
(0,52,1)
(46,27,1)
(57,13,1)
(68,30,1)
(70,42,1)
(22,45,1)
(40,37,1)
(67,58,1)
(62,31,1)
(55,30,1)
(83,20,1)
(57,36,1)
(26,41,1)
(31,24,1)
(28,20,1)
(0,39,1)
(55,72,1)
(41,23,1)
(50,19,1)
(56,9,1)
(23,77,1)
(34,22,1)
(38,57,1)
(52,39,1)
(30,34,1)
(37,51,1)
(2,37,1)
(49,32,1)
(64,67,1)
(30,60,1)
(81,15,1)
(65,13,1)
(46,13,1)
(77,20,1)
(13,11,1)
(58,54,1)
(78,63,1)
(42,3,1)
(32,28,1)
(72,80,1)
(82,29,1)
(43,62,1)
(66,83,1)
(53,49,1)
(65,46,1)
(49,28,2)
(67,30,2)
(57,62,2)
(45,60,2)
(62,37,2)
(38,57,2)
(2,37,2)
(37,39,2)
(57,13,2)
(23,50,2)
(70,60,2)
(37,30,2)
(50,30,2)
(22,60,2)
(72,30,2)
(78,50,2)
(25,50,2)
(80,30,2)
(57,15,2)
(83,30,2)
(5,15,2)
(13,50,2)
(51,30,2)
(3,60,2)
(28,30,2)
(26,50,2)
(39,30,2)
(32,28,2)
(15,50,2)
(68,30,2)
(40,30,2)
(65,15,2)
(22,45,2)
(43,37,2)
(69,30,2)
(46,15,2)
(27,15,2)
(51,37,2)
(19,18,2)
(77,19,2)
(24,37,2)
(20,30,2)
(0,37,2)
(34,60,2)
(77,20,2)
(53,49,2)
(63,50,2)
(64,67,2)
(31,37,2)
(52,37,2)
(24,39,2)
(53,28,2)
(37,37,2)
(80,20,2)
(0,30,2)
(71,50,2)
(42,60,2)
(46,13,2)
(82,30,2)
(57,20,2)
(7,15,2)
(21,30,2)
(74,30,2)
(28,20,2)
(67,58,2)
(52,39,2)
(54,30,2)
(66,30,2)
(45,19,2)
(58,30,2)
(77,50,2)
(35,30,2)
(64,30,2)
(11,50,2)
(7,50,2)
(50,19,2)
(24,20,2)
(76,37,2)
(81,30,2)
(36,15,2)
(38,15,2)
(82,64,2)
(65,50,2)
(82,29,2)
(15,15,2)
(15,13,2)
(41,50,2)
(20,82,2)
-----------------------------------
(0,i)
(1,while(1)
(2,buffer)
(3,stdin)
(4,)
(5,buffer)
(6,for(i = 0; i < 10; i++)
(7,10)
(8,)
(9,data)
(10,i)
(11,0)
(12,for (i = 0; i < 10; i++)
(13,i = 0)
(14,)
(15,i < 10)
(16,)
(17,while(1)
(18,-1)
(19,data = -1)
(20,* buffer = (int *)
(21,0)
(22,fscanf(stdin, "%d", &data)
(23,1)
(24,buffer[i])
(25,"ERROR: Array index is negative.")
(26,i)
(27,i)
(28,buffer == NULL)
(29,int *)
(30,1)
(31,0)
(32,1)
(33,if (buffer == NULL)
(34,break;)
(35,i)
(36,i)
(37,i < 10)
(38,printIntLine(buffer[i])
(39,i = 0)
(40,data)
(41,buffer[data] = 1)
(42,"%d")
(43,i)
(44,)
(45,&data)
(46,i++)
(47,)
(48,)
(49,-1)
(50,data >= 0)
(51,10)
(52,i++)
(53,exit(-1)
(54,int)
(55,RET)
(56,1)
(57,buffer[i])
(58,sizeof(int)
(59,)
(60,1)
(61,data)
(62,buffer[i] = 0)
(63,buffer)
(64,malloc(10 * sizeof(int)
(65,i)
(66,NULL)
(67,10 * sizeof(int)
(68,buffer)
(69,0)
(70,data)
(71,printLine("ERROR: Array index is negative.")
(72,break;)
(73,)
(74,10)
(75,if (data >= 0)
(76,i)
(77,buffer[data])
(78,data)
(79,buffer)
(80,free(buffer)
(81,buffer)
(82,(int *)
(83,buffer)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^