-----label-----
1
-----code-----
void CWE127_Buffer_Underread__malloc_char_cpy_06_bad()
{
    char * data;
    data = NULL;
    if(STATIC_CONST_FIVE==5)
    {
        {
            char * dataBuffer = (char *)malloc(100*sizeof(char));
            if (dataBuffer == NULL) {exit(-1);}
            memset(dataBuffer, 'A', 100-1);
            dataBuffer[100-1] = '\0';
            /* FLAW: Set data pointer to before the allocated memory buffer */
            data = dataBuffer - 8;
        }
    }
    {
        char dest[100*2];
        memset(dest, 'C', 100*2-1); /* fill with 'C's */
        dest[100*2-1] = '\0'; /* null terminate */
        /* POTENTIAL FLAW: Possibly copy from a memory location located before the source buffer */
        strcpy(dest, data);
        printLine(dest);
        /* INCIDENTAL CWE-401: Memory Leak - data may not point to location
         * returned by malloc() so can't safely call free() on it */
    }
}
-----children-----
1,2
1,3
1,4
3,4
5,6
5,7
5,8
5,9
6,7
7,8
7,9
9,10
9,11
12,13
13,14
13,15
14,15
16,17
18,19
18,20
19,20
19,21
20,21
23,24
24,25
24,26
24,27
24,28
24,29
25,26
26,27
26,28
28,29
28,30
28,31
31,32
32,33
32,34
33,34
33,35
35,36
37,38
37,39
38,39
40,41
40,42
42,43
43,44
43,45
46,47
46,48
47,48
47,49
48,49
50,51
52,53
53,54
54,55
54,56
55,56
57,58
59,60
60,61
60,62
60,63
60,64
61,62
63,64
66,67
66,68
69,70
70,71
70,72
71,72
71,73
72,73
74,75
74,76
78,79
79,80
79,81
80,81
82,83
82,84
83,84
86,87
86,88
86,89
86,90
86,91
87,88
88,89
88,90
90,91
90,92
92,93
93,94
93,95
96,97
97,98
97,99
97,100
97,101
98,99
100,101
103,104
103,105
104,105
104,106
108,109
109,110
109,111
110,111
110,112
111,112
113,114
113,115
114,115
114,116
119,120
120,121
120,122
120,123
121,122
123,124
125,126
127,128
128,129
128,130
129,130
131,132
-----nextToken-----
2,4,8,10,11,15,17,21,22,27,29,30,34,36,39,41,44,45,49,51,56,58,62,64,65,67,68,73,75,76,77,81,84,85,89,91,94,95,99,101,102,105,106,107,112,115,116,117,118,122,124,126,130,132
-----computeFrom-----
13,14
13,15
19,20
19,21
40,41
40,42
47,48
47,49
66,67
66,68
70,71
70,72
74,75
74,76
79,80
79,81
82,83
82,84
93,94
93,95
103,104
103,105
104,105
104,106
109,110
109,111
113,114
113,115
114,115
114,116
-----guardedBy-----
-----guardedByNegation-----
-----lastLexicalUse-----
-----jump-----
-----attribute-----
FunctionDefinition;SimpleDeclSpecifier;FunctionDeclarator;Name;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Pointer;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;IdExpression;Name;IfStatement;BinaryExpression;IdExpression;Name;LiteralExpression;CompoundStatement;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Pointer;Name;EqualsInitializer;CastExpression;TypeId;SimpleDeclSpecifier;Declarator;Pointer;FunctionCallExpression;IdExpression;Name;BinaryExpression;LiteralExpression;TypeIdExpression;TypeId;SimpleDeclSpecifier;Declarator;IfStatement;BinaryExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;UnaryExpression;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;LiteralExpression;BinaryExpression;LiteralExpression;LiteralExpression;ExpressionStatement;BinaryExpression;ArraySubscriptExpression;IdExpression;Name;BinaryExpression;LiteralExpression;LiteralExpression;LiteralExpression;ExpressionStatement;BinaryExpression;IdExpression;Name;BinaryExpression;IdExpression;Name;LiteralExpression;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;ArrayDeclarator;Name;ArrayModifier;BinaryExpression;LiteralExpression;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;LiteralExpression;BinaryExpression;BinaryExpression;LiteralExpression;LiteralExpression;LiteralExpression;ExpressionStatement;BinaryExpression;ArraySubscriptExpression;IdExpression;Name;BinaryExpression;BinaryExpression;LiteralExpression;LiteralExpression;LiteralExpression;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;
-----ast_node-----
void CWE127_Buffer_Underread__malloc_char_cpy_06_bad(){    char * data;    data = NULL;    if(STATIC_CONST_FIVE==5)    {        {            char * dataBuffer = (char *)malloc(100*sizeof(char));            if (dataBuffer == NULL) {exit(-1);}            memset(dataBuffer, 'A', 100-1);            dataBuffer[100-1] = '\0';            /* FLAW: Set data pointer to before the allocated memory buffer */            data = dataBuffer - 8;        }    }    {        char dest[100*2];        memset(dest, 'C', 100*2-1); /* fill with 'C's */        dest[100*2-1] = '\0'; /* null terminate */        /* POTENTIAL FLAW: Possibly copy from a memory location located before the source buffer */        strcpy(dest, data);        printLine(dest);        /* INCIDENTAL CWE-401: Memory Leak - data may not point to location         * returned by malloc() so can't safely call free() on it */    }}
void
CWE127_Buffer_Underread__malloc_char_cpy_06_bad()
CWE127_Buffer_Underread__malloc_char_cpy_06_bad
{    char * data;    data = NULL;    if(STATIC_CONST_FIVE==5)    {        {            char * dataBuffer = (char *)malloc(100*sizeof(char));            if (dataBuffer == NULL) {exit(-1);}            memset(dataBuffer, 'A', 100-1);            dataBuffer[100-1] = '\0';            /* FLAW: Set data pointer to before the allocated memory buffer */            data = dataBuffer - 8;        }    }    {        char dest[100*2];        memset(dest, 'C', 100*2-1); /* fill with 'C's */        dest[100*2-1] = '\0'; /* null terminate */        /* POTENTIAL FLAW: Possibly copy from a memory location located before the source buffer */        strcpy(dest, data);        printLine(dest);        /* INCIDENTAL CWE-401: Memory Leak - data may not point to location         * returned by malloc() so can't safely call free() on it */    }}
char * data;
char * data;
char
* data
*
data
data = NULL;
data = NULL
data
data
NULL
NULL
if(STATIC_CONST_FIVE==5)    {        {            char * dataBuffer = (char *)malloc(100*sizeof(char));            if (dataBuffer == NULL) {exit(-1);}            memset(dataBuffer, 'A', 100-1);            dataBuffer[100-1] = '\0';            /* FLAW: Set data pointer to before the allocated memory buffer */            data = dataBuffer - 8;        }    }
STATIC_CONST_FIVE==5
STATIC_CONST_FIVE
STATIC_CONST_FIVE
5
{        {            char * dataBuffer = (char *)malloc(100*sizeof(char));            if (dataBuffer == NULL) {exit(-1);}            memset(dataBuffer, 'A', 100-1);            dataBuffer[100-1] = '\0';            /* FLAW: Set data pointer to before the allocated memory buffer */            data = dataBuffer - 8;        }    }
{            char * dataBuffer = (char *)malloc(100*sizeof(char));            if (dataBuffer == NULL) {exit(-1);}            memset(dataBuffer, 'A', 100-1);            dataBuffer[100-1] = '\0';            /* FLAW: Set data pointer to before the allocated memory buffer */            data = dataBuffer - 8;        }
char * dataBuffer = (char *)malloc(100*sizeof(char));
char * dataBuffer = (char *)malloc(100*sizeof(char));
char
* dataBuffer = (char *)malloc(100*sizeof(char))
*
dataBuffer
= (char *)malloc(100*sizeof(char))
(char *)malloc(100*sizeof(char))
char *
char
*
*
malloc(100*sizeof(char))
malloc
malloc
100*sizeof(char)
100
sizeof(char)
char
char

if (dataBuffer == NULL) {exit(-1);}
dataBuffer == NULL
dataBuffer
dataBuffer
NULL
NULL
{exit(-1);}
exit(-1);
exit(-1)
exit
exit
-1
1
memset(dataBuffer, 'A', 100-1);
memset(dataBuffer, 'A', 100-1)
memset
memset
dataBuffer
dataBuffer
'A'
100-1
100
1
dataBuffer[100-1] = '\0';
dataBuffer[100-1] = '\0'
dataBuffer[100-1]
dataBuffer
dataBuffer
100-1
100
1
'\0'
data = dataBuffer - 8;
data = dataBuffer - 8
data
data
dataBuffer - 8
dataBuffer
dataBuffer
8
{        char dest[100*2];        memset(dest, 'C', 100*2-1); /* fill with 'C's */        dest[100*2-1] = '\0'; /* null terminate */        /* POTENTIAL FLAW: Possibly copy from a memory location located before the source buffer */        strcpy(dest, data);        printLine(dest);        /* INCIDENTAL CWE-401: Memory Leak - data may not point to location         * returned by malloc() so can't safely call free() on it */    }
char dest[100*2];
char dest[100*2];
char
dest[100*2]
dest
[100*2]
100*2
100
2
memset(dest, 'C', 100*2-1);
memset(dest, 'C', 100*2-1)
memset
memset
dest
dest
'C'
100*2-1
100*2
100
2
1
dest[100*2-1] = '\0';
dest[100*2-1] = '\0'
dest[100*2-1]
dest
dest
100*2-1
100*2
100
2
1
'\0'
strcpy(dest, data);
strcpy(dest, data)
strcpy
strcpy
dest
dest
data
data
printLine(dest);
printLine(dest)
printLine
printLine
dest
dest
-----joern-----
(2,8,0)
(32,28,0)
(49,37,0)
(38,28,0)
(67,19,0)
(37,1,0)
(15,69,0)
(25,10,0)
(17,33,0)
(10,38,0)
(24,72,0)
(13,0,0)
(51,52,0)
(10,23,0)
(55,0,0)
(75,16,0)
(35,30,0)
(6,19,0)
(50,60,0)
(74,73,0)
(26,33,0)
(45,16,0)
(39,60,0)
(47,10,0)
(5,52,0)
(3,19,0)
(33,8,0)
(34,47,0)
(73,74,0)
(60,8,0)
(65,37,0)
(22,47,0)
(56,29,0)
(52,5,0)
(4,38,0)
(41,56,0)
(71,72,0)
(27,28,0)
(15,57,0)
(28,38,0)
(59,13,0)
(57,15,0)
(29,38,0)
(8,19,0)
(26,52,0)
(28,32,0)
(0,38,0)
(44,13,0)
(29,56,0)
(14,0,0)
(32,74,0)
(53,26,0)
(72,71,0)
(70,74,0)
(60,56,0)
(16,71,0)
(42,68,0)
(0,37,0)
(0,13,0)
(43,57,0)
(74,32,0)
(60,3,0)
(76,18,0)
(10,47,0)
(23,37,0)
(9,23,0)
(54,29,0)
(11,72,0)
(38,37,0)
(64,73,0)
(62,5,0)
(71,16,0)
(40,5,0)
(30,8,0)
(16,8,0)
(56,37,0)
(36,3,0)
(28,27,0)
(61,68,0)
(58,18,0)
(21,29,0)
(12,71,0)
(52,26,0)
(63,3,0)
(68,38,0)
(50,39,1)
(5,62,1)
(32,74,1)
(4,18,1)
(26,52,1)
(71,12,1)
(25,0,1)
(14,15,1)
(53,16,1)
(52,5,1)
(63,36,1)
(68,42,1)
(0,13,1)
(64,70,1)
(68,38,1)
(74,73,1)
(30,35,1)
(73,64,1)
(60,56,1)
(70,4,1)
(17,26,1)
(75,56,1)
(43,68,1)
(60,50,1)
(51,5,1)
(11,45,1)
(42,61,1)
(41,23,1)
(33,17,1)
(62,40,1)
(39,33,1)
(16,71,1)
(35,60,1)
(40,53,1)
(55,14,1)
(24,11,1)
(28,32,1)
(54,41,1)
(59,44,1)
(9,10,1)
(3,63,1)
(38,28,1)
(75,18,1)
(15,57,1)
(10,47,1)
(56,29,1)
(22,25,1)
(72,24,1)
(29,21,1)
(45,75,1)
(12,72,1)
(71,72,1)
(14,68,1)
(61,38,1)
(0,38,1)
(52,51,1)
(29,38,1)
(13,59,1)
(28,27,1)
(21,54,1)
(7,30,1)
(76,3,1)
(47,34,1)
(44,55,1)
(23,9,1)
(60,3,1)
(58,76,1)
(18,58,1)
(57,43,1)
(10,38,1)
(34,22,1)
(73,18,2)
(43,68,2)
(10,47,2)
(0,18,2)
(42,18,2)
(44,18,2)
(34,18,2)
(70,18,2)
(28,18,2)
(74,73,2)
(15,68,2)
(29,18,2)
(68,38,2)
(23,18,2)
(56,18,2)
(55,18,2)
(14,18,2)
(26,52,2)
(71,72,2)
(68,18,2)
(29,38,2)
(16,71,2)
(59,18,2)
(52,5,2)
(28,27,2)
(54,18,2)
(28,32,2)
(10,38,2)
(61,18,2)
(21,18,2)
(56,29,2)
(74,18,2)
(60,56,2)
(25,18,2)
(4,18,2)
(41,18,2)
(32,18,2)
(32,74,2)
(9,18,2)
(64,18,2)
(0,38,2)
(60,3,2)
(38,28,2)
(38,18,2)
(57,68,2)
(10,18,2)
(47,18,2)
(22,18,2)
(0,13,2)
(13,18,2)
(15,57,2)
-----------------------------------
(0,memset(dataBuffer, 'A', 100-1)
(1,)
(2,dest)
(3,data = NULL)
(4,dataBuffer)
(5,100*2)
(6,if(STATIC_CONST_FIVE==5)
(7,RET)
(8,)
(9,'\\\\0')
(10,dataBuffer[100-1])
(11,100)
(12,1)
(13,100-1)
(14,dataBuffer)
(15,exit(-1)
(16,memset(dest, 'C', 100*2-1)
(17,'\\\\0')
(18,STATIC_CONST_FIVE==5)
(19,)
(20,memset(dest, \'C\', 100*2-1)
(21,8)
(22,100)
(23,dataBuffer[100-1] = '\\\\0')
(24,2)
(25,dataBuffer)
(26,dest[100*2-1])
(27,char *)
(28,(char *)
(29,dataBuffer - 8)
(30,printLine(dest)
(31,\'\\\\0\')
(32,malloc(100*sizeof(char)
(33,dest[100*2-1] = '\\\\0')
(34,1)
(35,dest)
(36,data)
(37,)
(38,* dataBuffer = (char *)
(39,dest)
(40,100)
(41,data)
(42,NULL)
(43,1)
(44,100)
(45,'C')
(46,dataBuffer[100-1] = \'\\\\0\')
(47,100-1)
(48,memset(dataBuffer, \'A\', 100-1)
(49,dataBuffer)
(50,data)
(51,1)
(52,100*2-1)
(53,dest)
(54,dataBuffer)
(55,'A')
(56,data = dataBuffer - 8)
(57,-1)
(58,5)
(59,1)
(60,strcpy(dest, data)
(61,dataBuffer)
(62,2)
(63,NULL)
(64,char)
(65,if (dataBuffer == NULL)
(66,\'A\')
(67,data)
(68,dataBuffer == NULL)
(69,)
(70,100)
(71,100*2-1)
(72,100*2)
(73,sizeof(char)
(74,100*sizeof(char)
(75,dest)
(76,STATIC_CONST_FIVE)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^