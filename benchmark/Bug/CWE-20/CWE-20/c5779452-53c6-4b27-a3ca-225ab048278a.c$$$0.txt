-----label-----
1
-----code-----
void CWE122_Heap_Based_Buffer_Overflow__c_CWE129_large_05_bad()
{
    int data;
    /* Initialize data */
    data = -1;
    if(staticTrue)
    {
        /* POTENTIAL FLAW: Use an invalid index */
        data = 10;
    }
    if(staticTrue)
    {
        {
            int i;
            int * buffer = (int *)malloc(10 * sizeof(int));
            if (buffer == NULL) {exit(-1);}
            /* initialize buffer */
            for (i = 0; i < 10; i++)
            {
                buffer[i] = 0;
            }
            /* POTENTIAL FLAW: Attempt to write to an index of the array that is above the upper bound
             * This code does check to see if the array index is negative */
            if (data >= 0)
            {
                buffer[data] = 1;
                /* Print the array values */
                for(i = 0; i < 10; i++)
                {
                    printIntLine(buffer[i]);
                }
            }
            else
            {
                printLine("ERROR: Array index is negative.");
            }
            free(buffer);
        }
    }
}
-----children-----
1,2
1,3
1,4
3,4
5,6
5,7
5,8
5,9
6,7
7,8
7,9
9,10
11,12
12,13
12,14
13,14
15,16
17,18
17,19
18,19
20,21
21,22
22,23
22,24
23,24
26,27
26,28
27,28
29,30
30,31
30,32
30,33
30,34
30,35
30,36
31,32
32,33
32,34
34,35
36,37
37,38
37,39
39,40
39,41
39,42
42,43
43,44
43,45
44,45
44,46
46,47
48,49
48,50
49,50
51,52
51,53
53,54
54,55
54,56
57,58
57,59
58,59
58,60
59,60
61,62
63,64
64,65
65,66
65,67
66,67
68,69
70,71
70,72
70,73
70,74
71,72
72,73
72,74
73,74
76,77
76,78
77,78
80,81
81,82
83,84
84,85
85,86
85,87
86,87
86,88
87,88
89,90
92,93
92,94
92,95
93,94
93,95
94,95
97,98
97,99
98,99
99,100
99,101
100,101
100,102
101,102
103,104
106,107
106,108
106,109
106,110
107,108
108,109
108,110
109,110
112,113
112,114
113,114
116,117
117,118
119,120
120,121
121,122
121,123
122,123
124,125
124,126
125,126
127,128
129,130
130,131
131,132
131,133
132,133
135,136
136,137
136,138
137,138
139,140
-----nextToken-----
2,4,8,10,14,16,19,24,25,28,33,35,38,40,41,45,47,50,52,55,56,60,62,67,69,74,75,78,79,82,88,90,91,95,96,102,104,105,110,111,114,115,118,123,126,128,133,134,138,140
-----computeFrom-----
12,13
12,14
22,23
22,24
51,52
51,53
58,59
58,60
72,73
72,74
76,77
76,78
85,86
85,87
93,94
93,95
99,100
99,101
108,109
108,110
112,113
112,114
-----guardedBy-----
95,104
-----guardedByNegation-----
-----lastLexicalUse-----
-----jump-----
-----attribute-----
FunctionDefinition;SimpleDeclSpecifier;FunctionDeclarator;Name;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;UnaryExpression;LiteralExpression;IfStatement;IdExpression;Name;CompoundStatement;ExpressionStatement;BinaryExpression;IdExpression;Name;LiteralExpression;IfStatement;IdExpression;Name;CompoundStatement;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Name;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Pointer;Name;EqualsInitializer;CastExpression;TypeId;SimpleDeclSpecifier;Declarator;Pointer;FunctionCallExpression;IdExpression;Name;BinaryExpression;LiteralExpression;TypeIdExpression;TypeId;SimpleDeclSpecifier;Declarator;IfStatement;BinaryExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;UnaryExpression;LiteralExpression;ForStatement;ExpressionStatement;BinaryExpression;IdExpression;Name;LiteralExpression;BinaryExpression;IdExpression;Name;LiteralExpression;UnaryExpression;IdExpression;Name;CompoundStatement;ExpressionStatement;BinaryExpression;ArraySubscriptExpression;IdExpression;Name;IdExpression;Name;LiteralExpression;IfStatement;BinaryExpression;IdExpression;Name;LiteralExpression;CompoundStatement;ExpressionStatement;BinaryExpression;ArraySubscriptExpression;IdExpression;Name;IdExpression;Name;LiteralExpression;ForStatement;ExpressionStatement;BinaryExpression;IdExpression;Name;LiteralExpression;BinaryExpression;IdExpression;Name;LiteralExpression;UnaryExpression;IdExpression;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;ArraySubscriptExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;
-----ast_node-----
void CWE122_Heap_Based_Buffer_Overflow__c_CWE129_large_05_bad(){    int data;    /* Initialize data */    data = -1;    if(staticTrue)    {        /* POTENTIAL FLAW: Use an invalid index */        data = 10;    }    if(staticTrue)    {        {            int i;            int * buffer = (int *)malloc(10 * sizeof(int));            if (buffer == NULL) {exit(-1);}            /* initialize buffer */            for (i = 0; i < 10; i++)            {                buffer[i] = 0;            }            /* POTENTIAL FLAW: Attempt to write to an index of the array that is above the upper bound             * This code does check to see if the array index is negative */            if (data >= 0)            {                buffer[data] = 1;                /* Print the array values */                for(i = 0; i < 10; i++)                {                    printIntLine(buffer[i]);                }            }            else            {                printLine("ERROR: Array index is negative.");            }            free(buffer);        }    }}
void
CWE122_Heap_Based_Buffer_Overflow__c_CWE129_large_05_bad()
CWE122_Heap_Based_Buffer_Overflow__c_CWE129_large_05_bad
{    int data;    /* Initialize data */    data = -1;    if(staticTrue)    {        /* POTENTIAL FLAW: Use an invalid index */        data = 10;    }    if(staticTrue)    {        {            int i;            int * buffer = (int *)malloc(10 * sizeof(int));            if (buffer == NULL) {exit(-1);}            /* initialize buffer */            for (i = 0; i < 10; i++)            {                buffer[i] = 0;            }            /* POTENTIAL FLAW: Attempt to write to an index of the array that is above the upper bound             * This code does check to see if the array index is negative */            if (data >= 0)            {                buffer[data] = 1;                /* Print the array values */                for(i = 0; i < 10; i++)                {                    printIntLine(buffer[i]);                }            }            else            {                printLine("ERROR: Array index is negative.");            }            free(buffer);        }    }}
int data;
int data;
int
data
data
data = -1;
data = -1
data
data
-1
1
if(staticTrue)    {        /* POTENTIAL FLAW: Use an invalid index */        data = 10;    }
staticTrue
staticTrue
{        /* POTENTIAL FLAW: Use an invalid index */        data = 10;    }
data = 10;
data = 10
data
data
10
if(staticTrue)    {        {            int i;            int * buffer = (int *)malloc(10 * sizeof(int));            if (buffer == NULL) {exit(-1);}            /* initialize buffer */            for (i = 0; i < 10; i++)            {                buffer[i] = 0;            }            /* POTENTIAL FLAW: Attempt to write to an index of the array that is above the upper bound             * This code does check to see if the array index is negative */            if (data >= 0)            {                buffer[data] = 1;                /* Print the array values */                for(i = 0; i < 10; i++)                {                    printIntLine(buffer[i]);                }            }            else            {                printLine("ERROR: Array index is negative.");            }            free(buffer);        }    }
staticTrue
staticTrue
{        {            int i;            int * buffer = (int *)malloc(10 * sizeof(int));            if (buffer == NULL) {exit(-1);}            /* initialize buffer */            for (i = 0; i < 10; i++)            {                buffer[i] = 0;            }            /* POTENTIAL FLAW: Attempt to write to an index of the array that is above the upper bound             * This code does check to see if the array index is negative */            if (data >= 0)            {                buffer[data] = 1;                /* Print the array values */                for(i = 0; i < 10; i++)                {                    printIntLine(buffer[i]);                }            }            else            {                printLine("ERROR: Array index is negative.");            }            free(buffer);        }    }
{            int i;            int * buffer = (int *)malloc(10 * sizeof(int));            if (buffer == NULL) {exit(-1);}            /* initialize buffer */            for (i = 0; i < 10; i++)            {                buffer[i] = 0;            }            /* POTENTIAL FLAW: Attempt to write to an index of the array that is above the upper bound             * This code does check to see if the array index is negative */            if (data >= 0)            {                buffer[data] = 1;                /* Print the array values */                for(i = 0; i < 10; i++)                {                    printIntLine(buffer[i]);                }            }            else            {                printLine("ERROR: Array index is negative.");            }            free(buffer);        }
int i;
int i;
int
i
i
int * buffer = (int *)malloc(10 * sizeof(int));
int * buffer = (int *)malloc(10 * sizeof(int));
int
* buffer = (int *)malloc(10 * sizeof(int))
*
buffer
= (int *)malloc(10 * sizeof(int))
(int *)malloc(10 * sizeof(int))
int *
int
*
*
malloc(10 * sizeof(int))
malloc
malloc
10 * sizeof(int)
10
sizeof(int)
int
int

if (buffer == NULL) {exit(-1);}
buffer == NULL
buffer
buffer
NULL
NULL
{exit(-1);}
exit(-1);
exit(-1)
exit
exit
-1
1
for (i = 0; i < 10; i++)            {                buffer[i] = 0;            }
i = 0;
i = 0
i
i
0
i < 10
i
i
10
i++
i
i
{                buffer[i] = 0;            }
buffer[i] = 0;
buffer[i] = 0
buffer[i]
buffer
buffer
i
i
0
if (data >= 0)            {                buffer[data] = 1;                /* Print the array values */                for(i = 0; i < 10; i++)                {                    printIntLine(buffer[i]);                }            }            else            {                printLine("ERROR: Array index is negative.");            }
data >= 0
data
data
0
{                buffer[data] = 1;                /* Print the array values */                for(i = 0; i < 10; i++)                {                    printIntLine(buffer[i]);                }            }
buffer[data] = 1;
buffer[data] = 1
buffer[data]
buffer
buffer
data
data
1
for(i = 0; i < 10; i++)                {                    printIntLine(buffer[i]);                }
i = 0;
i = 0
i
i
0
i < 10
i
i
10
i++
i
i
{                    printIntLine(buffer[i]);                }
printIntLine(buffer[i]);
printIntLine(buffer[i])
printIntLine
printIntLine
buffer[i]
buffer
buffer
i
i
{                printLine("ERROR: Array index is negative.");            }
printLine("ERROR: Array index is negative.");
printLine("ERROR: Array index is negative.")
printLine
printLine
"ERROR: Array index is negative."
free(buffer);
free(buffer)
free
free
buffer
buffer
-----joern-----
(34,28,0)
(54,27,0)
(8,21,0)
(64,76,0)
(47,5,0)
(15,17,0)
(78,28,0)
(59,39,0)
(9,19,0)
(79,30,0)
(22,77,0)
(37,22,0)
(51,57,0)
(26,8,0)
(56,14,0)
(19,57,0)
(39,59,0)
(53,5,0)
(73,60,0)
(5,8,0)
(12,76,0)
(3,50,0)
(6,8,0)
(43,16,0)
(65,30,0)
(59,14,0)
(61,70,0)
(35,37,0)
(53,74,0)
(25,77,0)
(70,52,0)
(20,22,0)
(71,30,0)
(54,19,0)
(11,52,0)
(46,39,0)
(69,8,0)
(23,16,0)
(45,4,0)
(1,31,0)
(29,59,0)
(19,30,0)
(60,5,0)
(4,72,0)
(32,60,0)
(10,40,0)
(19,54,0)
(41,70,0)
(57,66,0)
(28,33,0)
(13,8,0)
(78,59,0)
(5,53,0)
(76,64,0)
(38,8,0)
(0,19,0)
(7,37,0)
(37,5,0)
(53,64,0)
(75,40,0)
(70,57,0)
(36,14,0)
(76,50,0)
(62,47,0)
(18,17,0)
(44,28,0)
(24,78,0)
(74,53,0)
(37,59,0)
(48,78,0)
(16,23,0)
(47,8,0)
(17,52,0)
(19,5,0)
(31,52,0)
(63,52,0)
(50,76,0)
(42,5,0)
(23,55,0)
(49,79,0)
(37,28,0)
(64,53,0)
(70,5,0)
(67,14,0)
(40,30,0)
(16,43,1)
(2,58,1)
(19,30,1)
(60,5,1)
(49,54,1)
(47,62,1)
(48,17,1)
(15,31,1)
(28,34,1)
(62,40,1)
(64,76,1)
(45,78,1)
(30,71,1)
(0,9,1)
(24,48,1)
(9,40,1)
(59,39,1)
(54,19,1)
(78,59,1)
(37,5,1)
(19,5,1)
(63,23,1)
(79,30,1)
(68,59,1)
(11,63,1)
(46,29,1)
(75,10,1)
(41,61,1)
(71,65,1)
(40,30,1)
(51,70,1)
(44,68,1)
(78,28,1)
(15,52,1)
(34,44,1)
(43,60,1)
(23,16,1)
(20,37,1)
(63,60,1)
(7,35,1)
(3,12,1)
(1,57,1)
(31,52,1)
(42,58,1)
(12,42,1)
(35,78,1)
(17,52,1)
(70,52,1)
(70,41,1)
(47,5,1)
(19,57,1)
(2,47,1)
(17,18,1)
(52,11,1)
(5,53,1)
(50,3,1)
(19,0,1)
(32,5,1)
(40,75,1)
(39,46,1)
(61,17,1)
(60,73,1)
(70,5,1)
(37,28,1)
(78,24,1)
(37,7,1)
(10,79,1)
(31,1,1)
(22,20,1)
(10,30,1)
(62,4,1)
(76,50,1)
(18,15,1)
(79,49,1)
(58,28,1)
(4,45,1)
(65,22,1)
(58,68,1)
(73,32,1)
(53,64,1)
(57,51,1)
(53,74,1)
(37,59,1)
(65,78,2)
(64,76,2)
(1,17,2)
(28,68,2)
(19,30,2)
(23,16,2)
(78,59,2)
(62,58,2)
(53,74,2)
(70,52,2)
(24,58,2)
(34,68,2)
(5,53,2)
(16,60,2)
(37,78,2)
(75,40,2)
(40,40,2)
(10,78,2)
(57,17,2)
(71,78,2)
(51,17,2)
(76,50,2)
(17,17,2)
(9,40,2)
(19,5,2)
(31,17,2)
(4,78,2)
(37,59,2)
(61,17,2)
(54,19,2)
(59,39,2)
(78,58,2)
(42,58,2)
(70,5,2)
(7,78,2)
(73,58,2)
(47,58,2)
(53,64,2)
(75,78,2)
(37,5,2)
(20,78,2)
(48,58,2)
(63,58,2)
(18,17,2)
(79,30,2)
(32,58,2)
(54,40,2)
(49,40,2)
(19,40,2)
(40,78,2)
(78,28,2)
(53,58,2)
(22,78,2)
(17,52,2)
(17,58,2)
(76,58,2)
(45,78,2)
(19,57,2)
(64,58,2)
(44,68,2)
(11,58,2)
(23,60,2)
(5,58,2)
(10,40,2)
(52,58,2)
(15,58,2)
(43,60,2)
(0,40,2)
(18,58,2)
(12,58,2)
(79,40,2)
(47,5,2)
(40,30,2)
(70,17,2)
(50,58,2)
(31,52,2)
(15,17,2)
(60,5,2)
(60,58,2)
(37,28,2)
(30,78,2)
(41,17,2)
(3,58,2)
(35,78,2)
-----------------------------------
(0,i)
(1,i)
(2,RET)
(3,int)
(4,printLine("ERROR: Array index is negative.")
(5,* buffer = (int *)
(6,if (buffer == NULL)
(7,data)
(8,)
(9,buffer)
(10,i)
(11,0)
(12,10)
(13,for (i = 0; i < 10; i++)
(14,)
(15,i)
(16,-1)
(17,i < 10)
(18,10)
(19,buffer[i])
(20,1)
(21,)
(22,buffer[data] = 1)
(23,exit(-1)
(24,0)
(25,for(i = 0; i < 10; i++)
(26,i)
(27,)
(28,data = 10)
(29,data)
(30,i = 0)
(31,i++)
(32,buffer)
(33,)
(34,10)
(35,buffer)
(36,if(staticTrue)
(37,buffer[data])
(38,if (data >= 0)
(39,-1)
(40,i < 10)
(41,i)
(42,buffer)
(43,1)
(44,data)
(45,"ERROR: Array index is negative.")
(46,1)
(47,free(buffer)
(48,data)
(49,i)
(50,sizeof(int)
(51,0)
(52,i = 0)
(53,(int *)
(54,printIntLine(buffer[i])
(55,)
(56,data)
(57,buffer[i] = 0)
(58,staticTrue)
(59,data = -1)
(60,buffer == NULL)
(61,buffer)
(62,buffer)
(63,i)
(64,malloc(10 * sizeof(int)
(65,i)
(66,)
(67,if(staticTrue)
(68,staticTrue)
(69,buffer)
(70,buffer[i])
(71,0)
(72,)
(73,NULL)
(74,int *)
(75,10)
(76,10 * sizeof(int)
(77,)
(78,data >= 0)
(79,i++)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^