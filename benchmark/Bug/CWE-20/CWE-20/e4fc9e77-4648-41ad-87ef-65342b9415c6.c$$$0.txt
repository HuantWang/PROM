-----label-----
1
-----code-----
void CWE122_Heap_Based_Buffer_Overflow__c_CWE129_fgets_18_bad()
{
    int data;
    /* Initialize data */
    data = -1;
    goto source;
source:
    {
        char inputBuffer[CHAR_ARRAY_SIZE] = "";
        /* POTENTIAL FLAW: Read data from the console using fgets() */
        if (fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin) != NULL)
        {
            /* Convert to int */
            data = atoi(inputBuffer);
        }
        else
        {
            printLine("fgets() failed.");
        }
    }
    goto sink;
sink:
    {
        int i;
        int * buffer = (int *)malloc(10 * sizeof(int));
        if (buffer == NULL) {exit(-1);}
        /* initialize buffer */
        for (i = 0; i < 10; i++)
        {
            buffer[i] = 0;
        }
        /* POTENTIAL FLAW: Attempt to write to an index of the array that is above the upper bound
         * This code does check to see if the array index is negative */
        if (data >= 0)
        {
            buffer[data] = 1;
            /* Print the array values */
            for(i = 0; i < 10; i++)
            {
                printIntLine(buffer[i]);
            }
        }
        else
        {
            printLine("ERROR: Array index is negative.");
        }
        free(buffer);
    }
}
-----children-----
1,2
1,3
1,4
3,4
5,6
5,7
5,8
5,9
5,10
5,11
6,7
7,8
7,9
9,10
11,12
12,13
12,14
13,14
15,16
17,18
19,20
19,21
21,22
21,23
22,23
23,24
23,25
25,26
25,27
25,28
27,28
28,29
30,31
32,33
32,34
32,35
33,34
33,35
34,35
34,36
34,37
34,38
35,36
37,38
39,40
41,42
43,44
45,46
46,47
47,48
47,49
48,49
50,51
50,52
51,52
53,54
55,56
56,57
57,58
57,59
58,59
61,62
63,64
63,65
65,66
65,67
65,68
65,69
65,70
65,71
66,67
67,68
67,69
69,70
71,72
72,73
72,74
74,75
74,76
74,77
77,78
78,79
78,80
79,80
79,81
81,82
83,84
83,85
84,85
86,87
86,88
88,89
89,90
89,91
92,93
92,94
93,94
93,95
94,95
96,97
98,99
99,100
100,101
100,102
101,102
103,104
105,106
105,107
105,108
105,109
106,107
107,108
107,109
108,109
111,112
111,113
112,113
115,116
116,117
118,119
119,120
120,121
120,122
121,122
121,123
122,123
124,125
127,128
127,129
127,130
128,129
128,130
129,130
132,133
132,134
133,134
134,135
134,136
135,136
135,137
136,137
138,139
141,142
141,143
141,144
141,145
142,143
143,144
143,145
144,145
147,148
147,149
148,149
151,152
152,153
154,155
155,156
156,157
156,158
157,158
159,160
159,161
160,161
162,163
164,165
165,166
166,167
166,168
167,168
170,171
171,172
171,173
172,173
174,175
-----nextToken-----
2,4,8,10,14,16,18,20,24,26,29,31,36,38,40,42,44,49,52,54,59,60,62,64,68,70,73,75,76,80,82,85,87,90,91,95,97,102,104,109,110,113,114,117,123,125,126,130,131,137,139,140,145,146,149,150,153,158,161,163,168,169,173,175
-----computeFrom-----
12,13
12,14
33,34
33,35
47,48
47,49
86,87
86,88
93,94
93,95
107,108
107,109
111,112
111,113
120,121
120,122
128,129
128,130
134,135
134,136
143,144
143,145
147,148
147,149
-----guardedBy-----
38,54
130,139
-----guardedByNegation-----
-----lastLexicalUse-----
-----jump-----
-----attribute-----
FunctionDefinition;SimpleDeclSpecifier;FunctionDeclarator;Name;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;UnaryExpression;LiteralExpression;GotoStatement;Name;LabelStatement;Name;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;ArrayDeclarator;Name;ArrayModifier;IdExpression;Name;EqualsInitializer;LiteralExpression;IfStatement;BinaryExpression;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;IdExpression;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;LiteralExpression;GotoStatement;Name;LabelStatement;Name;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Name;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Pointer;Name;EqualsInitializer;CastExpression;TypeId;SimpleDeclSpecifier;Declarator;Pointer;FunctionCallExpression;IdExpression;Name;BinaryExpression;LiteralExpression;TypeIdExpression;TypeId;SimpleDeclSpecifier;Declarator;IfStatement;BinaryExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;UnaryExpression;LiteralExpression;ForStatement;ExpressionStatement;BinaryExpression;IdExpression;Name;LiteralExpression;BinaryExpression;IdExpression;Name;LiteralExpression;UnaryExpression;IdExpression;Name;CompoundStatement;ExpressionStatement;BinaryExpression;ArraySubscriptExpression;IdExpression;Name;IdExpression;Name;LiteralExpression;IfStatement;BinaryExpression;IdExpression;Name;LiteralExpression;CompoundStatement;ExpressionStatement;BinaryExpression;ArraySubscriptExpression;IdExpression;Name;IdExpression;Name;LiteralExpression;ForStatement;ExpressionStatement;BinaryExpression;IdExpression;Name;LiteralExpression;BinaryExpression;IdExpression;Name;LiteralExpression;UnaryExpression;IdExpression;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;ArraySubscriptExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;
-----ast_node-----
void CWE122_Heap_Based_Buffer_Overflow__c_CWE129_fgets_18_bad(){    int data;    /* Initialize data */    data = -1;    goto source;source:    {        char inputBuffer[CHAR_ARRAY_SIZE] = "";        /* POTENTIAL FLAW: Read data from the console using fgets() */        if (fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin) != NULL)        {            /* Convert to int */            data = atoi(inputBuffer);        }        else        {            printLine("fgets() failed.");        }    }    goto sink;sink:    {        int i;        int * buffer = (int *)malloc(10 * sizeof(int));        if (buffer == NULL) {exit(-1);}        /* initialize buffer */        for (i = 0; i < 10; i++)        {            buffer[i] = 0;        }        /* POTENTIAL FLAW: Attempt to write to an index of the array that is above the upper bound         * This code does check to see if the array index is negative */        if (data >= 0)        {            buffer[data] = 1;            /* Print the array values */            for(i = 0; i < 10; i++)            {                printIntLine(buffer[i]);            }        }        else        {            printLine("ERROR: Array index is negative.");        }        free(buffer);    }}
void
CWE122_Heap_Based_Buffer_Overflow__c_CWE129_fgets_18_bad()
CWE122_Heap_Based_Buffer_Overflow__c_CWE129_fgets_18_bad
{    int data;    /* Initialize data */    data = -1;    goto source;source:    {        char inputBuffer[CHAR_ARRAY_SIZE] = "";        /* POTENTIAL FLAW: Read data from the console using fgets() */        if (fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin) != NULL)        {            /* Convert to int */            data = atoi(inputBuffer);        }        else        {            printLine("fgets() failed.");        }    }    goto sink;sink:    {        int i;        int * buffer = (int *)malloc(10 * sizeof(int));        if (buffer == NULL) {exit(-1);}        /* initialize buffer */        for (i = 0; i < 10; i++)        {            buffer[i] = 0;        }        /* POTENTIAL FLAW: Attempt to write to an index of the array that is above the upper bound         * This code does check to see if the array index is negative */        if (data >= 0)        {            buffer[data] = 1;            /* Print the array values */            for(i = 0; i < 10; i++)            {                printIntLine(buffer[i]);            }        }        else        {            printLine("ERROR: Array index is negative.");        }        free(buffer);    }}
int data;
int data;
int
data
data
data = -1;
data = -1
data
data
-1
1
goto source;
source
source:    {        char inputBuffer[CHAR_ARRAY_SIZE] = "";        /* POTENTIAL FLAW: Read data from the console using fgets() */        if (fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin) != NULL)        {            /* Convert to int */            data = atoi(inputBuffer);        }        else        {            printLine("fgets() failed.");        }    }
source
{        char inputBuffer[CHAR_ARRAY_SIZE] = "";        /* POTENTIAL FLAW: Read data from the console using fgets() */        if (fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin) != NULL)        {            /* Convert to int */            data = atoi(inputBuffer);        }        else        {            printLine("fgets() failed.");        }    }
char inputBuffer[CHAR_ARRAY_SIZE] = "";
char inputBuffer[CHAR_ARRAY_SIZE] = "";
char
inputBuffer[CHAR_ARRAY_SIZE] = ""
inputBuffer
[CHAR_ARRAY_SIZE]
CHAR_ARRAY_SIZE
CHAR_ARRAY_SIZE
= ""
""
if (fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin) != NULL)        {            /* Convert to int */            data = atoi(inputBuffer);        }        else        {            printLine("fgets() failed.");        }
fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin) != NULL
fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin)
fgets
fgets
inputBuffer
inputBuffer
CHAR_ARRAY_SIZE
CHAR_ARRAY_SIZE
stdin
stdin
NULL
NULL
{            /* Convert to int */            data = atoi(inputBuffer);        }
data = atoi(inputBuffer);
data = atoi(inputBuffer)
data
data
atoi(inputBuffer)
atoi
atoi
inputBuffer
inputBuffer
{            printLine("fgets() failed.");        }
printLine("fgets() failed.");
printLine("fgets() failed.")
printLine
printLine
"fgets() failed."
goto sink;
sink
sink:    {        int i;        int * buffer = (int *)malloc(10 * sizeof(int));        if (buffer == NULL) {exit(-1);}        /* initialize buffer */        for (i = 0; i < 10; i++)        {            buffer[i] = 0;        }        /* POTENTIAL FLAW: Attempt to write to an index of the array that is above the upper bound         * This code does check to see if the array index is negative */        if (data >= 0)        {            buffer[data] = 1;            /* Print the array values */            for(i = 0; i < 10; i++)            {                printIntLine(buffer[i]);            }        }        else        {            printLine("ERROR: Array index is negative.");        }        free(buffer);    }
sink
{        int i;        int * buffer = (int *)malloc(10 * sizeof(int));        if (buffer == NULL) {exit(-1);}        /* initialize buffer */        for (i = 0; i < 10; i++)        {            buffer[i] = 0;        }        /* POTENTIAL FLAW: Attempt to write to an index of the array that is above the upper bound         * This code does check to see if the array index is negative */        if (data >= 0)        {            buffer[data] = 1;            /* Print the array values */            for(i = 0; i < 10; i++)            {                printIntLine(buffer[i]);            }        }        else        {            printLine("ERROR: Array index is negative.");        }        free(buffer);    }
int i;
int i;
int
i
i
int * buffer = (int *)malloc(10 * sizeof(int));
int * buffer = (int *)malloc(10 * sizeof(int));
int
* buffer = (int *)malloc(10 * sizeof(int))
*
buffer
= (int *)malloc(10 * sizeof(int))
(int *)malloc(10 * sizeof(int))
int *
int
*
*
malloc(10 * sizeof(int))
malloc
malloc
10 * sizeof(int)
10
sizeof(int)
int
int

if (buffer == NULL) {exit(-1);}
buffer == NULL
buffer
buffer
NULL
NULL
{exit(-1);}
exit(-1);
exit(-1)
exit
exit
-1
1
for (i = 0; i < 10; i++)        {            buffer[i] = 0;        }
i = 0;
i = 0
i
i
0
i < 10
i
i
10
i++
i
i
{            buffer[i] = 0;        }
buffer[i] = 0;
buffer[i] = 0
buffer[i]
buffer
buffer
i
i
0
if (data >= 0)        {            buffer[data] = 1;            /* Print the array values */            for(i = 0; i < 10; i++)            {                printIntLine(buffer[i]);            }        }        else        {            printLine("ERROR: Array index is negative.");        }
data >= 0
data
data
0
{            buffer[data] = 1;            /* Print the array values */            for(i = 0; i < 10; i++)            {                printIntLine(buffer[i]);            }        }
buffer[data] = 1;
buffer[data] = 1
buffer[data]
buffer
buffer
data
data
1
for(i = 0; i < 10; i++)            {                printIntLine(buffer[i]);            }
i = 0;
i = 0
i
i
0
i < 10
i
i
10
i++
i
i
{                printIntLine(buffer[i]);            }
printIntLine(buffer[i]);
printIntLine(buffer[i])
printIntLine
printIntLine
buffer[i]
buffer
buffer
i
i
{            printLine("ERROR: Array index is negative.");        }
printLine("ERROR: Array index is negative.");
printLine("ERROR: Array index is negative.")
printLine
printLine
"ERROR: Array index is negative."
free(buffer);
free(buffer)
free
free
buffer
buffer
-----joern-----
(83,10,0)
(35,23,0)
(37,68,0)
(36,41,0)
(60,41,0)
(72,88,0)
(89,74,0)
(28,52,0)
(62,41,0)
(30,72,0)
(17,68,0)
(33,90,0)
(38,27,0)
(29,51,0)
(88,57,0)
(11,68,0)
(64,29,0)
(69,23,0)
(6,88,0)
(72,68,0)
(68,74,0)
(16,89,0)
(40,88,0)
(5,91,0)
(11,27,0)
(21,41,0)
(54,33,0)
(28,38,0)
(93,74,0)
(8,0,0)
(56,81,0)
(73,0,0)
(89,68,0)
(1,10,0)
(27,80,0)
(18,41,0)
(2,47,0)
(78,41,0)
(12,11,0)
(64,13,0)
(13,68,0)
(25,51,0)
(72,21,0)
(72,2,0)
(84,37,0)
(76,40,0)
(82,69,0)
(26,77,0)
(11,0,0)
(31,41,0)
(38,23,0)
(40,21,0)
(57,88,0)
(49,35,0)
(77,46,0)
(32,74,0)
(45,8,0)
(70,38,0)
(61,60,0)
(44,27,0)
(9,5,0)
(85,21,0)
(46,77,0)
(38,28,0)
(92,40,0)
(34,57,0)
(56,75,0)
(51,29,0)
(13,64,0)
(4,74,0)
(38,68,0)
(65,72,0)
(74,41,0)
(86,77,0)
(13,66,0)
(15,14,0)
(39,47,0)
(77,14,0)
(24,60,0)
(94,74,0)
(50,23,0)
(66,13,0)
(21,87,0)
(7,77,0)
(71,29,0)
(59,23,0)
(3,0,0)
(10,0,0)
(79,2,0)
(22,74,0)
(58,14,0)
(20,46,0)
(75,56,0)
(55,38,0)
(53,11,0)
(48,75,0)
(88,19,0)
(43,69,0)
(14,60,0)
(29,64,0)
(42,37,0)
(67,87,0)
(68,13,0)
(87,21,0)
(57,14,0)
(40,88,1)
(36,21,1)
(86,7,1)
(38,68,1)
(65,40,1)
(37,42,1)
(10,0,1)
(72,21,1)
(89,68,1)
(10,1,1)
(77,14,1)
(89,16,1)
(34,6,1)
(37,68,1)
(77,86,1)
(33,54,1)
(51,25,1)
(8,0,1)
(8,45,1)
(28,38,1)
(15,58,1)
(43,35,1)
(76,92,1)
(82,43,1)
(7,26,1)
(68,13,1)
(44,11,1)
(13,66,1)
(67,85,1)
(46,77,1)
(2,79,1)
(35,23,1)
(0,73,1)
(43,23,1)
(11,53,1)
(88,57,1)
(58,36,1)
(72,30,1)
(79,72,1)
(49,28,1)
(54,46,1)
(69,82,1)
(29,51,1)
(30,65,1)
(23,50,1)
(16,5,1)
(14,15,1)
(64,29,1)
(27,44,1)
(20,77,1)
(35,49,1)
(11,68,1)
(45,27,1)
(56,75,1)
(38,27,1)
(72,68,1)
(73,3,1)
(12,10,1)
(83,8,1)
(42,84,1)
(55,70,1)
(6,46,1)
(71,17,1)
(16,69,1)
(57,34,1)
(75,48,1)
(1,83,1)
(83,0,1)
(40,76,1)
(18,88,1)
(21,87,1)
(63,89,1)
(84,68,1)
(46,20,1)
(40,21,1)
(5,9,1)
(38,55,1)
(69,23,1)
(13,64,1)
(48,37,1)
(53,12,1)
(50,59,1)
(72,88,1)
(26,14,1)
(38,23,1)
(17,18,1)
(3,37,1)
(59,2,1)
(87,67,1)
(3,56,1)
(57,14,1)
(25,71,1)
(70,69,1)
(18,33,1)
(92,10,1)
(11,0,1)
(9,40,1)
(35,23,2)
(28,69,2)
(57,46,2)
(11,10,2)
(82,69,2)
(30,40,2)
(2,40,2)
(8,0,2)
(37,68,2)
(64,29,2)
(69,23,2)
(72,21,2)
(6,46,2)
(11,0,2)
(53,10,2)
(11,68,2)
(29,51,2)
(49,69,2)
(65,40,2)
(38,69,2)
(35,69,2)
(43,40,2)
(89,68,2)
(70,69,2)
(13,66,2)
(12,10,2)
(34,46,2)
(75,37,2)
(82,40,2)
(46,77,2)
(56,75,2)
(69,40,2)
(21,87,2)
(68,13,2)
(55,69,2)
(40,21,2)
(88,57,2)
(88,46,2)
(38,23,2)
(43,69,2)
(57,14,2)
(10,0,2)
(23,40,2)
(1,10,2)
(79,40,2)
(59,40,2)
(10,10,2)
(48,37,2)
(69,69,2)
(27,10,2)
(33,46,2)
(72,68,2)
(72,88,2)
(44,10,2)
(77,14,2)
(5,40,2)
(28,38,2)
(56,37,2)
(38,27,2)
(9,40,2)
(38,68,2)
(40,88,2)
(13,64,2)
(83,10,2)
(54,46,2)
(8,10,2)
(50,40,2)
(72,40,2)
(45,10,2)
-----------------------------------
(0,i = 0)
(1,10)
(2,buffer[data] = 1)
(3,i)
(4,if (buffer == NULL)
(5,printLine("ERROR: Array index is negative.")
(6,data)
(7,CHAR_ARRAY_SIZE)
(8,i++)
(9,"ERROR: Array index is negative.")
(10,i < 10)
(11,buffer[i])
(12,buffer)
(13,(int *)
(14,inputBuffer[CHAR_ARRAY_SIZE] = "")
(15,"")
(16,buffer)
(17,buffer)
(18,goto sink;)
(19,)
(20,NULL)
(21,data = -1)
(22,if (data >= 0)
(23,i = 0)
(24,if (fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin)
(25,int)
(26,inputBuffer)
(27,buffer[i] = 0)
(28,printIntLine(buffer[i])
(29,10 * sizeof(int)
(30,data)
(31,sink:)
(32,i)
(33,printLine("fgets()
(34,inputBuffer)
(35,i++)
(36,goto source;)
(37,buffer == NULL)
(38,buffer[i])
(39,for(i = 0; i < 10; i++)
(40,data >= 0)
(41,)
(42,NULL)
(43,i)
(44,0)
(45,i)
(46,fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin)
(47,)
(48,1)
(49,i)
(50,0)
(51,sizeof(int)
(52,)
(53,i)
(54,"fgets()
(55,i)
(56,exit(-1)
(57,atoi(inputBuffer)
(58,inputBuffer)
(59,i)
(60,)
(61,inputBuffer)
(62,data)
(63,RET)
(64,malloc(10 * sizeof(int)
(65,buffer)
(66,int *)
(67,1)
(68,* buffer = (int *)
(69,i < 10)
(70,buffer)
(71,10)
(72,buffer[data])
(73,0)
(74,)
(75,-1)
(76,0)
(77,fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin)
(78,source:)
(79,1)
(80,)
(81,)
(82,10)
(83,i)
(84,buffer)
(85,data)
(86,stdin)
(87,-1)
(88,data = atoi(inputBuffer)
(89,free(buffer)
(90,)
(91,)
(92,data)
(93,for (i = 0; i < 10; i++)
(94,buffer)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^