-----label-----
1
-----code-----
void CWE122_Heap_Based_Buffer_Overflow__c_CWE806_char_snprintf_32_bad()
{
    char * data;
    char * *dataPtr1 = &data;
    char * *dataPtr2 = &data;
    data = (char *)malloc(100*sizeof(char));
    if (data == NULL) {exit(-1);}
    {
        char * data = *dataPtr1;
        /* FLAW: Initialize data as a large buffer that is larger than the small buffer used in the sink */
        memset(data, 'A', 100-1); /* fill with 'A's */
        data[100-1] = '\0'; /* null terminate */
        *dataPtr1 = data;
    }
    {
        char * data = *dataPtr2;
        {
            char dest[50] = "";
            /* POTENTIAL FLAW: Possible buffer overflow if data is larger than dest */
            SNPRINTF(dest, strlen(data), "%s", data);
            printLine(data);
            free(data);
        }
    }
}
-----children-----
1,2
1,3
1,4
3,4
5,6
5,7
5,8
5,9
5,10
5,11
5,12
6,7
7,8
7,9
9,10
9,11
12,13
13,14
13,15
15,16
15,17
15,18
15,19
19,20
20,21
21,22
23,24
24,25
24,26
26,27
26,28
26,29
26,30
30,31
31,32
32,33
34,35
35,36
35,37
36,37
38,39
38,40
39,40
39,41
41,42
43,44
43,45
44,45
46,47
46,48
48,49
49,50
49,51
52,53
52,54
53,54
53,55
54,55
56,57
58,59
59,60
60,61
60,62
61,62
63,64
65,66
65,67
65,68
65,69
66,67
67,68
67,69
69,70
69,71
69,72
72,73
73,74
74,75
76,77
77,78
77,79
77,80
77,81
78,79
80,81
83,84
83,85
86,87
87,88
87,89
88,89
88,90
89,90
91,92
91,93
95,96
96,97
96,98
97,98
98,99
100,101
102,103
102,104
103,104
104,105
104,106
106,107
106,108
106,109
109,110
110,111
111,112
113,114
113,115
113,116
113,117
114,115
115,116
115,117
117,118
117,119
117,120
119,120
121,122
123,124
124,125
124,126
124,127
124,128
124,129
125,126
127,128
129,130
129,131
130,131
132,133
135,136
137,138
138,139
138,140
139,140
141,142
143,144
144,145
144,146
145,146
147,148
-----nextToken-----
2,4,8,10,11,14,16,17,18,22,25,27,28,29,33,37,40,42,45,47,50,51,55,57,62,64,68,70,71,75,79,81,82,84,85,90,92,93,94,99,101,105,107,108,112,116,118,120,122,126,128,131,133,134,136,140,142,146,148
-----computeFrom-----
35,36
35,37
46,47
46,48
53,54
53,55
83,84
83,85
87,88
87,89
91,92
91,93
96,97
96,98
-----guardedBy-----
-----guardedByNegation-----
-----lastLexicalUse-----
-----jump-----
-----attribute-----
FunctionDefinition;SimpleDeclSpecifier;FunctionDeclarator;Name;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Pointer;Name;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Pointer;Pointer;Name;EqualsInitializer;UnaryExpression;IdExpression;Name;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Pointer;Pointer;Name;EqualsInitializer;UnaryExpression;IdExpression;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;CastExpression;TypeId;SimpleDeclSpecifier;Declarator;Pointer;FunctionCallExpression;IdExpression;Name;BinaryExpression;LiteralExpression;TypeIdExpression;TypeId;SimpleDeclSpecifier;Declarator;IfStatement;BinaryExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;UnaryExpression;LiteralExpression;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Pointer;Name;EqualsInitializer;UnaryExpression;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;LiteralExpression;BinaryExpression;LiteralExpression;LiteralExpression;ExpressionStatement;BinaryExpression;ArraySubscriptExpression;IdExpression;Name;BinaryExpression;LiteralExpression;LiteralExpression;LiteralExpression;ExpressionStatement;BinaryExpression;UnaryExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Pointer;Name;EqualsInitializer;UnaryExpression;IdExpression;Name;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;ArrayDeclarator;Name;ArrayModifier;LiteralExpression;EqualsInitializer;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;FunctionCallExpression;IdExpression;Name;IdExpression;Name;LiteralExpression;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;
-----ast_node-----
void CWE122_Heap_Based_Buffer_Overflow__c_CWE806_char_snprintf_32_bad(){    char * data;    char * *dataPtr1 = &data;    char * *dataPtr2 = &data;    data = (char *)malloc(100*sizeof(char));    if (data == NULL) {exit(-1);}    {        char * data = *dataPtr1;        /* FLAW: Initialize data as a large buffer that is larger than the small buffer used in the sink */        memset(data, 'A', 100-1); /* fill with 'A's */        data[100-1] = '\0'; /* null terminate */        *dataPtr1 = data;    }    {        char * data = *dataPtr2;        {            char dest[50] = "";            /* POTENTIAL FLAW: Possible buffer overflow if data is larger than dest */            SNPRINTF(dest, strlen(data), "%s", data);            printLine(data);            free(data);        }    }}
void
CWE122_Heap_Based_Buffer_Overflow__c_CWE806_char_snprintf_32_bad()
CWE122_Heap_Based_Buffer_Overflow__c_CWE806_char_snprintf_32_bad
{    char * data;    char * *dataPtr1 = &data;    char * *dataPtr2 = &data;    data = (char *)malloc(100*sizeof(char));    if (data == NULL) {exit(-1);}    {        char * data = *dataPtr1;        /* FLAW: Initialize data as a large buffer that is larger than the small buffer used in the sink */        memset(data, 'A', 100-1); /* fill with 'A's */        data[100-1] = '\0'; /* null terminate */        *dataPtr1 = data;    }    {        char * data = *dataPtr2;        {            char dest[50] = "";            /* POTENTIAL FLAW: Possible buffer overflow if data is larger than dest */            SNPRINTF(dest, strlen(data), "%s", data);            printLine(data);            free(data);        }    }}
char * data;
char * data;
char
* data
*
data
char * *dataPtr1 = &data;
char * *dataPtr1 = &data;
char
* *dataPtr1 = &data
*
*
dataPtr1
= &data
&data
data
data
char * *dataPtr2 = &data;
char * *dataPtr2 = &data;
char
* *dataPtr2 = &data
*
*
dataPtr2
= &data
&data
data
data
data = (char *)malloc(100*sizeof(char));
data = (char *)malloc(100*sizeof(char))
data
data
(char *)malloc(100*sizeof(char))
char *
char
*
*
malloc(100*sizeof(char))
malloc
malloc
100*sizeof(char)
100
sizeof(char)
char
char

if (data == NULL) {exit(-1);}
data == NULL
data
data
NULL
NULL
{exit(-1);}
exit(-1);
exit(-1)
exit
exit
-1
1
{        char * data = *dataPtr1;        /* FLAW: Initialize data as a large buffer that is larger than the small buffer used in the sink */        memset(data, 'A', 100-1); /* fill with 'A's */        data[100-1] = '\0'; /* null terminate */        *dataPtr1 = data;    }
char * data = *dataPtr1;
char * data = *dataPtr1;
char
* data = *dataPtr1
*
data
= *dataPtr1
*dataPtr1
dataPtr1
dataPtr1
memset(data, 'A', 100-1);
memset(data, 'A', 100-1)
memset
memset
data
data
'A'
100-1
100
1
data[100-1] = '\0';
data[100-1] = '\0'
data[100-1]
data
data
100-1
100
1
'\0'
*dataPtr1 = data;
*dataPtr1 = data
*dataPtr1
dataPtr1
dataPtr1
data
data
{        char * data = *dataPtr2;        {            char dest[50] = "";            /* POTENTIAL FLAW: Possible buffer overflow if data is larger than dest */            SNPRINTF(dest, strlen(data), "%s", data);            printLine(data);            free(data);        }    }
char * data = *dataPtr2;
char * data = *dataPtr2;
char
* data = *dataPtr2
*
data
= *dataPtr2
*dataPtr2
dataPtr2
dataPtr2
{            char dest[50] = "";            /* POTENTIAL FLAW: Possible buffer overflow if data is larger than dest */            SNPRINTF(dest, strlen(data), "%s", data);            printLine(data);            free(data);        }
char dest[50] = "";
char dest[50] = "";
char
dest[50] = ""
dest
[50]
50
= ""
""
SNPRINTF(dest, strlen(data), "%s", data);
SNPRINTF(dest, strlen(data), "%s", data)
SNPRINTF
SNPRINTF
dest
dest
strlen(data)
strlen
strlen
data
data
"%s"
data
data
printLine(data);
printLine(data)
printLine
printLine
data
data
free(data);
free(data)
free
free
data
data
-----joern-----
(48,57,0)
(46,42,0)
(67,54,0)
(43,28,0)
(60,52,0)
(31,18,0)
(47,2,0)
(57,48,0)
(49,56,0)
(26,47,0)
(47,39,0)
(9,60,0)
(1,36,0)
(44,5,0)
(60,7,0)
(70,5,0)
(30,60,0)
(28,4,0)
(4,28,0)
(67,71,0)
(42,7,0)
(53,2,0)
(51,44,0)
(6,68,0)
(25,62,0)
(18,63,0)
(30,42,0)
(0,54,0)
(55,7,0)
(22,32,0)
(56,36,0)
(29,57,0)
(28,39,0)
(15,8,0)
(62,25,0)
(36,56,0)
(52,60,0)
(19,60,0)
(32,41,0)
(17,4,0)
(21,4,0)
(0,31,0)
(38,32,0)
(4,63,0)
(8,42,0)
(71,18,0)
(23,63,0)
(73,63,0)
(65,5,0)
(39,47,0)
(11,62,0)
(71,67,0)
(10,71,0)
(64,31,0)
(54,68,0)
(35,54,0)
(27,67,0)
(44,18,0)
(28,43,0)
(33,41,0)
(8,60,0)
(20,30,0)
(66,44,0)
(52,48,0)
(72,40,0)
(36,71,0)
(48,63,0)
(32,9,0)
(7,63,0)
(2,47,0)
(59,17,0)
(24,63,0)
(32,60,0)
(32,42,0)
(54,63,0)
(34,18,0)
(16,9,0)
(39,28,0)
(58,63,0)
(36,40,0)
(3,52,0)
(9,32,0)
(68,54,0)
(5,44,0)
(61,56,0)
(12,17,0)
(45,0,0)
(41,42,0)
(31,71,0)
(13,32,0)
(40,18,0)
(44,71,0)
(14,48,0)
(37,41,0)
(25,69,0)
(10,17,1)
(6,35,1)
(68,6,1)
(5,70,1)
(29,14,1)
(48,57,1)
(4,28,1)
(59,4,1)
(31,64,1)
(31,71,1)
(32,9,1)
(64,0,1)
(49,61,1)
(40,72,1)
(52,48,1)
(52,3,1)
(54,68,1)
(30,20,1)
(51,66,1)
(62,11,1)
(19,31,1)
(1,44,1)
(17,12,1)
(21,48,1)
(8,15,1)
(16,22,1)
(17,4,1)
(32,13,1)
(32,60,1)
(9,60,1)
(14,54,1)
(12,59,1)
(38,9,1)
(15,32,1)
(71,67,1)
(11,17,1)
(36,56,1)
(56,49,1)
(61,1,1)
(9,16,1)
(30,60,1)
(22,41,1)
(67,54,1)
(66,71,1)
(41,33,1)
(36,71,1)
(8,60,1)
(72,36,1)
(53,26,1)
(28,39,1)
(32,41,1)
(13,38,1)
(44,5,1)
(0,45,1)
(44,71,1)
(26,21,1)
(27,10,1)
(0,54,1)
(39,47,1)
(67,27,1)
(45,40,1)
(33,37,1)
(70,65,1)
(20,8,1)
(60,52,1)
(65,51,1)
(57,29,1)
(25,62,1)
(2,53,1)
(28,43,1)
(10,25,1)
(37,60,1)
(50,30,1)
(47,2,1)
(3,19,1)
(17,4,2)
(9,60,2)
(62,17,2)
(52,48,2)
(71,67,2)
(44,5,2)
(47,2,2)
(67,54,2)
(54,68,2)
(25,62,2)
(32,41,2)
(32,60,2)
(28,43,2)
(28,39,2)
(31,71,2)
(36,56,2)
(0,54,2)
(36,71,2)
(8,60,2)
(25,17,2)
(44,71,2)
(60,52,2)
(48,57,2)
(30,60,2)
(4,28,2)
(39,47,2)
(11,17,2)
(32,9,2)
-----------------------------------
(0,*dataPtr1)
(1,data)
(2,sizeof(char)
(3,dataPtr2)
(4,data = (char *)
(5,100-1)
(6,data)
(7,)
(8,printLine(data)
(9,strlen(data)
(10,data)
(11,1)
(12,NULL)
(13,data)
(14,dataPtr2)
(15,data)
(16,data)
(17,data == NULL)
(18,)
(19,data)
(20,data)
(21,data)
(22,dest)
(23,if (data == NULL)
(24,data)
(25,exit(-1)
(26,100)
(27,dataPtr1)
(28,(char *)
(29,data)
(30,free(data)
(31,*dataPtr1 = data)
(32,SNPRINTF(dest, strlen(data)
(33,"")
(34,data)
(35,dataPtr1)
(36,data[100-1])
(37,dest)
(38,"%s")
(39,malloc(100*sizeof(char)
(40,data[100-1] = \\\'\\\\0\\\')
(41,dest[50] = "")
(42,)
(43,char *)
(44,memset(data, \\\'A\\\', 100-1)
(45,dataPtr1)
(46,dest)
(47,100*sizeof(char)
(48,* *dataPtr2 = &data)
(49,1)
(50,RET)
(51,\\\'A\\\')
(52,*dataPtr2)
(53,char)
(54,* *dataPtr1 = &data)
(55,data)
(56,100-1)
(57,&data)
(58,dataPtr2)
(59,data)
(60,* data = *dataPtr2)
(61,100)
(62,-1)
(63,)
(64,data)
(65,100)
(66,data)
(67,*dataPtr1)
(68,&data)
(69,)
(70,1)
(71,* data = *dataPtr1)
(72,\\\'\\\\0\\\')
(73,dataPtr1)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^