-----label-----
1
-----code-----
void CWE122_Heap_Based_Buffer_Overflow__c_CWE806_char_ncpy_32_bad()
{
    char * data;
    char * *dataPtr1 = &data;
    char * *dataPtr2 = &data;
    data = (char *)malloc(100*sizeof(char));
    if (data == NULL) {exit(-1);}
    {
        char * data = *dataPtr1;
        /* FLAW: Initialize data as a large buffer that is larger than the small buffer used in the sink */
        memset(data, 'A', 100-1); /* fill with 'A's */
        data[100-1] = '\0'; /* null terminate */
        *dataPtr1 = data;
    }
    {
        char * data = *dataPtr2;
        {
            char dest[50] = "";
            /* POTENTIAL FLAW: Possible buffer overflow if data is larger than dest */
            strncpy(dest, data, strlen(data));
            dest[50-1] = '\0'; /* Ensure the destination buffer is null terminated */
            printLine(data);
            free(data);
        }
    }
}
-----children-----
1,2
1,3
1,4
3,4
5,6
5,7
5,8
5,9
5,10
5,11
5,12
6,7
7,8
7,9
9,10
9,11
12,13
13,14
13,15
15,16
15,17
15,18
15,19
19,20
20,21
21,22
23,24
24,25
24,26
26,27
26,28
26,29
26,30
30,31
31,32
32,33
34,35
35,36
35,37
36,37
38,39
38,40
39,40
39,41
41,42
43,44
43,45
44,45
46,47
46,48
48,49
49,50
49,51
52,53
52,54
53,54
53,55
54,55
56,57
58,59
59,60
60,61
60,62
61,62
63,64
65,66
65,67
65,68
65,69
66,67
67,68
67,69
69,70
69,71
69,72
72,73
73,74
74,75
76,77
77,78
77,79
77,80
77,81
78,79
80,81
83,84
83,85
86,87
87,88
87,89
88,89
88,90
89,90
91,92
91,93
95,96
96,97
96,98
97,98
98,99
100,101
102,103
102,104
103,104
104,105
104,106
106,107
106,108
106,109
109,110
110,111
111,112
113,114
113,115
113,116
113,117
113,118
114,115
115,116
115,117
117,118
117,119
117,120
119,120
121,122
123,124
124,125
124,126
124,127
124,128
125,126
127,128
129,130
131,132
131,133
132,133
134,135
136,137
137,138
137,139
138,139
138,140
139,140
141,142
141,143
145,146
146,147
146,148
147,148
149,150
151,152
152,153
152,154
153,154
155,156
-----nextToken-----
2,4,8,10,11,14,16,17,18,22,25,27,28,29,33,37,40,42,45,47,50,51,55,57,62,64,68,70,71,75,79,81,82,84,85,90,92,93,94,99,101,105,107,108,112,116,118,120,122,126,128,130,133,135,140,142,143,144,148,150,154,156
-----computeFrom-----
35,36
35,37
46,47
46,48
53,54
53,55
83,84
83,85
87,88
87,89
91,92
91,93
96,97
96,98
137,138
137,139
141,142
141,143
-----guardedBy-----
-----guardedByNegation-----
-----lastLexicalUse-----
-----jump-----
-----attribute-----
FunctionDefinition;SimpleDeclSpecifier;FunctionDeclarator;Name;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Pointer;Name;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Pointer;Pointer;Name;EqualsInitializer;UnaryExpression;IdExpression;Name;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Pointer;Pointer;Name;EqualsInitializer;UnaryExpression;IdExpression;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;CastExpression;TypeId;SimpleDeclSpecifier;Declarator;Pointer;FunctionCallExpression;IdExpression;Name;BinaryExpression;LiteralExpression;TypeIdExpression;TypeId;SimpleDeclSpecifier;Declarator;IfStatement;BinaryExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;UnaryExpression;LiteralExpression;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Pointer;Name;EqualsInitializer;UnaryExpression;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;LiteralExpression;BinaryExpression;LiteralExpression;LiteralExpression;ExpressionStatement;BinaryExpression;ArraySubscriptExpression;IdExpression;Name;BinaryExpression;LiteralExpression;LiteralExpression;LiteralExpression;ExpressionStatement;BinaryExpression;UnaryExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Pointer;Name;EqualsInitializer;UnaryExpression;IdExpression;Name;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;ArrayDeclarator;Name;ArrayModifier;LiteralExpression;EqualsInitializer;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;FunctionCallExpression;IdExpression;Name;IdExpression;Name;ExpressionStatement;BinaryExpression;ArraySubscriptExpression;IdExpression;Name;BinaryExpression;LiteralExpression;LiteralExpression;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;
-----ast_node-----
void CWE122_Heap_Based_Buffer_Overflow__c_CWE806_char_ncpy_32_bad(){    char * data;    char * *dataPtr1 = &data;    char * *dataPtr2 = &data;    data = (char *)malloc(100*sizeof(char));    if (data == NULL) {exit(-1);}    {        char * data = *dataPtr1;        /* FLAW: Initialize data as a large buffer that is larger than the small buffer used in the sink */        memset(data, 'A', 100-1); /* fill with 'A's */        data[100-1] = '\0'; /* null terminate */        *dataPtr1 = data;    }    {        char * data = *dataPtr2;        {            char dest[50] = "";            /* POTENTIAL FLAW: Possible buffer overflow if data is larger than dest */            strncpy(dest, data, strlen(data));            dest[50-1] = '\0'; /* Ensure the destination buffer is null terminated */            printLine(data);            free(data);        }    }}
void
CWE122_Heap_Based_Buffer_Overflow__c_CWE806_char_ncpy_32_bad()
CWE122_Heap_Based_Buffer_Overflow__c_CWE806_char_ncpy_32_bad
{    char * data;    char * *dataPtr1 = &data;    char * *dataPtr2 = &data;    data = (char *)malloc(100*sizeof(char));    if (data == NULL) {exit(-1);}    {        char * data = *dataPtr1;        /* FLAW: Initialize data as a large buffer that is larger than the small buffer used in the sink */        memset(data, 'A', 100-1); /* fill with 'A's */        data[100-1] = '\0'; /* null terminate */        *dataPtr1 = data;    }    {        char * data = *dataPtr2;        {            char dest[50] = "";            /* POTENTIAL FLAW: Possible buffer overflow if data is larger than dest */            strncpy(dest, data, strlen(data));            dest[50-1] = '\0'; /* Ensure the destination buffer is null terminated */            printLine(data);            free(data);        }    }}
char * data;
char * data;
char
* data
*
data
char * *dataPtr1 = &data;
char * *dataPtr1 = &data;
char
* *dataPtr1 = &data
*
*
dataPtr1
= &data
&data
data
data
char * *dataPtr2 = &data;
char * *dataPtr2 = &data;
char
* *dataPtr2 = &data
*
*
dataPtr2
= &data
&data
data
data
data = (char *)malloc(100*sizeof(char));
data = (char *)malloc(100*sizeof(char))
data
data
(char *)malloc(100*sizeof(char))
char *
char
*
*
malloc(100*sizeof(char))
malloc
malloc
100*sizeof(char)
100
sizeof(char)
char
char

if (data == NULL) {exit(-1);}
data == NULL
data
data
NULL
NULL
{exit(-1);}
exit(-1);
exit(-1)
exit
exit
-1
1
{        char * data = *dataPtr1;        /* FLAW: Initialize data as a large buffer that is larger than the small buffer used in the sink */        memset(data, 'A', 100-1); /* fill with 'A's */        data[100-1] = '\0'; /* null terminate */        *dataPtr1 = data;    }
char * data = *dataPtr1;
char * data = *dataPtr1;
char
* data = *dataPtr1
*
data
= *dataPtr1
*dataPtr1
dataPtr1
dataPtr1
memset(data, 'A', 100-1);
memset(data, 'A', 100-1)
memset
memset
data
data
'A'
100-1
100
1
data[100-1] = '\0';
data[100-1] = '\0'
data[100-1]
data
data
100-1
100
1
'\0'
*dataPtr1 = data;
*dataPtr1 = data
*dataPtr1
dataPtr1
dataPtr1
data
data
{        char * data = *dataPtr2;        {            char dest[50] = "";            /* POTENTIAL FLAW: Possible buffer overflow if data is larger than dest */            strncpy(dest, data, strlen(data));            dest[50-1] = '\0'; /* Ensure the destination buffer is null terminated */            printLine(data);            free(data);        }    }
char * data = *dataPtr2;
char * data = *dataPtr2;
char
* data = *dataPtr2
*
data
= *dataPtr2
*dataPtr2
dataPtr2
dataPtr2
{            char dest[50] = "";            /* POTENTIAL FLAW: Possible buffer overflow if data is larger than dest */            strncpy(dest, data, strlen(data));            dest[50-1] = '\0'; /* Ensure the destination buffer is null terminated */            printLine(data);            free(data);        }
char dest[50] = "";
char dest[50] = "";
char
dest[50] = ""
dest
[50]
50
= ""
""
strncpy(dest, data, strlen(data));
strncpy(dest, data, strlen(data))
strncpy
strncpy
dest
dest
data
data
strlen(data)
strlen
strlen
data
data
dest[50-1] = '\0';
dest[50-1] = '\0'
dest[50-1]
dest
dest
50-1
50
1
'\0'
printLine(data);
printLine(data)
printLine
printLine
data
data
free(data);
free(data)
free
free
data
data
-----joern-----
(38,66,0)
(8,74,0)
(37,56,0)
(55,12,0)
(52,45,0)
(17,33,0)
(19,46,0)
(26,48,0)
(27,78,0)
(53,36,0)
(48,74,0)
(43,8,0)
(64,33,0)
(23,26,0)
(47,17,0)
(55,71,0)
(6,33,0)
(2,48,0)
(46,19,0)
(54,15,0)
(64,26,0)
(46,66,0)
(6,78,0)
(70,33,0)
(44,67,0)
(73,67,0)
(22,66,0)
(67,74,0)
(28,58,0)
(3,67,0)
(0,19,0)
(31,77,0)
(56,14,0)
(5,33,0)
(55,10,0)
(66,8,0)
(78,26,0)
(65,64,0)
(66,22,0)
(60,27,0)
(14,56,0)
(12,55,0)
(35,74,0)
(51,12,0)
(33,48,0)
(17,6,0)
(46,8,0)
(1,31,0)
(4,78,0)
(56,71,0)
(18,6,0)
(45,74,0)
(79,70,0)
(62,21,0)
(6,17,0)
(24,49,0)
(45,15,0)
(44,33,0)
(30,26,0)
(77,31,0)
(58,27,0)
(34,6,0)
(10,55,0)
(71,56,0)
(25,46,0)
(6,26,0)
(15,45,0)
(11,74,0)
(36,13,0)
(29,8,0)
(76,3,0)
(39,13,0)
(62,66,0)
(13,8,0)
(57,14,0)
(63,22,0)
(68,58,0)
(69,49,0)
(33,44,0)
(20,21,0)
(21,62,0)
(40,46,0)
(49,12,0)
(70,26,0)
(59,74,0)
(42,62,0)
(67,3,0)
(62,43,0)
(36,45,0)
(27,58,0)
(75,19,0)
(16,21,0)
(77,9,0)
(13,66,0)
(71,55,0)
(41,74,0)
(50,78,0)
(27,23,0)
(32,44,0)
(12,74,0)
(72,23,0)
(22,45,0)
(61,43,0)
(60,6,1)
(49,69,1)
(70,79,1)
(27,78,1)
(44,67,1)
(68,60,1)
(42,46,1)
(21,20,1)
(55,10,1)
(45,15,1)
(66,22,1)
(13,39,1)
(17,47,1)
(28,68,1)
(78,50,1)
(7,64,1)
(37,51,1)
(12,55,1)
(6,17,1)
(1,49,1)
(49,12,1)
(51,67,1)
(57,37,1)
(5,13,1)
(16,42,1)
(31,1,1)
(19,75,1)
(6,33,1)
(73,45,1)
(4,33,1)
(24,12,1)
(14,57,1)
(79,23,1)
(32,5,1)
(25,40,1)
(63,38,1)
(15,54,1)
(38,77,1)
(27,58,1)
(54,52,1)
(53,43,1)
(44,32,1)
(23,72,1)
(58,28,1)
(0,25,1)
(20,16,1)
(69,24,1)
(72,27,1)
(36,45,1)
(17,33,1)
(67,3,1)
(13,66,1)
(47,18,1)
(34,78,1)
(50,4,1)
(76,73,1)
(64,33,1)
(18,34,1)
(64,65,1)
(22,45,1)
(61,62,1)
(70,33,1)
(77,31,1)
(62,21,1)
(62,66,1)
(3,76,1)
(55,71,1)
(22,63,1)
(56,14,1)
(40,66,1)
(36,53,1)
(39,36,1)
(43,61,1)
(33,44,1)
(46,66,1)
(6,78,1)
(38,49,1)
(71,56,1)
(65,70,1)
(46,19,1)
(75,0,1)
(55,10,2)
(12,55,2)
(77,31,2)
(31,49,2)
(62,21,2)
(64,33,2)
(13,66,2)
(46,66,2)
(70,33,2)
(71,56,2)
(66,22,2)
(17,33,2)
(36,45,2)
(49,12,2)
(46,19,2)
(45,15,2)
(6,33,2)
(22,45,2)
(27,58,2)
(33,44,2)
(44,67,2)
(77,49,2)
(1,49,2)
(67,3,2)
(55,71,2)
(6,78,2)
(27,78,2)
(62,66,2)
(56,14,2)
(6,17,2)
-----------------------------------
(0,100)
(1,1)
(2,data)
(3,&data)
(4,dest)
(5,data)
(6,strncpy(dest, data, strlen(data)
(7,RET)
(8,)
(9,)
(10,char *)
(11,dataPtr2)
(12,data = (char *)
(13,*dataPtr1 = data)
(14,sizeof(char)
(15,&data)
(16,100)
(17,strlen(data)
(18,data)
(19,100-1)
(20,1)
(21,100-1)
(22,*dataPtr1)
(23,dest[50-1] = \\\'\\\\0\\\')
(24,data)
(25,\\\'A\\\')
(26,)
(27,dest[50-1])
(28,1)
(29,data)
(30,dest)
(31,-1)
(32,dataPtr2)
(33,* data = *dataPtr2)
(34,dest)
(35,if (data == NULL)
(36,*dataPtr1)
(37,100)
(38,data)
(39,data)
(40,data)
(41,dataPtr1)
(42,data)
(43,data[100-1] = \\\'\\\\0\\\')
(44,*dataPtr2)
(45,* *dataPtr1 = &data)
(46,memset(data, \\\'A\\\', 100-1)
(47,data)
(48,)
(49,data == NULL)
(50,"")
(51,data)
(52,dataPtr1)
(53,dataPtr1)
(54,data)
(55,(char *)
(56,100*sizeof(char)
(57,char)
(58,50-1)
(59,data)
(60,dest)
(61,\\\'\\\\0\\\')
(62,data[100-1])
(63,dataPtr1)
(64,free(data)
(65,data)
(66,* data = *dataPtr1)
(67,* *dataPtr2 = &data)
(68,50)
(69,NULL)
(70,printLine(data)
(71,malloc(100*sizeof(char)
(72,\\\'\\\\0\\\')
(73,dataPtr2)
(74,)
(75,1)
(76,data)
(77,exit(-1)
(78,dest[50] = "")
(79,data)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^