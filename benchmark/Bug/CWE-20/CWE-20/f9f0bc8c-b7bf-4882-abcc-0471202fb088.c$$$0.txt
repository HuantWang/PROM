-----label-----
1
-----code-----
void CWE122_Heap_Based_Buffer_Overflow__c_CWE129_fgets_64b_badSink(void * dataVoidPtr)
{
    /* cast void pointer to a pointer of the appropriate type */
    int * dataPtr = (int *)dataVoidPtr;
    /* dereference dataPtr into data */
    int data = (*dataPtr);
    {
        int i;
        int * buffer = (int *)malloc(10 * sizeof(int));
        if (buffer == NULL) {exit(-1);}
        /* initialize buffer */
        for (i = 0; i < 10; i++)
        {
            buffer[i] = 0;
        }
        /* POTENTIAL FLAW: Attempt to write to an index of the array that is above the upper bound
         * This code does check to see if the array index is negative */
        if (data >= 0)
        {
            buffer[data] = 1;
            /* Print the array values */
            for(i = 0; i < 10; i++)
            {
                printIntLine(buffer[i]);
            }
        }
        else
        {
            printLine("ERROR: Array index is negative.");
        }
        free(buffer);
    }
}
-----children-----
1,2
1,3
1,4
3,4
3,5
5,6
5,7
7,8
7,9
10,11
10,12
10,13
11,12
12,13
12,14
14,15
14,16
14,17
17,18
18,19
18,20
19,20
19,21
21,22
23,24
25,26
26,27
26,28
28,29
28,30
30,31
31,32
32,33
33,34
35,36
35,37
35,38
35,39
35,40
35,41
36,37
37,38
37,39
39,40
41,42
42,43
42,44
44,45
44,46
44,47
47,48
48,49
48,50
49,50
49,51
51,52
53,54
53,55
54,55
56,57
56,58
58,59
59,60
59,61
62,63
62,64
63,64
63,65
64,65
66,67
68,69
69,70
70,71
70,72
71,72
73,74
75,76
75,77
75,78
75,79
76,77
77,78
77,79
78,79
81,82
81,83
82,83
85,86
86,87
88,89
89,90
90,91
90,92
91,92
91,93
92,93
94,95
97,98
97,99
97,100
98,99
98,100
99,100
102,103
102,104
103,104
104,105
104,106
105,106
105,107
106,107
108,109
111,112
111,113
111,114
111,115
112,113
113,114
113,115
114,115
117,118
117,119
118,119
121,122
122,123
124,125
125,126
126,127
126,128
127,128
129,130
129,131
130,131
132,133
134,135
135,136
136,137
136,138
137,138
140,141
141,142
141,143
142,143
144,145
-----nextToken-----
2,4,6,8,9,13,15,16,20,22,24,27,29,34,38,40,43,45,46,50,52,55,57,60,61,65,67,72,74,79,80,83,84,87,93,95,96,100,101,107,109,110,115,116,119,120,123,128,131,133,138,139,143,145
-----computeFrom-----
56,57
56,58
63,64
63,65
77,78
77,79
81,82
81,83
90,91
90,92
98,99
98,100
104,105
104,106
113,114
113,115
117,118
117,119
-----guardedBy-----
100,109
-----guardedByNegation-----
-----lastLexicalUse-----
-----jump-----
-----attribute-----
FunctionDefinition;SimpleDeclSpecifier;FunctionDeclarator;Name;ParameterDeclaration;SimpleDeclSpecifier;Declarator;Pointer;Name;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Pointer;Name;EqualsInitializer;CastExpression;TypeId;SimpleDeclSpecifier;Declarator;Pointer;IdExpression;Name;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Name;EqualsInitializer;UnaryExpression;UnaryExpression;IdExpression;Name;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Name;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Pointer;Name;EqualsInitializer;CastExpression;TypeId;SimpleDeclSpecifier;Declarator;Pointer;FunctionCallExpression;IdExpression;Name;BinaryExpression;LiteralExpression;TypeIdExpression;TypeId;SimpleDeclSpecifier;Declarator;IfStatement;BinaryExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;UnaryExpression;LiteralExpression;ForStatement;ExpressionStatement;BinaryExpression;IdExpression;Name;LiteralExpression;BinaryExpression;IdExpression;Name;LiteralExpression;UnaryExpression;IdExpression;Name;CompoundStatement;ExpressionStatement;BinaryExpression;ArraySubscriptExpression;IdExpression;Name;IdExpression;Name;LiteralExpression;IfStatement;BinaryExpression;IdExpression;Name;LiteralExpression;CompoundStatement;ExpressionStatement;BinaryExpression;ArraySubscriptExpression;IdExpression;Name;IdExpression;Name;LiteralExpression;ForStatement;ExpressionStatement;BinaryExpression;IdExpression;Name;LiteralExpression;BinaryExpression;IdExpression;Name;LiteralExpression;UnaryExpression;IdExpression;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;ArraySubscriptExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;
-----ast_node-----
void CWE122_Heap_Based_Buffer_Overflow__c_CWE129_fgets_64b_badSink(void * dataVoidPtr){    /* cast void pointer to a pointer of the appropriate type */    int * dataPtr = (int *)dataVoidPtr;    /* dereference dataPtr into data */    int data = (*dataPtr);    {        int i;        int * buffer = (int *)malloc(10 * sizeof(int));        if (buffer == NULL) {exit(-1);}        /* initialize buffer */        for (i = 0; i < 10; i++)        {            buffer[i] = 0;        }        /* POTENTIAL FLAW: Attempt to write to an index of the array that is above the upper bound         * This code does check to see if the array index is negative */        if (data >= 0)        {            buffer[data] = 1;            /* Print the array values */            for(i = 0; i < 10; i++)            {                printIntLine(buffer[i]);            }        }        else        {            printLine("ERROR: Array index is negative.");        }        free(buffer);    }}
void
CWE122_Heap_Based_Buffer_Overflow__c_CWE129_fgets_64b_badSink(void * dataVoidPtr)
CWE122_Heap_Based_Buffer_Overflow__c_CWE129_fgets_64b_badSink
void * dataVoidPtr
void
* dataVoidPtr
*
dataVoidPtr
{    /* cast void pointer to a pointer of the appropriate type */    int * dataPtr = (int *)dataVoidPtr;    /* dereference dataPtr into data */    int data = (*dataPtr);    {        int i;        int * buffer = (int *)malloc(10 * sizeof(int));        if (buffer == NULL) {exit(-1);}        /* initialize buffer */        for (i = 0; i < 10; i++)        {            buffer[i] = 0;        }        /* POTENTIAL FLAW: Attempt to write to an index of the array that is above the upper bound         * This code does check to see if the array index is negative */        if (data >= 0)        {            buffer[data] = 1;            /* Print the array values */            for(i = 0; i < 10; i++)            {                printIntLine(buffer[i]);            }        }        else        {            printLine("ERROR: Array index is negative.");        }        free(buffer);    }}
int * dataPtr = (int *)dataVoidPtr;
int * dataPtr = (int *)dataVoidPtr;
int
* dataPtr = (int *)dataVoidPtr
*
dataPtr
= (int *)dataVoidPtr
(int *)dataVoidPtr
int *
int
*
*
dataVoidPtr
dataVoidPtr
int data = (*dataPtr);
int data = (*dataPtr);
int
data = (*dataPtr)
data
= (*dataPtr)
(*dataPtr)
*dataPtr
dataPtr
dataPtr
{        int i;        int * buffer = (int *)malloc(10 * sizeof(int));        if (buffer == NULL) {exit(-1);}        /* initialize buffer */        for (i = 0; i < 10; i++)        {            buffer[i] = 0;        }        /* POTENTIAL FLAW: Attempt to write to an index of the array that is above the upper bound         * This code does check to see if the array index is negative */        if (data >= 0)        {            buffer[data] = 1;            /* Print the array values */            for(i = 0; i < 10; i++)            {                printIntLine(buffer[i]);            }        }        else        {            printLine("ERROR: Array index is negative.");        }        free(buffer);    }
int i;
int i;
int
i
i
int * buffer = (int *)malloc(10 * sizeof(int));
int * buffer = (int *)malloc(10 * sizeof(int));
int
* buffer = (int *)malloc(10 * sizeof(int))
*
buffer
= (int *)malloc(10 * sizeof(int))
(int *)malloc(10 * sizeof(int))
int *
int
*
*
malloc(10 * sizeof(int))
malloc
malloc
10 * sizeof(int)
10
sizeof(int)
int
int

if (buffer == NULL) {exit(-1);}
buffer == NULL
buffer
buffer
NULL
NULL
{exit(-1);}
exit(-1);
exit(-1)
exit
exit
-1
1
for (i = 0; i < 10; i++)        {            buffer[i] = 0;        }
i = 0;
i = 0
i
i
0
i < 10
i
i
10
i++
i
i
{            buffer[i] = 0;        }
buffer[i] = 0;
buffer[i] = 0
buffer[i]
buffer
buffer
i
i
0
if (data >= 0)        {            buffer[data] = 1;            /* Print the array values */            for(i = 0; i < 10; i++)            {                printIntLine(buffer[i]);            }        }        else        {            printLine("ERROR: Array index is negative.");        }
data >= 0
data
data
0
{            buffer[data] = 1;            /* Print the array values */            for(i = 0; i < 10; i++)            {                printIntLine(buffer[i]);            }        }
buffer[data] = 1;
buffer[data] = 1
buffer[data]
buffer
buffer
data
data
1
for(i = 0; i < 10; i++)            {                printIntLine(buffer[i]);            }
i = 0;
i = 0
i
i
0
i < 10
i
i
10
i++
i
i
{                printIntLine(buffer[i]);            }
printIntLine(buffer[i]);
printIntLine(buffer[i])
printIntLine
printIntLine
buffer[i]
buffer
buffer
i
i
{            printLine("ERROR: Array index is negative.");        }
printLine("ERROR: Array index is negative.");
printLine("ERROR: Array index is negative.")
printLine
printLine
"ERROR: Array index is negative."
free(buffer);
free(buffer)
free
free
buffer
buffer
-----joern-----
(58,44,0)
(9,8,0)
(53,12,0)
(18,10,0)
(37,72,0)
(71,13,0)
(23,20,0)
(66,30,0)
(4,22,0)
(17,25,0)
(4,15,0)
(48,56,0)
(30,12,0)
(56,4,0)
(56,15,0)
(5,50,0)
(43,12,0)
(62,72,0)
(28,1,0)
(22,65,0)
(16,10,0)
(51,15,0)
(69,33,0)
(3,65,0)
(42,76,0)
(10,64,0)
(15,64,0)
(46,35,0)
(3,0,0)
(61,16,0)
(22,4,0)
(65,3,0)
(49,24,0)
(77,3,0)
(10,16,0)
(35,50,0)
(42,20,0)
(39,4,0)
(36,24,0)
(41,10,0)
(57,15,0)
(47,15,0)
(67,15,0)
(26,74,0)
(59,44,0)
(44,74,0)
(75,20,0)
(24,49,0)
(44,12,0)
(22,34,0)
(45,9,0)
(73,42,0)
(14,41,0)
(0,3,0)
(74,52,0)
(50,25,0)
(11,0,0)
(2,15,0)
(68,4,0)
(76,42,0)
(32,39,0)
(65,22,0)
(29,64,0)
(16,1,0)
(33,31,0)
(76,38,0)
(6,35,0)
(21,30,0)
(35,4,0)
(42,74,0)
(24,27,0)
(13,12,0)
(42,4,0)
(60,41,0)
(70,75,0)
(35,10,0)
(55,45,0)
(63,39,0)
(1,24,0)
(34,22,0)
(24,1,0)
(1,64,0)
(54,64,0)
(9,45,0)
(44,4,0)
(40,20,0)
(72,20,0)
(19,42,0)
(75,20,1)
(42,19,1)
(62,37,1)
(70,76,1)
(37,20,1)
(39,32,1)
(76,42,1)
(18,1,1)
(37,75,1)
(24,49,1)
(41,60,1)
(59,58,1)
(50,5,1)
(24,36,1)
(3,0,1)
(72,62,1)
(41,10,1)
(48,72,1)
(75,70,1)
(42,4,1)
(16,1,1)
(12,53,1)
(39,4,1)
(10,16,1)
(35,6,1)
(68,10,1)
(0,11,1)
(22,34,1)
(61,18,1)
(45,55,1)
(13,12,1)
(56,48,1)
(66,12,1)
(44,4,1)
(33,69,1)
(11,77,1)
(30,21,1)
(16,61,1)
(9,45,1)
(69,41,1)
(55,39,1)
(1,24,1)
(35,4,1)
(48,33,1)
(40,50,1)
(14,30,1)
(44,12,1)
(44,59,1)
(46,41,1)
(5,35,1)
(21,66,1)
(60,14,1)
(74,26,1)
(23,40,1)
(66,13,1)
(63,4,1)
(43,39,1)
(13,71,1)
(72,20,1)
(77,68,1)
(58,30,1)
(53,43,1)
(7,56,1)
(35,10,1)
(71,74,1)
(65,3,1)
(43,9,1)
(56,4,1)
(32,63,1)
(19,73,1)
(24,27,1)
(30,12,1)
(22,65,1)
(6,46,1)
(73,72,1)
(4,22,1)
(26,44,1)
(42,20,1)
(36,28,1)
(42,74,1)
(20,23,1)
(65,3,2)
(42,4,2)
(13,12,2)
(5,41,2)
(19,72,2)
(4,22,2)
(20,41,2)
(62,41,2)
(37,41,2)
(24,49,2)
(30,12,2)
(45,39,2)
(22,65,2)
(21,30,2)
(1,24,2)
(33,41,2)
(41,10,2)
(22,34,2)
(74,30,2)
(44,4,2)
(58,30,2)
(59,30,2)
(10,16,2)
(37,72,2)
(35,10,2)
(42,74,2)
(75,72,2)
(76,42,2)
(35,41,2)
(42,20,2)
(66,30,2)
(30,30,2)
(72,20,2)
(62,72,2)
(72,41,2)
(40,41,2)
(56,4,2)
(46,41,2)
(9,45,2)
(71,30,2)
(16,1,2)
(39,4,2)
(35,4,2)
(76,72,2)
(6,41,2)
(75,20,2)
(23,41,2)
(70,72,2)
(50,41,2)
(9,39,2)
(44,30,2)
(24,27,2)
(69,41,2)
(3,0,2)
(42,72,2)
(13,30,2)
(44,12,2)
(26,30,2)
(55,39,2)
(72,72,2)
(73,72,2)
-----------------------------------
(0,sizeof(int)
(1,* dataPtr = (int *)
(2,buffer)
(3,10 * sizeof(int)
(4,* buffer = (int *)
(5,1)
(6,data)
(7,RET)
(8,)
(9,exit(-1)
(10,data = (*dataPtr)
(11,int)
(12,i = 0)
(13,i++)
(14,data)
(15,)
(16,*dataPtr)
(17,for(i = 0; i < 10; i++)
(18,data)
(19,i)
(20,i = 0)
(21,10)
(22,(int *)
(23,0)
(24,(int *)
(25,)
(26,0)
(27,void * dataVoidPtr)
(28,dataPtr)
(29,dataPtr)
(30,i < 10)
(31,)
(32,NULL)
(33,printLine("ERROR: Array index is negative.")
(34,int *)
(35,buffer[data])
(36,dataVoidPtr)
(37,i)
(38,)
(39,buffer == NULL)
(40,i)
(41,data >= 0)
(42,buffer[i])
(43,i)
(44,buffer[i])
(45,-1)
(46,buffer)
(47,if (data >= 0)
(48,buffer)
(49,int *)
(50,buffer[data] = 1)
(51,for (i = 0; i < 10; i++)
(52,)
(53,0)
(54,data)
(55,1)
(56,free(buffer)
(57,i)
(58,buffer)
(59,i)
(60,0)
(61,dataPtr)
(62,10)
(63,buffer)
(64,)
(65,malloc(10 * sizeof(int)
(66,i)
(67,if (buffer == NULL)
(68,buffer)
(69,"ERROR: Array index is negative.")
(70,i)
(71,i)
(72,i < 10)
(73,buffer)
(74,buffer[i] = 0)
(75,i++)
(76,printIntLine(buffer[i])
(77,10)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^