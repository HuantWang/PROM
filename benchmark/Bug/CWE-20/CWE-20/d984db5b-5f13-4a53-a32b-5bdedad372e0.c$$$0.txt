-----label-----
1
-----code-----
void CWE122_Heap_Based_Buffer_Overflow__c_CWE129_large_31_bad()
{
    int data;
    /* Initialize data */
    data = -1;
    /* POTENTIAL FLAW: Use an invalid index */
    data = 10;
    {
        int dataCopy = data;
        int data = dataCopy;
        {
            int i;
            int * buffer = (int *)malloc(10 * sizeof(int));
            if (buffer == NULL) {exit(-1);}
            /* initialize buffer */
            for (i = 0; i < 10; i++)
            {
                buffer[i] = 0;
            }
            /* POTENTIAL FLAW: Attempt to write to an index of the array that is above the upper bound
             * This code does check to see if the array index is negative */
            if (data >= 0)
            {
                buffer[data] = 1;
                /* Print the array values */
                for(i = 0; i < 10; i++)
                {
                    printIntLine(buffer[i]);
                }
            }
            else
            {
                printLine("ERROR: Array index is negative.");
            }
            free(buffer);
        }
    }
}
-----children-----
1,2
1,3
1,4
3,4
5,6
5,7
5,8
5,9
6,7
7,8
7,9
9,10
11,12
12,13
12,14
13,14
15,16
17,18
18,19
18,20
19,20
22,23
22,24
22,25
23,24
24,25
24,26
26,27
26,28
28,29
29,30
31,32
32,33
32,34
34,35
34,36
36,37
37,38
39,40
39,41
39,42
39,43
39,44
39,45
40,41
41,42
41,43
43,44
45,46
46,47
46,48
48,49
48,50
48,51
51,52
52,53
52,54
53,54
53,55
55,56
57,58
57,59
58,59
60,61
60,62
62,63
63,64
63,65
66,67
66,68
67,68
67,69
68,69
70,71
72,73
73,74
74,75
74,76
75,76
77,78
79,80
79,81
79,82
79,83
80,81
81,82
81,83
82,83
85,86
85,87
86,87
89,90
90,91
92,93
93,94
94,95
94,96
95,96
95,97
96,97
98,99
101,102
101,103
101,104
102,103
102,104
103,104
106,107
106,108
107,108
108,109
108,110
109,110
109,111
110,111
112,113
115,116
115,117
115,118
115,119
116,117
117,118
117,119
118,119
121,122
121,123
122,123
125,126
126,127
128,129
129,130
130,131
130,132
131,132
133,134
133,135
134,135
136,137
138,139
139,140
140,141
140,142
141,142
144,145
145,146
145,147
146,147
148,149
-----nextToken-----
2,4,8,10,14,16,20,21,25,27,30,33,35,38,42,44,47,49,50,54,56,59,61,64,65,69,71,76,78,83,84,87,88,91,97,99,100,104,105,111,113,114,119,120,123,124,127,132,135,137,142,143,147,149
-----computeFrom-----
12,13
12,14
18,19
18,20
60,61
60,62
67,68
67,69
81,82
81,83
85,86
85,87
94,95
94,96
102,103
102,104
108,109
108,110
117,118
117,119
121,122
121,123
-----guardedBy-----
104,113
-----guardedByNegation-----
-----lastLexicalUse-----
-----jump-----
-----attribute-----
FunctionDefinition;SimpleDeclSpecifier;FunctionDeclarator;Name;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;UnaryExpression;LiteralExpression;ExpressionStatement;BinaryExpression;IdExpression;Name;LiteralExpression;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Name;EqualsInitializer;IdExpression;Name;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Name;EqualsInitializer;IdExpression;Name;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Name;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Pointer;Name;EqualsInitializer;CastExpression;TypeId;SimpleDeclSpecifier;Declarator;Pointer;FunctionCallExpression;IdExpression;Name;BinaryExpression;LiteralExpression;TypeIdExpression;TypeId;SimpleDeclSpecifier;Declarator;IfStatement;BinaryExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;UnaryExpression;LiteralExpression;ForStatement;ExpressionStatement;BinaryExpression;IdExpression;Name;LiteralExpression;BinaryExpression;IdExpression;Name;LiteralExpression;UnaryExpression;IdExpression;Name;CompoundStatement;ExpressionStatement;BinaryExpression;ArraySubscriptExpression;IdExpression;Name;IdExpression;Name;LiteralExpression;IfStatement;BinaryExpression;IdExpression;Name;LiteralExpression;CompoundStatement;ExpressionStatement;BinaryExpression;ArraySubscriptExpression;IdExpression;Name;IdExpression;Name;LiteralExpression;ForStatement;ExpressionStatement;BinaryExpression;IdExpression;Name;LiteralExpression;BinaryExpression;IdExpression;Name;LiteralExpression;UnaryExpression;IdExpression;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;ArraySubscriptExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;
-----ast_node-----
void CWE122_Heap_Based_Buffer_Overflow__c_CWE129_large_31_bad(){    int data;    /* Initialize data */    data = -1;    /* POTENTIAL FLAW: Use an invalid index */    data = 10;    {        int dataCopy = data;        int data = dataCopy;        {            int i;            int * buffer = (int *)malloc(10 * sizeof(int));            if (buffer == NULL) {exit(-1);}            /* initialize buffer */            for (i = 0; i < 10; i++)            {                buffer[i] = 0;            }            /* POTENTIAL FLAW: Attempt to write to an index of the array that is above the upper bound             * This code does check to see if the array index is negative */            if (data >= 0)            {                buffer[data] = 1;                /* Print the array values */                for(i = 0; i < 10; i++)                {                    printIntLine(buffer[i]);                }            }            else            {                printLine("ERROR: Array index is negative.");            }            free(buffer);        }    }}
void
CWE122_Heap_Based_Buffer_Overflow__c_CWE129_large_31_bad()
CWE122_Heap_Based_Buffer_Overflow__c_CWE129_large_31_bad
{    int data;    /* Initialize data */    data = -1;    /* POTENTIAL FLAW: Use an invalid index */    data = 10;    {        int dataCopy = data;        int data = dataCopy;        {            int i;            int * buffer = (int *)malloc(10 * sizeof(int));            if (buffer == NULL) {exit(-1);}            /* initialize buffer */            for (i = 0; i < 10; i++)            {                buffer[i] = 0;            }            /* POTENTIAL FLAW: Attempt to write to an index of the array that is above the upper bound             * This code does check to see if the array index is negative */            if (data >= 0)            {                buffer[data] = 1;                /* Print the array values */                for(i = 0; i < 10; i++)                {                    printIntLine(buffer[i]);                }            }            else            {                printLine("ERROR: Array index is negative.");            }            free(buffer);        }    }}
int data;
int data;
int
data
data
data = -1;
data = -1
data
data
-1
1
data = 10;
data = 10
data
data
10
{        int dataCopy = data;        int data = dataCopy;        {            int i;            int * buffer = (int *)malloc(10 * sizeof(int));            if (buffer == NULL) {exit(-1);}            /* initialize buffer */            for (i = 0; i < 10; i++)            {                buffer[i] = 0;            }            /* POTENTIAL FLAW: Attempt to write to an index of the array that is above the upper bound             * This code does check to see if the array index is negative */            if (data >= 0)            {                buffer[data] = 1;                /* Print the array values */                for(i = 0; i < 10; i++)                {                    printIntLine(buffer[i]);                }            }            else            {                printLine("ERROR: Array index is negative.");            }            free(buffer);        }    }
int dataCopy = data;
int dataCopy = data;
int
dataCopy = data
dataCopy
= data
data
data
int data = dataCopy;
int data = dataCopy;
int
data = dataCopy
data
= dataCopy
dataCopy
dataCopy
{            int i;            int * buffer = (int *)malloc(10 * sizeof(int));            if (buffer == NULL) {exit(-1);}            /* initialize buffer */            for (i = 0; i < 10; i++)            {                buffer[i] = 0;            }            /* POTENTIAL FLAW: Attempt to write to an index of the array that is above the upper bound             * This code does check to see if the array index is negative */            if (data >= 0)            {                buffer[data] = 1;                /* Print the array values */                for(i = 0; i < 10; i++)                {                    printIntLine(buffer[i]);                }            }            else            {                printLine("ERROR: Array index is negative.");            }            free(buffer);        }
int i;
int i;
int
i
i
int * buffer = (int *)malloc(10 * sizeof(int));
int * buffer = (int *)malloc(10 * sizeof(int));
int
* buffer = (int *)malloc(10 * sizeof(int))
*
buffer
= (int *)malloc(10 * sizeof(int))
(int *)malloc(10 * sizeof(int))
int *
int
*
*
malloc(10 * sizeof(int))
malloc
malloc
10 * sizeof(int)
10
sizeof(int)
int
int

if (buffer == NULL) {exit(-1);}
buffer == NULL
buffer
buffer
NULL
NULL
{exit(-1);}
exit(-1);
exit(-1)
exit
exit
-1
1
for (i = 0; i < 10; i++)            {                buffer[i] = 0;            }
i = 0;
i = 0
i
i
0
i < 10
i
i
10
i++
i
i
{                buffer[i] = 0;            }
buffer[i] = 0;
buffer[i] = 0
buffer[i]
buffer
buffer
i
i
0
if (data >= 0)            {                buffer[data] = 1;                /* Print the array values */                for(i = 0; i < 10; i++)                {                    printIntLine(buffer[i]);                }            }            else            {                printLine("ERROR: Array index is negative.");            }
data >= 0
data
data
0
{                buffer[data] = 1;                /* Print the array values */                for(i = 0; i < 10; i++)                {                    printIntLine(buffer[i]);                }            }
buffer[data] = 1;
buffer[data] = 1
buffer[data]
buffer
buffer
data
data
1
for(i = 0; i < 10; i++)                {                    printIntLine(buffer[i]);                }
i = 0;
i = 0
i
i
0
i < 10
i
i
10
i++
i
i
{                    printIntLine(buffer[i]);                }
printIntLine(buffer[i]);
printIntLine(buffer[i])
printIntLine
printIntLine
buffer[i]
buffer
buffer
i
i
{                printLine("ERROR: Array index is negative.");            }
printLine("ERROR: Array index is negative.");
printLine("ERROR: Array index is negative.")
printLine
printLine
"ERROR: Array index is negative."
free(buffer);
free(buffer)
free
free
buffer
buffer
-----joern-----
(76,13,0)
(79,5,0)
(64,54,0)
(32,27,0)
(61,16,0)
(3,47,0)
(1,68,0)
(44,52,0)
(18,74,0)
(4,41,0)
(12,41,0)
(29,39,0)
(14,10,0)
(62,11,0)
(70,52,0)
(65,73,0)
(8,80,0)
(31,68,0)
(14,17,0)
(53,65,0)
(11,17,0)
(47,3,0)
(28,18,0)
(5,30,0)
(11,10,0)
(41,9,0)
(16,12,0)
(16,17,0)
(12,16,0)
(20,80,0)
(24,34,0)
(13,36,0)
(25,46,0)
(11,6,0)
(45,30,0)
(38,13,0)
(16,61,0)
(77,9,0)
(2,44,0)
(37,48,0)
(73,65,0)
(81,17,0)
(42,44,0)
(6,11,0)
(78,34,0)
(71,20,0)
(26,38,0)
(43,48,0)
(54,17,0)
(21,38,0)
(63,11,0)
(51,44,0)
(11,34,0)
(41,12,0)
(35,27,0)
(50,44,0)
(39,30,0)
(81,20,0)
(14,30,0)
(54,44,0)
(81,48,0)
(56,39,0)
(9,41,0)
(38,52,0)
(75,10,0)
(57,81,0)
(48,52,0)
(22,46,0)
(73,36,0)
(0,58,0)
(17,44,0)
(33,44,0)
(23,14,0)
(6,67,0)
(3,82,0)
(27,48,0)
(17,16,0)
(66,73,0)
(72,13,0)
(40,36,0)
(55,52,0)
(15,30,0)
(7,17,0)
(52,36,0)
(46,34,0)
(68,17,0)
(48,38,0)
(69,81,0)
(10,19,0)
(58,34,0)
(59,14,0)
(49,47,0)
(5,79,1)
(54,64,1)
(68,17,1)
(24,78,1)
(32,35,1)
(15,45,1)
(9,77,1)
(69,27,1)
(5,30,1)
(27,48,1)
(78,20,1)
(45,68,1)
(26,13,1)
(11,62,1)
(49,68,1)
(58,34,1)
(16,61,1)
(64,46,1)
(68,1,1)
(73,65,1)
(46,34,1)
(75,14,1)
(28,27,1)
(62,63,1)
(57,69,1)
(58,0,1)
(14,59,1)
(3,47,1)
(37,38,1)
(53,66,1)
(63,46,1)
(39,30,1)
(59,23,1)
(7,48,1)
(72,73,1)
(60,54,1)
(23,39,1)
(41,9,1)
(20,71,1)
(21,26,1)
(22,34,1)
(79,10,1)
(18,28,1)
(39,29,1)
(81,48,1)
(45,3,1)
(17,16,1)
(14,17,1)
(81,17,1)
(76,72,1)
(6,11,1)
(22,58,1)
(46,25,1)
(31,17,1)
(81,57,1)
(12,41,1)
(27,32,1)
(64,18,1)
(43,37,1)
(25,22,1)
(11,17,1)
(71,81,1)
(0,6,1)
(29,56,1)
(54,17,1)
(38,21,1)
(77,4,1)
(4,7,1)
(56,30,1)
(11,34,1)
(11,10,1)
(30,15,1)
(14,30,1)
(35,39,1)
(10,75,1)
(47,49,1)
(34,24,1)
(16,12,1)
(56,5,1)
(48,38,1)
(48,43,1)
(1,31,1)
(65,53,1)
(13,76,1)
(38,13,1)
(69,27,2)
(56,39,2)
(24,27,2)
(22,27,2)
(18,27,2)
(11,17,2)
(62,46,2)
(79,39,2)
(23,39,2)
(10,39,2)
(81,17,2)
(25,46,2)
(17,16,2)
(11,46,2)
(16,61,2)
(68,17,2)
(29,39,2)
(58,34,2)
(38,13,2)
(46,27,2)
(0,46,2)
(16,12,2)
(11,10,2)
(75,39,2)
(3,47,2)
(48,38,2)
(39,39,2)
(27,48,2)
(71,27,2)
(5,39,2)
(25,27,2)
(54,17,2)
(14,39,2)
(46,34,2)
(11,34,2)
(49,68,2)
(5,30,2)
(47,68,2)
(6,11,2)
(34,27,2)
(12,41,2)
(39,30,2)
(14,30,2)
(57,27,2)
(73,65,2)
(22,46,2)
(46,46,2)
(20,27,2)
(63,46,2)
(81,27,2)
(58,46,2)
(59,39,2)
(28,27,2)
(14,17,2)
(3,68,2)
(78,27,2)
(41,9,2)
(6,46,2)
(81,48,2)
-----------------------------------
(0,i)
(1,NULL)
(2,if (buffer == NULL)
(3,exit(-1)
(4,10)
(5,i++)
(6,printIntLine(buffer[i])
(7,buffer)
(8,for(i = 0; i < 10; i++)
(9,sizeof(int)
(10,buffer[i] = 0)
(11,buffer[i])
(12,malloc(10 * sizeof(int)
(13,data = 10)
(14,buffer[i])
(15,0)
(16,(int *)
(17,* buffer = (int *)
(18,printLine("ERROR: Array index is negative.")
(19,)
(20,buffer[data] = 1)
(21,data)
(22,i)
(23,buffer)
(24,0)
(25,10)
(26,dataCopy)
(27,data >= 0)
(28,"ERROR: Array index is negative.")
(29,10)
(30,i = 0)
(31,buffer)
(32,0)
(33,if (data >= 0)
(34,i = 0)
(35,data)
(36,)
(37,data)
(38,dataCopy = data)
(39,i < 10)
(40,data)
(41,10 * sizeof(int)
(42,buffer)
(43,dataCopy)
(44,)
(45,i)
(46,i < 10)
(47,-1)
(48,data = dataCopy)
(49,1)
(50,i)
(51,for (i = 0; i < 10; i++)
(52,)
(53,1)
(54,free(buffer)
(55,dataCopy)
(56,i)
(57,data)
(58,i++)
(59,i)
(60,RET)
(61,int *)
(62,i)
(63,buffer)
(64,buffer)
(65,-1)
(66,data)
(67,)
(68,buffer == NULL)
(69,buffer)
(70,data)
(71,1)
(72,data)
(73,data = -1)
(74,)
(75,0)
(76,10)
(77,int)
(78,i)
(79,i)
(80,)
(81,buffer[data])
(82,)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^