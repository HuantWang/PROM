-----label-----
1
-----code-----
void CWE256_Plaintext_Storage_of_Password__w32_char_15_bad()
{
    char * data;
    char dataBuffer[100] = "";
    data = dataBuffer;
    switch(6)
    {
    case 6:
    {
        FILE *pFile;
        pFile = fopen("passwords.txt", "r");
        if (pFile != NULL)
        {
            /* POTENTIAL FLAW: Read the password from a file */
            if (fgets(data, 100, pFile) == NULL)
            {
                data[0] = '\0';
            }
            fclose(pFile);
        }
        else
        {
            data[0] = '\0';
        }
    }
    break;
    default:
        /* INCIDENTAL: CWE 561 Dead Code, the code below will never run */
        printLine("Benign, fixed string");
        break;
    }
    switch(7)
    {
    case 7:
    {
        HANDLE pHandle;
        char * username = "User";
        char * domain = "Domain";
        /* POTENTIAL FLAW: Attempt to login user with password from the source */
        if (LogonUserA(
                    username,
                    domain,
                    data,
                    LOGON32_LOGON_NETWORK,
                    LOGON32_PROVIDER_DEFAULT,
                    &pHandle) != 0)
        {
            printLine("User logged in successfully.");
            CloseHandle(pHandle);
        }
        else
        {
            printLine("Unable to login.");
        }
    }
    break;
    default:
        /* INCIDENTAL: CWE 561 Dead Code, the code below will never run */
        printLine("Benign, fixed string");
        break;
    }
}
-----children-----
1,2
1,3
1,4
3,4
5,6
5,7
5,8
5,9
5,10
6,7
7,8
7,9
9,10
9,11
12,13
13,14
13,15
15,16
15,17
15,18
17,18
19,20
21,22
22,23
22,24
23,24
25,26
27,28
27,29
29,30
29,31
29,32
29,33
29,34
29,35
30,31
32,33
32,34
32,35
33,34
34,35
34,36
35,36
37,38
37,39
40,41
41,42
41,43
42,43
44,45
44,46
44,47
45,46
49,50
49,51
49,52
50,51
50,52
51,52
53,54
55,56
55,57
56,57
56,58
57,58
57,59
58,59
58,60
58,61
58,62
59,60
61,62
64,65
66,67
68,69
69,70
70,71
70,72
71,72
71,73
72,73
76,77
77,78
77,79
78,79
80,81
82,83
83,84
84,85
84,86
85,86
85,87
86,87
92,93
93,94
93,95
94,95
98,99
98,100
100,101
100,102
100,103
100,104
100,105
100,106
101,102
103,104
103,105
103,106
103,107
104,105
105,106
105,107
106,107
108,109
110,111
111,112
111,113
113,114
113,115
113,116
116,117
118,119
119,120
119,121
121,122
121,123
121,124
124,125
126,127
126,128
126,129
127,128
127,129
128,129
128,130
128,131
128,132
128,133
128,134
128,135
129,130
131,132
133,134
135,136
137,138
139,140
141,142
142,143
145,146
145,147
146,147
147,148
147,149
148,149
151,152
152,153
152,154
153,154
155,156
157,158
158,159
159,160
159,161
160,161
165,166
166,167
166,168
167,168
-----nextToken-----
2,4,8,10,11,14,16,18,20,24,26,28,31,36,38,39,43,46,47,48,52,54,60,62,63,65,67,73,74,75,79,81,87,88,89,90,91,95,96,97,99,102,107,109,112,114,115,117,120,122,123,125,130,132,134,136,138,140,143,144,149,150,154,156,161,162,163,164,168,169,170
-----computeFrom-----
22,23
22,24
41,42
41,43
50,51
50,52
57,58
57,59
70,71
70,72
84,85
84,86
127,128
127,129
-----guardedBy-----
54,67
52,81
62,73
143,156
-----guardedByNegation-----
-----lastLexicalUse-----
-----jump-----
-----attribute-----
FunctionDefinition;SimpleDeclSpecifier;FunctionDeclarator;Name;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Pointer;Name;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;ArrayDeclarator;Name;ArrayModifier;LiteralExpression;EqualsInitializer;LiteralExpression;ExpressionStatement;BinaryExpression;IdExpression;Name;IdExpression;Name;SwitchStatement;LiteralExpression;CompoundStatement;CaseStatement;LiteralExpression;CompoundStatement;DeclarationStatement;SimpleDeclaration;NamedTypeSpecifier;Name;Declarator;Pointer;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;LiteralExpression;LiteralExpression;IfStatement;BinaryExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;IfStatement;BinaryExpression;FunctionCallExpression;IdExpression;Name;IdExpression;Name;LiteralExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;BinaryExpression;ArraySubscriptExpression;IdExpression;Name;LiteralExpression;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;BinaryExpression;ArraySubscriptExpression;IdExpression;Name;LiteralExpression;LiteralExpression;BreakStatement;DefaultStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;LiteralExpression;BreakStatement;SwitchStatement;LiteralExpression;CompoundStatement;CaseStatement;LiteralExpression;CompoundStatement;DeclarationStatement;SimpleDeclaration;NamedTypeSpecifier;Name;Declarator;Name;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Pointer;Name;EqualsInitializer;LiteralExpression;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Pointer;Name;EqualsInitializer;LiteralExpression;IfStatement;BinaryExpression;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;IdExpression;Name;IdExpression;Name;IdExpression;Name;UnaryExpression;IdExpression;Name;LiteralExpression;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;LiteralExpression;BreakStatement;DefaultStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;LiteralExpression;BreakStatement;
-----ast_node-----
void CWE256_Plaintext_Storage_of_Password__w32_char_15_bad(){    char * data;    char dataBuffer[100] = "";    data = dataBuffer;    switch(6)    {    case 6:    {        FILE *pFile;        pFile = fopen("passwords.txt", "r");        if (pFile != NULL)        {            /* POTENTIAL FLAW: Read the password from a file */            if (fgets(data, 100, pFile) == NULL)            {                data[0] = '\0';            }            fclose(pFile);        }        else        {            data[0] = '\0';        }    }    break;    default:        /* INCIDENTAL: CWE 561 Dead Code, the code below will never run */        printLine("Benign, fixed string");        break;    }    switch(7)    {    case 7:    {        HANDLE pHandle;        char * username = "User";        char * domain = "Domain";        /* POTENTIAL FLAW: Attempt to login user with password from the source */        if (LogonUserA(                    username,                    domain,                    data,                    LOGON32_LOGON_NETWORK,                    LOGON32_PROVIDER_DEFAULT,                    &pHandle) != 0)        {            printLine("User logged in successfully.");            CloseHandle(pHandle);        }        else        {            printLine("Unable to login.");        }    }    break;    default:        /* INCIDENTAL: CWE 561 Dead Code, the code below will never run */        printLine("Benign, fixed string");        break;    }}
void
CWE256_Plaintext_Storage_of_Password__w32_char_15_bad()
CWE256_Plaintext_Storage_of_Password__w32_char_15_bad
{    char * data;    char dataBuffer[100] = "";    data = dataBuffer;    switch(6)    {    case 6:    {        FILE *pFile;        pFile = fopen("passwords.txt", "r");        if (pFile != NULL)        {            /* POTENTIAL FLAW: Read the password from a file */            if (fgets(data, 100, pFile) == NULL)            {                data[0] = '\0';            }            fclose(pFile);        }        else        {            data[0] = '\0';        }    }    break;    default:        /* INCIDENTAL: CWE 561 Dead Code, the code below will never run */        printLine("Benign, fixed string");        break;    }    switch(7)    {    case 7:    {        HANDLE pHandle;        char * username = "User";        char * domain = "Domain";        /* POTENTIAL FLAW: Attempt to login user with password from the source */        if (LogonUserA(                    username,                    domain,                    data,                    LOGON32_LOGON_NETWORK,                    LOGON32_PROVIDER_DEFAULT,                    &pHandle) != 0)        {            printLine("User logged in successfully.");            CloseHandle(pHandle);        }        else        {            printLine("Unable to login.");        }    }    break;    default:        /* INCIDENTAL: CWE 561 Dead Code, the code below will never run */        printLine("Benign, fixed string");        break;    }}
char * data;
char * data;
char
* data
*
data
char dataBuffer[100] = "";
char dataBuffer[100] = "";
char
dataBuffer[100] = ""
dataBuffer
[100]
100
= ""
""
data = dataBuffer;
data = dataBuffer
data
data
dataBuffer
dataBuffer
switch(6)    {    case 6:    {        FILE *pFile;        pFile = fopen("passwords.txt", "r");        if (pFile != NULL)        {            /* POTENTIAL FLAW: Read the password from a file */            if (fgets(data, 100, pFile) == NULL)            {                data[0] = '\0';            }            fclose(pFile);        }        else        {            data[0] = '\0';        }    }    break;    default:        /* INCIDENTAL: CWE 561 Dead Code, the code below will never run */        printLine("Benign, fixed string");        break;    }
6
{    case 6:    {        FILE *pFile;        pFile = fopen("passwords.txt", "r");        if (pFile != NULL)        {            /* POTENTIAL FLAW: Read the password from a file */            if (fgets(data, 100, pFile) == NULL)            {                data[0] = '\0';            }            fclose(pFile);        }        else        {            data[0] = '\0';        }    }    break;    default:        /* INCIDENTAL: CWE 561 Dead Code, the code below will never run */        printLine("Benign, fixed string");        break;    }
case 6:
6
{        FILE *pFile;        pFile = fopen("passwords.txt", "r");        if (pFile != NULL)        {            /* POTENTIAL FLAW: Read the password from a file */            if (fgets(data, 100, pFile) == NULL)            {                data[0] = '\0';            }            fclose(pFile);        }        else        {            data[0] = '\0';        }    }
FILE *pFile;
FILE *pFile;
FILE
FILE
*pFile
*
pFile
pFile = fopen("passwords.txt", "r");
pFile = fopen("passwords.txt", "r")
pFile
pFile
fopen("passwords.txt", "r")
fopen
fopen
"passwords.txt"
"r"
if (pFile != NULL)        {            /* POTENTIAL FLAW: Read the password from a file */            if (fgets(data, 100, pFile) == NULL)            {                data[0] = '\0';            }            fclose(pFile);        }        else        {            data[0] = '\0';        }
pFile != NULL
pFile
pFile
NULL
NULL
{            /* POTENTIAL FLAW: Read the password from a file */            if (fgets(data, 100, pFile) == NULL)            {                data[0] = '\0';            }            fclose(pFile);        }
if (fgets(data, 100, pFile) == NULL)            {                data[0] = '\0';            }
fgets(data, 100, pFile) == NULL
fgets(data, 100, pFile)
fgets
fgets
data
data
100
pFile
pFile
NULL
NULL
{                data[0] = '\0';            }
data[0] = '\0';
data[0] = '\0'
data[0]
data
data
0
'\0'
fclose(pFile);
fclose(pFile)
fclose
fclose
pFile
pFile
{            data[0] = '\0';        }
data[0] = '\0';
data[0] = '\0'
data[0]
data
data
0
'\0'
break;
default:
printLine("Benign, fixed string");
printLine("Benign, fixed string")
printLine
printLine
"Benign, fixed string"
break;
switch(7)    {    case 7:    {        HANDLE pHandle;        char * username = "User";        char * domain = "Domain";        /* POTENTIAL FLAW: Attempt to login user with password from the source */        if (LogonUserA(                    username,                    domain,                    data,                    LOGON32_LOGON_NETWORK,                    LOGON32_PROVIDER_DEFAULT,                    &pHandle) != 0)        {            printLine("User logged in successfully.");            CloseHandle(pHandle);        }        else        {            printLine("Unable to login.");        }    }    break;    default:        /* INCIDENTAL: CWE 561 Dead Code, the code below will never run */        printLine("Benign, fixed string");        break;    }
7
{    case 7:    {        HANDLE pHandle;        char * username = "User";        char * domain = "Domain";        /* POTENTIAL FLAW: Attempt to login user with password from the source */        if (LogonUserA(                    username,                    domain,                    data,                    LOGON32_LOGON_NETWORK,                    LOGON32_PROVIDER_DEFAULT,                    &pHandle) != 0)        {            printLine("User logged in successfully.");            CloseHandle(pHandle);        }        else        {            printLine("Unable to login.");        }    }    break;    default:        /* INCIDENTAL: CWE 561 Dead Code, the code below will never run */        printLine("Benign, fixed string");        break;    }
case 7:
7
{        HANDLE pHandle;        char * username = "User";        char * domain = "Domain";        /* POTENTIAL FLAW: Attempt to login user with password from the source */        if (LogonUserA(                    username,                    domain,                    data,                    LOGON32_LOGON_NETWORK,                    LOGON32_PROVIDER_DEFAULT,                    &pHandle) != 0)        {            printLine("User logged in successfully.");            CloseHandle(pHandle);        }        else        {            printLine("Unable to login.");        }    }
HANDLE pHandle;
HANDLE pHandle;
HANDLE
HANDLE
pHandle
pHandle
char * username = "User";
char * username = "User";
char
* username = "User"
*
username
= "User"
"User"
char * domain = "Domain";
char * domain = "Domain";
char
* domain = "Domain"
*
domain
= "Domain"
"Domain"
if (LogonUserA(                    username,                    domain,                    data,                    LOGON32_LOGON_NETWORK,                    LOGON32_PROVIDER_DEFAULT,                    &pHandle) != 0)        {            printLine("User logged in successfully.");            CloseHandle(pHandle);        }        else        {            printLine("Unable to login.");        }
LogonUserA(                    username,                    domain,                    data,                    LOGON32_LOGON_NETWORK,                    LOGON32_PROVIDER_DEFAULT,                    &pHandle) != 0
LogonUserA(                    username,                    domain,                    data,                    LOGON32_LOGON_NETWORK,                    LOGON32_PROVIDER_DEFAULT,                    &pHandle)
LogonUserA
LogonUserA
username
username
domain
domain
data
data
LOGON32_LOGON_NETWORK
LOGON32_LOGON_NETWORK
LOGON32_PROVIDER_DEFAULT
LOGON32_PROVIDER_DEFAULT
&pHandle
pHandle
pHandle
0
{            printLine("User logged in successfully.");            CloseHandle(pHandle);        }
printLine("User logged in successfully.");
printLine("User logged in successfully.")
printLine
printLine
"User logged in successfully."
CloseHandle(pHandle);
CloseHandle(pHandle)
CloseHandle
CloseHandle
pHandle
pHandle
{            printLine("Unable to login.");        }
printLine("Unable to login.");
printLine("Unable to login.")
printLine
printLine
"Unable to login."
break;
default:
printLine("Benign, fixed string");
printLine("Benign, fixed string")
printLine
printLine
"Benign, fixed string"
break;
-----joern-----
(77,50,0)
(63,81,0)
(75,85,0)
(22,29,0)
(79,15,0)
(46,76,0)
(59,30,0)
(62,83,0)
(21,29,0)
(29,50,0)
(47,76,0)
(50,59,0)
(52,29,0)
(12,23,0)
(45,59,0)
(33,84,0)
(11,76,0)
(82,70,0)
(44,74,0)
(76,11,0)
(29,23,0)
(27,47,0)
(9,74,0)
(78,72,0)
(56,3,0)
(25,76,0)
(65,34,0)
(64,4,0)
(3,39,0)
(40,30,0)
(23,4,0)
(71,4,0)
(6,30,0)
(42,25,0)
(39,32,0)
(80,81,0)
(13,74,0)
(67,55,0)
(87,74,0)
(18,55,0)
(2,53,0)
(8,63,0)
(29,85,0)
(48,50,0)
(23,74,0)
(73,59,0)
(69,47,0)
(31,29,0)
(28,6,0)
(20,23,0)
(16,29,0)
(49,70,0)
(15,33,0)
(41,58,0)
(17,11,0)
(3,23,0)
(47,23,0)
(14,11,0)
(34,70,0)
(66,33,0)
(4,74,0)
(89,30,0)
(0,53,0)
(26,34,0)
(61,70,0)
(37,54,0)
(57,30,0)
(47,72,0)
(1,15,0)
(68,70,0)
(43,62,0)
(36,49,0)
(7,80,0)
(72,47,0)
(29,55,0)
(86,39,0)
(88,59,0)
(24,3,0)
(25,54,0)
(55,59,0)
(85,29,0)
(29,58,0)
(53,76,0)
(58,29,0)
(60,70,0)
(38,30,0)
(15,23,0)
(10,47,0)
(35,59,0)
(76,34,0)
(0,2,1)
(23,20,1)
(12,4,1)
(72,78,1)
(42,39,1)
(3,23,1)
(18,67,1)
(55,18,1)
(22,55,1)
(63,8,1)
(31,16,1)
(64,71,1)
(76,11,1)
(7,63,1)
(80,7,1)
(50,48,1)
(85,75,1)
(66,15,1)
(21,52,1)
(57,62,1)
(15,1,1)
(29,58,1)
(42,72,1)
(2,76,1)
(8,85,1)
(48,77,1)
(15,23,1)
(6,28,1)
(24,72,1)
(67,50,1)
(60,33,1)
(51,60,1)
(39,86,1)
(85,29,1)
(46,5,1)
(79,53,1)
(29,55,1)
(1,79,1)
(16,21,1)
(62,43,1)
(49,36,1)
(23,4,1)
(72,47,1)
(41,31,1)
(25,42,1)
(27,10,1)
(17,14,1)
(86,3,1)
(69,53,1)
(78,47,1)
(47,27,1)
(11,17,1)
(10,69,1)
(57,80,1)
(20,12,1)
(82,49,1)
(75,29,1)
(29,50,1)
(25,76,1)
(5,23,1)
(56,24,1)
(29,23,1)
(33,66,1)
(14,46,1)
(47,76,1)
(51,82,1)
(28,51,1)
(43,85,1)
(4,64,1)
(77,51,1)
(36,5,1)
(60,25,1)
(52,22,1)
(3,56,1)
(19,38,1)
(58,41,1)
(19,57,1)
(53,0,1)
(53,76,1)
(38,6,1)
(47,23,1)
(28,51,2)
(48,51,2)
(25,76,2)
(0,5,2)
(55,51,2)
(62,85,2)
(86,72,2)
(58,51,2)
(53,76,2)
(72,53,2)
(76,11,2)
(29,23,2)
(85,51,2)
(8,85,2)
(42,53,2)
(52,51,2)
(3,72,2)
(25,53,2)
(17,5,2)
(53,5,2)
(78,53,2)
(76,5,2)
(41,51,2)
(15,23,2)
(31,51,2)
(10,53,2)
(24,72,2)
(69,53,2)
(7,85,2)
(49,5,2)
(29,50,2)
(82,5,2)
(39,72,2)
(3,23,2)
(14,5,2)
(16,51,2)
(23,4,2)
(29,58,2)
(29,51,2)
(27,53,2)
(60,5,2)
(18,51,2)
(50,51,2)
(57,51,2)
(47,53,2)
(56,72,2)
(80,85,2)
(72,47,2)
(15,53,2)
(2,5,2)
(11,5,2)
(47,23,2)
(1,53,2)
(66,53,2)
(77,51,2)
(85,29,2)
(33,53,2)
(43,85,2)
(63,85,2)
(67,51,2)
(75,51,2)
(46,5,2)
(22,51,2)
(38,51,2)
(21,51,2)
(79,53,2)
(6,51,2)
(29,55,2)
(36,5,2)
(47,76,2)
-----------------------------------
(0,NULL)
(1,0)
(2,pFile)
(3,data[0])
(4,dataBuffer[100] = "")
(5,6)
(6,printLine("Benign, fixed string")
(7,pHandle)
(8,"User logged in successfully.")
(9,switch(6)
(10,100)
(11,fopen("passwords.txt", "r")
(12,data)
(13,switch(7)
(14,"passwords.txt")
(15,data[0])
(16,LOGON32_LOGON_NETWORK)
(17,"r")
(18,"Domain")
(19,RET)
(20,dataBuffer)
(21,data)
(22,username)
(23,data = dataBuffer)
(24,data)
(25,fclose(pFile)
(26,if (pFile != NULL)
(27,pFile)
(28,"Benign, fixed string")
(29,LogonUserA(\\\\n                    username,\\\\n                    domain,\\\\n                    data,\\\\n                    LOGON32_LOGON_NETWORK,\\\\n                    LOGON32_PROVIDER_DEFAULT,\\\\n                    &pHandle)
(30,)
(31,LOGON32_PROVIDER_DEFAULT)
(32,)
(33,data[0] = \\\'\\\\0\\\')
(34,)
(35,domain)
(36,"Benign, fixed string")
(37,if (fgets(data, 100, pFile)
(38,break;)
(39,data[0] = \\\'\\\\0\\\')
(40,default:)
(41,pHandle)
(42,pFile)
(43,"Unable to login.")
(44,data)
(45,if (LogonUserA(\\\\n                    username,\\\\n                    domain,\\\\n                    data,\\\\n                    LOGON32_LOGON_NETWORK,\\\\n                    LOGON32_PROVIDER_DEFAULT,\\\\n                    &pHandle)
(46,pFile)
(47,fgets(data, 100, pFile)
(48,"User")
(49,printLine("Benign, fixed string")
(50,* username = "User")
(51,7)
(52,domain)
(53,pFile != NULL)
(54,)
(55,* domain = "Domain")
(56,0)
(57,break;)
(58,&pHandle)
(59,)
(60,break;)
(61,case 6:)
(62,printLine("Unable to login.")
(63,printLine("User logged in successfully.")
(64,"")
(65,pFile)
(66,\\\'\\\\0\\\')
(67,domain)
(68,default:)
(69,data)
(70,)
(71,dataBuffer)
(72,fgets(data, 100, pFile)
(73,pHandle)
(74,)
(75,0)
(76,pFile = fopen("passwords.txt", "r")
(77,username)
(78,NULL)
(79,data)
(80,CloseHandle(pHandle)
(81,)
(82,break;)
(83,)
(84,)
(85,LogonUserA(\\\\n                    username,\\\\n                    domain,\\\\n                    data,\\\\n                    LOGON32_LOGON_NETWORK,\\\\n                    LOGON32_PROVIDER_DEFAULT,\\\\n                    &pHandle)
(86,\\\'\\\\0\\\')
(87,dataBuffer)
(88,username)
(89,case 7:)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
