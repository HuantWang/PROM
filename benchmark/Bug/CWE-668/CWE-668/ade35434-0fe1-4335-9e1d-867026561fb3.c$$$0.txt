-----label-----
1
-----code-----
void CWE226_Sensitive_Information_Uncleared_Before_Release__w32_wchar_t_alloca_12_bad()
{
    if(globalReturnsTrueOrFalse())
    {
        {
            wchar_t * password = (wchar_t *)ALLOCA(100*sizeof(wchar_t));
            size_t passwordLen = 0;
            HANDLE hUser;
            wchar_t * username = L"User";
            wchar_t * domain = L"Domain";
            /* Initialize password */
            password[0] = L'\0';
            if (fgetws(password, 100, stdin) == NULL)
            {
                printLine("fgetws() failed");
                /* Restore NUL terminator if fgetws fails */
                password[0] = L'\0';
            }
            /* Remove the carriage return from the string that is inserted by fgetws() */
            passwordLen = wcslen(password);
            if (passwordLen > 0)
            {
                password[passwordLen-1] = L'\0';
            }
            /* Use the password in LogonUser() to establish that it is "sensitive" */
            if (LogonUserW(
                        username,
                        domain,
                        password,
                        LOGON32_LOGON_NETWORK,
                        LOGON32_PROVIDER_DEFAULT,
                        &hUser) != 0)
            {
                printLine("User logged in successfully.");
                CloseHandle(hUser);
            }
            else
            {
                printLine("Unable to login.");
            }
            /* FLAW: Release password from the stack without first clearing the buffer */
        }
    }
    else
    {
        {
            wchar_t * password = (wchar_t *)ALLOCA(100*sizeof(wchar_t));
            size_t passwordLen = 0;
            HANDLE hUser;
            wchar_t * username = L"User";
            wchar_t * domain = L"Domain";
            /* Initialize password */
            password[0] = L'\0';
            if (fgetws(password, 100, stdin) == NULL)
            {
                printLine("fgetws() failed");
                /* Restore NUL terminator if fgetws fails */
                password[0] = L'\0';
            }
            /* Remove the carriage return from the string that is inserted by fgetws() */
            passwordLen = wcslen(password);
            if (passwordLen > 0)
            {
                password[passwordLen-1] = L'\0';
            }
            /* Use the password in LogonUser() to establish that it is "sensitive" */
            if (LogonUserW(
                        username,
                        domain,
                        password,
                        LOGON32_LOGON_NETWORK,
                        LOGON32_PROVIDER_DEFAULT,
                        &hUser) != 0)
            {
                printLine("User logged in successfully.");
                CloseHandle(hUser);
            }
            else
            {
                printLine("Unable to login.");
            }
            passwordLen = wcslen(password);
            /* FIX: Clear password prior to release from stack */
            SecureZeroMemory(password, passwordLen * sizeof(wchar_t));
        }
    }
}
-----children-----
1,2
1,3
1,4
3,4
5,6
6,7
6,8
6,9
7,8
8,9
10,11
11,12
11,13
11,14
11,15
11,16
11,17
11,18
11,19
11,20
11,21
12,13
13,14
13,15
15,16
15,17
15,18
18,19
19,20
19,21
20,21
20,22
22,23
24,25
24,26
25,26
27,28
27,29
29,30
30,31
30,32
33,34
34,35
34,36
35,36
37,38
37,39
39,40
41,42
42,43
42,44
43,44
45,46
47,48
48,49
48,50
50,51
50,52
50,53
53,54
55,56
56,57
56,58
58,59
58,60
58,61
61,62
63,64
64,65
64,66
65,66
65,67
66,67
70,71
70,72
71,72
71,73
72,73
72,74
72,75
72,76
73,74
75,76
78,79
80,81
82,83
82,84
83,84
84,85
84,86
85,86
88,89
89,90
89,91
90,91
90,92
91,92
95,96
96,97
96,98
97,98
99,100
99,101
100,101
102,103
104,105
104,106
105,106
105,107
106,107
109,110
110,111
111,112
111,113
112,113
112,114
113,114
115,116
115,117
116,117
120,121
120,122
120,123
121,122
121,123
122,123
122,124
122,125
122,126
122,127
122,128
122,129
123,124
125,126
127,128
129,130
131,132
133,134
135,136
136,137
139,140
139,141
140,141
141,142
141,143
142,143
145,146
146,147
146,148
147,148
149,150
151,152
152,153
153,154
153,155
154,155
157,158
158,159
158,160
158,161
158,162
158,163
158,164
158,165
158,166
158,167
158,168
158,169
158,170
159,160
160,161
160,162
162,163
162,164
162,165
165,166
166,167
166,168
167,168
167,169
169,170
171,172
171,173
172,173
174,175
174,176
176,177
177,178
177,179
180,181
181,182
181,183
182,183
184,185
184,186
186,187
188,189
189,190
189,191
190,191
192,193
194,195
195,196
195,197
197,198
197,199
197,200
200,201
202,203
203,204
203,205
205,206
205,207
205,208
208,209
210,211
211,212
211,213
212,213
212,214
213,214
217,218
217,219
218,219
218,220
219,220
219,221
219,222
219,223
220,221
222,223
225,226
227,228
229,230
229,231
230,231
231,232
231,233
232,233
235,236
236,237
236,238
237,238
237,239
238,239
242,243
243,244
243,245
244,245
246,247
246,248
247,248
249,250
251,252
251,253
252,253
252,254
253,254
256,257
257,258
258,259
258,260
259,260
259,261
260,261
262,263
262,264
263,264
267,268
267,269
267,270
268,269
268,270
269,270
269,271
269,272
269,273
269,274
269,275
269,276
270,271
272,273
274,275
276,277
278,279
280,281
282,283
283,284
286,287
286,288
287,288
288,289
288,290
289,290
292,293
293,294
293,295
294,295
296,297
298,299
299,300
300,301
300,302
301,302
304,305
305,306
305,307
306,307
308,309
308,310
309,310
311,312
313,314
314,315
314,316
314,317
315,316
317,318
319,320
319,321
320,321
322,323
323,324
323,325
-----nextToken-----
2,4,9,14,16,17,21,23,26,28,31,32,36,38,40,44,46,49,51,52,54,57,59,60,62,67,68,69,74,76,77,79,81,86,87,92,93,94,98,101,103,107,108,114,117,118,119,124,126,128,130,132,134,137,138,143,144,148,150,155,156,161,163,164,168,170,173,175,178,179,183,185,187,191,193,196,198,199,201,204,206,207,209,214,215,216,221,223,224,226,228,233,234,239,240,241,245,248,250,254,255,261,264,265,266,271,273,275,277,279,281,284,285,290,291,295,297,302,303,307,310,312,316,318,321,324,325
-----computeFrom-----
27,28
27,29
64,65
64,66
71,72
71,73
89,90
89,91
96,97
96,98
105,106
105,107
111,112
111,113
115,116
115,117
121,122
121,123
174,175
174,176
211,212
211,213
218,219
218,220
236,237
236,238
243,244
243,245
252,253
252,254
258,259
258,260
262,263
262,264
268,269
268,270
305,306
305,307
319,320
319,321
-----guardedBy-----
76,92
107,117
137,150
223,239
254,264
284,297
-----guardedByNegation-----
-----lastLexicalUse-----
-----jump-----
-----attribute-----
FunctionDefinition;SimpleDeclSpecifier;FunctionDeclarator;Name;CompoundStatement;IfStatement;FunctionCallExpression;IdExpression;Name;CompoundStatement;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Pointer;Name;EqualsInitializer;CastExpression;TypeId;SimpleDeclSpecifier;Declarator;Pointer;FunctionCallExpression;IdExpression;Name;BinaryExpression;LiteralExpression;TypeIdExpression;TypeId;SimpleDeclSpecifier;Declarator;DeclarationStatement;SimpleDeclaration;NamedTypeSpecifier;Name;Declarator;Name;EqualsInitializer;LiteralExpression;DeclarationStatement;SimpleDeclaration;NamedTypeSpecifier;Name;Declarator;Name;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Pointer;Name;EqualsInitializer;LiteralExpression;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Pointer;Name;EqualsInitializer;LiteralExpression;ExpressionStatement;BinaryExpression;ArraySubscriptExpression;IdExpression;Name;LiteralExpression;LiteralExpression;IfStatement;BinaryExpression;FunctionCallExpression;IdExpression;Name;IdExpression;Name;LiteralExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;LiteralExpression;ExpressionStatement;BinaryExpression;ArraySubscriptExpression;IdExpression;Name;LiteralExpression;LiteralExpression;ExpressionStatement;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IfStatement;BinaryExpression;IdExpression;Name;LiteralExpression;CompoundStatement;ExpressionStatement;BinaryExpression;ArraySubscriptExpression;IdExpression;Name;BinaryExpression;IdExpression;Name;LiteralExpression;LiteralExpression;IfStatement;BinaryExpression;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;IdExpression;Name;IdExpression;Name;IdExpression;Name;UnaryExpression;IdExpression;Name;LiteralExpression;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;LiteralExpression;CompoundStatement;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Pointer;Name;EqualsInitializer;CastExpression;TypeId;SimpleDeclSpecifier;Declarator;Pointer;FunctionCallExpression;IdExpression;Name;BinaryExpression;LiteralExpression;TypeIdExpression;TypeId;SimpleDeclSpecifier;Declarator;DeclarationStatement;SimpleDeclaration;NamedTypeSpecifier;Name;Declarator;Name;EqualsInitializer;LiteralExpression;DeclarationStatement;SimpleDeclaration;NamedTypeSpecifier;Name;Declarator;Name;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Pointer;Name;EqualsInitializer;LiteralExpression;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Pointer;Name;EqualsInitializer;LiteralExpression;ExpressionStatement;BinaryExpression;ArraySubscriptExpression;IdExpression;Name;LiteralExpression;LiteralExpression;IfStatement;BinaryExpression;FunctionCallExpression;IdExpression;Name;IdExpression;Name;LiteralExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;LiteralExpression;ExpressionStatement;BinaryExpression;ArraySubscriptExpression;IdExpression;Name;LiteralExpression;LiteralExpression;ExpressionStatement;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IfStatement;BinaryExpression;IdExpression;Name;LiteralExpression;CompoundStatement;ExpressionStatement;BinaryExpression;ArraySubscriptExpression;IdExpression;Name;BinaryExpression;IdExpression;Name;LiteralExpression;LiteralExpression;IfStatement;BinaryExpression;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;IdExpression;Name;IdExpression;Name;IdExpression;Name;UnaryExpression;IdExpression;Name;LiteralExpression;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;LiteralExpression;ExpressionStatement;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;BinaryExpression;IdExpression;Name;TypeIdExpression;TypeId;SimpleDeclSpecifier;Declarator;
-----ast_node-----
void CWE226_Sensitive_Information_Uncleared_Before_Release__w32_wchar_t_alloca_12_bad(){    if(globalReturnsTrueOrFalse())    {        {            wchar_t * password = (wchar_t *)ALLOCA(100*sizeof(wchar_t));            size_t passwordLen = 0;            HANDLE hUser;            wchar_t * username = L"User";            wchar_t * domain = L"Domain";            /* Initialize password */            password[0] = L'\0';            if (fgetws(password, 100, stdin) == NULL)            {                printLine("fgetws() failed");                /* Restore NUL terminator if fgetws fails */                password[0] = L'\0';            }            /* Remove the carriage return from the string that is inserted by fgetws() */            passwordLen = wcslen(password);            if (passwordLen > 0)            {                password[passwordLen-1] = L'\0';            }            /* Use the password in LogonUser() to establish that it is "sensitive" */            if (LogonUserW(                        username,                        domain,                        password,                        LOGON32_LOGON_NETWORK,                        LOGON32_PROVIDER_DEFAULT,                        &hUser) != 0)            {                printLine("User logged in successfully.");                CloseHandle(hUser);            }            else            {                printLine("Unable to login.");            }            /* FLAW: Release password from the stack without first clearing the buffer */        }    }    else    {        {            wchar_t * password = (wchar_t *)ALLOCA(100*sizeof(wchar_t));            size_t passwordLen = 0;            HANDLE hUser;            wchar_t * username = L"User";            wchar_t * domain = L"Domain";            /* Initialize password */            password[0] = L'\0';            if (fgetws(password, 100, stdin) == NULL)            {                printLine("fgetws() failed");                /* Restore NUL terminator if fgetws fails */                password[0] = L'\0';            }            /* Remove the carriage return from the string that is inserted by fgetws() */            passwordLen = wcslen(password);            if (passwordLen > 0)            {                password[passwordLen-1] = L'\0';            }            /* Use the password in LogonUser() to establish that it is "sensitive" */            if (LogonUserW(                        username,                        domain,                        password,                        LOGON32_LOGON_NETWORK,                        LOGON32_PROVIDER_DEFAULT,                        &hUser) != 0)            {                printLine("User logged in successfully.");                CloseHandle(hUser);            }            else            {                printLine("Unable to login.");            }            passwordLen = wcslen(password);            /* FIX: Clear password prior to release from stack */            SecureZeroMemory(password, passwordLen * sizeof(wchar_t));        }    }}
void
CWE226_Sensitive_Information_Uncleared_Before_Release__w32_wchar_t_alloca_12_bad()
CWE226_Sensitive_Information_Uncleared_Before_Release__w32_wchar_t_alloca_12_bad
{    if(globalReturnsTrueOrFalse())    {        {            wchar_t * password = (wchar_t *)ALLOCA(100*sizeof(wchar_t));            size_t passwordLen = 0;            HANDLE hUser;            wchar_t * username = L"User";            wchar_t * domain = L"Domain";            /* Initialize password */            password[0] = L'\0';            if (fgetws(password, 100, stdin) == NULL)            {                printLine("fgetws() failed");                /* Restore NUL terminator if fgetws fails */                password[0] = L'\0';            }            /* Remove the carriage return from the string that is inserted by fgetws() */            passwordLen = wcslen(password);            if (passwordLen > 0)            {                password[passwordLen-1] = L'\0';            }            /* Use the password in LogonUser() to establish that it is "sensitive" */            if (LogonUserW(                        username,                        domain,                        password,                        LOGON32_LOGON_NETWORK,                        LOGON32_PROVIDER_DEFAULT,                        &hUser) != 0)            {                printLine("User logged in successfully.");                CloseHandle(hUser);            }            else            {                printLine("Unable to login.");            }            /* FLAW: Release password from the stack without first clearing the buffer */        }    }    else    {        {            wchar_t * password = (wchar_t *)ALLOCA(100*sizeof(wchar_t));            size_t passwordLen = 0;            HANDLE hUser;            wchar_t * username = L"User";            wchar_t * domain = L"Domain";            /* Initialize password */            password[0] = L'\0';            if (fgetws(password, 100, stdin) == NULL)            {                printLine("fgetws() failed");                /* Restore NUL terminator if fgetws fails */                password[0] = L'\0';            }            /* Remove the carriage return from the string that is inserted by fgetws() */            passwordLen = wcslen(password);            if (passwordLen > 0)            {                password[passwordLen-1] = L'\0';            }            /* Use the password in LogonUser() to establish that it is "sensitive" */            if (LogonUserW(                        username,                        domain,                        password,                        LOGON32_LOGON_NETWORK,                        LOGON32_PROVIDER_DEFAULT,                        &hUser) != 0)            {                printLine("User logged in successfully.");                CloseHandle(hUser);            }            else            {                printLine("Unable to login.");            }            passwordLen = wcslen(password);            /* FIX: Clear password prior to release from stack */            SecureZeroMemory(password, passwordLen * sizeof(wchar_t));        }    }}
if(globalReturnsTrueOrFalse())    {        {            wchar_t * password = (wchar_t *)ALLOCA(100*sizeof(wchar_t));            size_t passwordLen = 0;            HANDLE hUser;            wchar_t * username = L"User";            wchar_t * domain = L"Domain";            /* Initialize password */            password[0] = L'\0';            if (fgetws(password, 100, stdin) == NULL)            {                printLine("fgetws() failed");                /* Restore NUL terminator if fgetws fails */                password[0] = L'\0';            }            /* Remove the carriage return from the string that is inserted by fgetws() */            passwordLen = wcslen(password);            if (passwordLen > 0)            {                password[passwordLen-1] = L'\0';            }            /* Use the password in LogonUser() to establish that it is "sensitive" */            if (LogonUserW(                        username,                        domain,                        password,                        LOGON32_LOGON_NETWORK,                        LOGON32_PROVIDER_DEFAULT,                        &hUser) != 0)            {                printLine("User logged in successfully.");                CloseHandle(hUser);            }            else            {                printLine("Unable to login.");            }            /* FLAW: Release password from the stack without first clearing the buffer */        }    }    else    {        {            wchar_t * password = (wchar_t *)ALLOCA(100*sizeof(wchar_t));            size_t passwordLen = 0;            HANDLE hUser;            wchar_t * username = L"User";            wchar_t * domain = L"Domain";            /* Initialize password */            password[0] = L'\0';            if (fgetws(password, 100, stdin) == NULL)            {                printLine("fgetws() failed");                /* Restore NUL terminator if fgetws fails */                password[0] = L'\0';            }            /* Remove the carriage return from the string that is inserted by fgetws() */            passwordLen = wcslen(password);            if (passwordLen > 0)            {                password[passwordLen-1] = L'\0';            }            /* Use the password in LogonUser() to establish that it is "sensitive" */            if (LogonUserW(                        username,                        domain,                        password,                        LOGON32_LOGON_NETWORK,                        LOGON32_PROVIDER_DEFAULT,                        &hUser) != 0)            {                printLine("User logged in successfully.");                CloseHandle(hUser);            }            else            {                printLine("Unable to login.");            }            passwordLen = wcslen(password);            /* FIX: Clear password prior to release from stack */            SecureZeroMemory(password, passwordLen * sizeof(wchar_t));        }    }
globalReturnsTrueOrFalse()
globalReturnsTrueOrFalse
globalReturnsTrueOrFalse
{        {            wchar_t * password = (wchar_t *)ALLOCA(100*sizeof(wchar_t));            size_t passwordLen = 0;            HANDLE hUser;            wchar_t * username = L"User";            wchar_t * domain = L"Domain";            /* Initialize password */            password[0] = L'\0';            if (fgetws(password, 100, stdin) == NULL)            {                printLine("fgetws() failed");                /* Restore NUL terminator if fgetws fails */                password[0] = L'\0';            }            /* Remove the carriage return from the string that is inserted by fgetws() */            passwordLen = wcslen(password);            if (passwordLen > 0)            {                password[passwordLen-1] = L'\0';            }            /* Use the password in LogonUser() to establish that it is "sensitive" */            if (LogonUserW(                        username,                        domain,                        password,                        LOGON32_LOGON_NETWORK,                        LOGON32_PROVIDER_DEFAULT,                        &hUser) != 0)            {                printLine("User logged in successfully.");                CloseHandle(hUser);            }            else            {                printLine("Unable to login.");            }            /* FLAW: Release password from the stack without first clearing the buffer */        }    }
{            wchar_t * password = (wchar_t *)ALLOCA(100*sizeof(wchar_t));            size_t passwordLen = 0;            HANDLE hUser;            wchar_t * username = L"User";            wchar_t * domain = L"Domain";            /* Initialize password */            password[0] = L'\0';            if (fgetws(password, 100, stdin) == NULL)            {                printLine("fgetws() failed");                /* Restore NUL terminator if fgetws fails */                password[0] = L'\0';            }            /* Remove the carriage return from the string that is inserted by fgetws() */            passwordLen = wcslen(password);            if (passwordLen > 0)            {                password[passwordLen-1] = L'\0';            }            /* Use the password in LogonUser() to establish that it is "sensitive" */            if (LogonUserW(                        username,                        domain,                        password,                        LOGON32_LOGON_NETWORK,                        LOGON32_PROVIDER_DEFAULT,                        &hUser) != 0)            {                printLine("User logged in successfully.");                CloseHandle(hUser);            }            else            {                printLine("Unable to login.");            }            /* FLAW: Release password from the stack without first clearing the buffer */        }
wchar_t * password = (wchar_t *)ALLOCA(100*sizeof(wchar_t));
wchar_t * password = (wchar_t *)ALLOCA(100*sizeof(wchar_t));
wchar_t
* password = (wchar_t *)ALLOCA(100*sizeof(wchar_t))
*
password
= (wchar_t *)ALLOCA(100*sizeof(wchar_t))
(wchar_t *)ALLOCA(100*sizeof(wchar_t))
wchar_t *
wchar_t
*
*
ALLOCA(100*sizeof(wchar_t))
ALLOCA
ALLOCA
100*sizeof(wchar_t)
100
sizeof(wchar_t)
wchar_t
wchar_t

size_t passwordLen = 0;
size_t passwordLen = 0;
size_t
size_t
passwordLen = 0
passwordLen
= 0
0
HANDLE hUser;
HANDLE hUser;
HANDLE
HANDLE
hUser
hUser
wchar_t * username = L"User";
wchar_t * username = L"User";
wchar_t
* username = L"User"
*
username
= L"User"
L"User"
wchar_t * domain = L"Domain";
wchar_t * domain = L"Domain";
wchar_t
* domain = L"Domain"
*
domain
= L"Domain"
L"Domain"
password[0] = L'\0';
password[0] = L'\0'
password[0]
password
password
0
L'\0'
if (fgetws(password, 100, stdin) == NULL)            {                printLine("fgetws() failed");                /* Restore NUL terminator if fgetws fails */                password[0] = L'\0';            }
fgetws(password, 100, stdin) == NULL
fgetws(password, 100, stdin)
fgetws
fgetws
password
password
100
stdin
stdin
NULL
NULL
{                printLine("fgetws() failed");                /* Restore NUL terminator if fgetws fails */                password[0] = L'\0';            }
printLine("fgetws() failed");
printLine("fgetws() failed")
printLine
printLine
"fgetws() failed"
password[0] = L'\0';
password[0] = L'\0'
password[0]
password
password
0
L'\0'
passwordLen = wcslen(password);
passwordLen = wcslen(password)
passwordLen
passwordLen
wcslen(password)
wcslen
wcslen
password
password
if (passwordLen > 0)            {                password[passwordLen-1] = L'\0';            }
passwordLen > 0
passwordLen
passwordLen
0
{                password[passwordLen-1] = L'\0';            }
password[passwordLen-1] = L'\0';
password[passwordLen-1] = L'\0'
password[passwordLen-1]
password
password
passwordLen-1
passwordLen
passwordLen
1
L'\0'
if (LogonUserW(                        username,                        domain,                        password,                        LOGON32_LOGON_NETWORK,                        LOGON32_PROVIDER_DEFAULT,                        &hUser) != 0)            {                printLine("User logged in successfully.");                CloseHandle(hUser);            }            else            {                printLine("Unable to login.");            }
LogonUserW(                        username,                        domain,                        password,                        LOGON32_LOGON_NETWORK,                        LOGON32_PROVIDER_DEFAULT,                        &hUser) != 0
LogonUserW(                        username,                        domain,                        password,                        LOGON32_LOGON_NETWORK,                        LOGON32_PROVIDER_DEFAULT,                        &hUser)
LogonUserW
LogonUserW
username
username
domain
domain
password
password
LOGON32_LOGON_NETWORK
LOGON32_LOGON_NETWORK
LOGON32_PROVIDER_DEFAULT
LOGON32_PROVIDER_DEFAULT
&hUser
hUser
hUser
0
{                printLine("User logged in successfully.");                CloseHandle(hUser);            }
printLine("User logged in successfully.");
printLine("User logged in successfully.")
printLine
printLine
"User logged in successfully."
CloseHandle(hUser);
CloseHandle(hUser)
CloseHandle
CloseHandle
hUser
hUser
{                printLine("Unable to login.");            }
printLine("Unable to login.");
printLine("Unable to login.")
printLine
printLine
"Unable to login."
{        {            wchar_t * password = (wchar_t *)ALLOCA(100*sizeof(wchar_t));            size_t passwordLen = 0;            HANDLE hUser;            wchar_t * username = L"User";            wchar_t * domain = L"Domain";            /* Initialize password */            password[0] = L'\0';            if (fgetws(password, 100, stdin) == NULL)            {                printLine("fgetws() failed");                /* Restore NUL terminator if fgetws fails */                password[0] = L'\0';            }            /* Remove the carriage return from the string that is inserted by fgetws() */            passwordLen = wcslen(password);            if (passwordLen > 0)            {                password[passwordLen-1] = L'\0';            }            /* Use the password in LogonUser() to establish that it is "sensitive" */            if (LogonUserW(                        username,                        domain,                        password,                        LOGON32_LOGON_NETWORK,                        LOGON32_PROVIDER_DEFAULT,                        &hUser) != 0)            {                printLine("User logged in successfully.");                CloseHandle(hUser);            }            else            {                printLine("Unable to login.");            }            passwordLen = wcslen(password);            /* FIX: Clear password prior to release from stack */            SecureZeroMemory(password, passwordLen * sizeof(wchar_t));        }    }
{            wchar_t * password = (wchar_t *)ALLOCA(100*sizeof(wchar_t));            size_t passwordLen = 0;            HANDLE hUser;            wchar_t * username = L"User";            wchar_t * domain = L"Domain";            /* Initialize password */            password[0] = L'\0';            if (fgetws(password, 100, stdin) == NULL)            {                printLine("fgetws() failed");                /* Restore NUL terminator if fgetws fails */                password[0] = L'\0';            }            /* Remove the carriage return from the string that is inserted by fgetws() */            passwordLen = wcslen(password);            if (passwordLen > 0)            {                password[passwordLen-1] = L'\0';            }            /* Use the password in LogonUser() to establish that it is "sensitive" */            if (LogonUserW(                        username,                        domain,                        password,                        LOGON32_LOGON_NETWORK,                        LOGON32_PROVIDER_DEFAULT,                        &hUser) != 0)            {                printLine("User logged in successfully.");                CloseHandle(hUser);            }            else            {                printLine("Unable to login.");            }            passwordLen = wcslen(password);            /* FIX: Clear password prior to release from stack */            SecureZeroMemory(password, passwordLen * sizeof(wchar_t));        }
wchar_t * password = (wchar_t *)ALLOCA(100*sizeof(wchar_t));
wchar_t * password = (wchar_t *)ALLOCA(100*sizeof(wchar_t));
wchar_t
* password = (wchar_t *)ALLOCA(100*sizeof(wchar_t))
*
password
= (wchar_t *)ALLOCA(100*sizeof(wchar_t))
(wchar_t *)ALLOCA(100*sizeof(wchar_t))
wchar_t *
wchar_t
*
*
ALLOCA(100*sizeof(wchar_t))
ALLOCA
ALLOCA
100*sizeof(wchar_t)
100
sizeof(wchar_t)
wchar_t
wchar_t

size_t passwordLen = 0;
size_t passwordLen = 0;
size_t
size_t
passwordLen = 0
passwordLen
= 0
0
HANDLE hUser;
HANDLE hUser;
HANDLE
HANDLE
hUser
hUser
wchar_t * username = L"User";
wchar_t * username = L"User";
wchar_t
* username = L"User"
*
username
= L"User"
L"User"
wchar_t * domain = L"Domain";
wchar_t * domain = L"Domain";
wchar_t
* domain = L"Domain"
*
domain
= L"Domain"
L"Domain"
password[0] = L'\0';
password[0] = L'\0'
password[0]
password
password
0
L'\0'
if (fgetws(password, 100, stdin) == NULL)            {                printLine("fgetws() failed");                /* Restore NUL terminator if fgetws fails */                password[0] = L'\0';            }
fgetws(password, 100, stdin) == NULL
fgetws(password, 100, stdin)
fgetws
fgetws
password
password
100
stdin
stdin
NULL
NULL
{                printLine("fgetws() failed");                /* Restore NUL terminator if fgetws fails */                password[0] = L'\0';            }
printLine("fgetws() failed");
printLine("fgetws() failed")
printLine
printLine
"fgetws() failed"
password[0] = L'\0';
password[0] = L'\0'
password[0]
password
password
0
L'\0'
passwordLen = wcslen(password);
passwordLen = wcslen(password)
passwordLen
passwordLen
wcslen(password)
wcslen
wcslen
password
password
if (passwordLen > 0)            {                password[passwordLen-1] = L'\0';            }
passwordLen > 0
passwordLen
passwordLen
0
{                password[passwordLen-1] = L'\0';            }
password[passwordLen-1] = L'\0';
password[passwordLen-1] = L'\0'
password[passwordLen-1]
password
password
passwordLen-1
passwordLen
passwordLen
1
L'\0'
if (LogonUserW(                        username,                        domain,                        password,                        LOGON32_LOGON_NETWORK,                        LOGON32_PROVIDER_DEFAULT,                        &hUser) != 0)            {                printLine("User logged in successfully.");                CloseHandle(hUser);            }            else            {                printLine("Unable to login.");            }
LogonUserW(                        username,                        domain,                        password,                        LOGON32_LOGON_NETWORK,                        LOGON32_PROVIDER_DEFAULT,                        &hUser) != 0
LogonUserW(                        username,                        domain,                        password,                        LOGON32_LOGON_NETWORK,                        LOGON32_PROVIDER_DEFAULT,                        &hUser)
LogonUserW
LogonUserW
username
username
domain
domain
password
password
LOGON32_LOGON_NETWORK
LOGON32_LOGON_NETWORK
LOGON32_PROVIDER_DEFAULT
LOGON32_PROVIDER_DEFAULT
&hUser
hUser
hUser
0
{                printLine("User logged in successfully.");                CloseHandle(hUser);            }
printLine("User logged in successfully.");
printLine("User logged in successfully.")
printLine
printLine
"User logged in successfully."
CloseHandle(hUser);
CloseHandle(hUser)
CloseHandle
CloseHandle
hUser
hUser
{                printLine("Unable to login.");            }
printLine("Unable to login.");
printLine("Unable to login.")
printLine
printLine
"Unable to login."
passwordLen = wcslen(password);
passwordLen = wcslen(password)
passwordLen
passwordLen
wcslen(password)
wcslen
wcslen
password
password
SecureZeroMemory(password, passwordLen * sizeof(wchar_t));
SecureZeroMemory(password, passwordLen * sizeof(wchar_t))
SecureZeroMemory
SecureZeroMemory
password
password
passwordLen * sizeof(wchar_t)
passwordLen
passwordLen
sizeof(wchar_t)
wchar_t
wchar_t

-----joern-----
(34,81,0)
(119,81,0)
(40,84,0)
(101,11,0)
(84,121,0)
(129,54,0)
(114,129,0)
(85,86,0)
(6,11,0)
(133,121,0)
(80,17,0)
(114,86,0)
(58,78,0)
(26,73,0)
(13,43,0)
(93,29,0)
(37,91,0)
(109,60,0)
(121,7,0)
(33,84,0)
(105,91,0)
(65,30,0)
(60,116,0)
(88,96,0)
(74,127,0)
(126,121,0)
(57,18,0)
(64,129,0)
(94,54,0)
(67,58,0)
(121,84,0)
(91,129,0)
(63,105,0)
(68,110,0)
(62,122,0)
(12,50,0)
(84,40,0)
(115,40,0)
(18,110,0)
(51,23,0)
(98,7,0)
(52,30,0)
(72,96,0)
(127,50,0)
(77,50,0)
(43,13,0)
(113,66,0)
(9,7,0)
(14,91,0)
(73,69,0)
(11,121,0)
(4,7,0)
(125,17,0)
(7,106,0)
(40,115,0)
(5,54,0)
(126,110,0)
(69,73,0)
(35,66,0)
(29,18,0)
(21,54,0)
(79,57,0)
(120,124,0)
(84,33,0)
(16,52,0)
(122,54,0)
(104,9,0)
(50,127,0)
(96,86,0)
(124,115,0)
(95,34,0)
(132,18,0)
(81,34,0)
(102,11,0)
(1,13,0)
(26,43,0)
(73,129,0)
(56,114,0)
(28,78,0)
(91,89,0)
(54,55,0)
(81,7,0)
(18,57,0)
(3,7,0)
(82,9,0)
(89,91,0)
(18,29,0)
(118,7,0)
(22,54,0)
(47,49,0)
(111,11,0)
(32,80,0)
(78,121,0)
(59,11,0)
(38,7,0)
(25,91,0)
(57,121,0)
(49,8,0)
(115,124,0)
(42,48,0)
(10,78,0)
(20,11,0)
(43,26,0)
(2,126,0)
(103,78,0)
(107,91,0)
(11,20,0)
(128,122,0)
(75,43,0)
(92,54,0)
(129,73,0)
(83,108,0)
(110,7,0)
(27,7,0)
(70,101,0)
(45,8,0)
(0,45,0)
(36,89,0)
(61,11,0)
(44,65,0)
(46,115,0)
(11,101,0)
(87,20,0)
(130,7,0)
(86,114,0)
(15,91,0)
(78,58,0)
(66,81,0)
(24,108,0)
(100,54,0)
(91,105,0)
(53,54,0)
(131,50,0)
(71,7,0)
(31,99,0)
(97,54,0)
(34,121,0)
(123,83,0)
(76,41,0)
(57,7,0)
(73,26,0)
(48,39,0)
(110,126,0)
(19,54,0)
(50,129,0)
(86,54,0)
(90,7,0)
(96,72,1)
(31,66,1)
(50,12,1)
(93,132,1)
(57,18,1)
(111,59,1)
(4,3,1)
(63,91,1)
(47,45,1)
(110,126,1)
(105,63,1)
(82,104,1)
(25,96,1)
(103,10,1)
(73,26,1)
(62,129,1)
(40,115,1)
(58,67,1)
(80,32,1)
(66,35,1)
(107,37,1)
(56,85,1)
(87,11,1)
(5,97,1)
(6,61,1)
(121,84,1)
(48,42,1)
(83,123,1)
(65,44,1)
(18,29,1)
(1,75,1)
(84,33,1)
(67,78,1)
(64,112,1)
(124,120,1)
(84,40,1)
(14,15,1)
(51,96,1)
(133,112,1)
(123,127,1)
(37,25,1)
(3,9,1)
(95,119,1)
(34,121,1)
(117,49,1)
(114,56,1)
(68,65,1)
(26,43,1)
(74,50,1)
(28,27,1)
(122,128,1)
(45,0,1)
(85,24,1)
(34,95,1)
(44,52,1)
(88,86,1)
(12,77,1)
(89,36,1)
(20,87,1)
(9,82,1)
(105,91,1)
(132,79,1)
(86,114,1)
(96,86,1)
(42,105,1)
(128,62,1)
(66,81,1)
(117,48,1)
(101,70,1)
(109,20,1)
(127,50,1)
(78,121,1)
(29,93,1)
(91,89,1)
(57,121,1)
(91,129,1)
(77,131,1)
(15,107,1)
(127,74,1)
(113,81,1)
(78,103,1)
(79,110,1)
(120,46,1)
(59,102,1)
(10,28,1)
(85,127,1)
(36,14,1)
(18,110,1)
(2,68,1)
(102,31,1)
(81,34,1)
(75,64,1)
(43,13,1)
(20,11,1)
(68,60,1)
(35,113,1)
(50,129,1)
(104,121,1)
(126,2,1)
(22,5,1)
(0,105,1)
(70,6,1)
(58,78,1)
(32,58,1)
(72,88,1)
(11,121,1)
(129,73,1)
(11,101,1)
(117,57,1)
(126,121,1)
(24,83,1)
(49,47,1)
(131,22,1)
(25,51,1)
(115,124,1)
(13,1,1)
(119,125,1)
(119,58,1)
(73,69,1)
(102,66,1)
(27,4,1)
(97,122,1)
(114,129,1)
(52,16,1)
(61,111,1)
(16,20,1)
(125,80,1)
(60,109,1)
(46,133,1)
(101,112,2)
(103,112,2)
(107,112,2)
(105,112,2)
(115,124,2)
(43,13,2)
(27,112,2)
(64,112,2)
(18,29,2)
(5,112,2)
(91,129,2)
(78,121,2)
(104,112,2)
(75,112,2)
(15,112,2)
(3,112,2)
(86,112,2)
(52,20,2)
(35,112,2)
(47,105,2)
(4,112,2)
(26,112,2)
(70,112,2)
(11,121,2)
(66,112,2)
(49,105,2)
(29,112,2)
(40,115,2)
(82,112,2)
(78,112,2)
(91,89,2)
(119,112,2)
(37,112,2)
(89,112,2)
(113,112,2)
(121,84,2)
(81,34,2)
(44,20,2)
(0,105,2)
(127,50,2)
(32,58,2)
(51,96,2)
(110,126,2)
(68,112,2)
(124,112,2)
(128,112,2)
(110,112,2)
(72,112,2)
(2,112,2)
(95,112,2)
(86,114,2)
(40,112,2)
(18,110,2)
(67,112,2)
(50,129,2)
(84,33,2)
(12,112,2)
(133,112,2)
(9,112,2)
(11,101,2)
(20,11,2)
(88,112,2)
(115,112,2)
(102,112,2)
(34,112,2)
(25,112,2)
(120,112,2)
(24,127,2)
(111,112,2)
(126,112,2)
(81,112,2)
(114,112,2)
(122,112,2)
(123,127,2)
(127,112,2)
(131,112,2)
(14,112,2)
(79,112,2)
(1,112,2)
(31,66,2)
(73,112,2)
(61,112,2)
(80,58,2)
(93,112,2)
(105,91,2)
(26,43,2)
(62,112,2)
(50,112,2)
(129,112,2)
(57,112,2)
(66,81,2)
(34,121,2)
(77,112,2)
(73,69,2)
(63,112,2)
(121,112,2)
(36,112,2)
(109,20,2)
(84,40,2)
(65,20,2)
(57,121,2)
(48,105,2)
(60,20,2)
(18,112,2)
(20,112,2)
(97,112,2)
(125,58,2)
(22,112,2)
(58,78,2)
(91,112,2)
(13,112,2)
(84,112,2)
(126,121,2)
(74,112,2)
(87,112,2)
(58,112,2)
(132,112,2)
(96,112,2)
(85,112,2)
(59,112,2)
(6,112,2)
(10,112,2)
(83,127,2)
(16,20,2)
(28,112,2)
(42,105,2)
(56,112,2)
(57,18,2)
(114,129,2)
(96,86,2)
(129,73,2)
(11,112,2)
(46,112,2)
(43,112,2)
(45,105,2)
(73,26,2)
-----------------------------------
(0,"User logged in successfully.")
(1,wchar_t)
(2,password)
(3,"User")
(4,"Domain")
(5,"Domain")
(6,LOGON32_PROVIDER_DEFAULT)
(7,)
(8,)
(9,passwordLen = 0)
(10,100)
(11,LogonUserW(\\\\n                        username,\\\\n                        domain,\\\\n                        password,\\\\n                        LOGON32_LOGON_NETWORK,\\\\n                        LOGON32_PROVIDER_DEFAULT,\\\\n                        &hUser)
(12,stdin)
(13,sizeof(wchar_t)
(14,LOGON32_PROVIDER_DEFAULT)
(15,LOGON32_LOGON_NETWORK)
(16,"User logged in successfully.")
(17,)
(18,passwordLen * sizeof(wchar_t)
(19,password)
(20,LogonUserW(\\\\n                        username,\\\\n                        domain,\\\\n                        password,\\\\n                        LOGON32_LOGON_NETWORK,\\\\n                        LOGON32_PROVIDER_DEFAULT,\\\\n                        &hUser)
(21,hUser)
(22,\\\'\\\\0\\\')
(23,)
(24,\\\'\\\\0\\\')
(25,username)
(26,ALLOCA(100*sizeof(wchar_t)
(27,\\\'\\\\0\\\')
(28,password)
(29,sizeof(wchar_t)
(30,)
(31,\\\'\\\\0\\\')
(32,"fgetws()
(33,wchar_t *)
(34,wcslen(password)
(35,0)
(36,hUser)
(37,domain)
(38,if (LogonUserW(\\\\n                        username,\\\\n                        domain,\\\\n                        password,\\\\n                        LOGON32_LOGON_NETWORK,\\\\n                        LOGON32_PROVIDER_DEFAULT,\\\\n                        &hUser)
(39,)
(40,ALLOCA(100*sizeof(wchar_t)
(41,)
(42,"Unable to login.")
(43,100*sizeof(wchar_t)
(44,hUser)
(45,printLine("User logged in successfully.")
(46,100)
(47,hUser)
(48,printLine("Unable to login.")
(49,CloseHandle(hUser)
(50,fgetws(password, 100, stdin)
(51,\\\'\\\\0\\\')
(52,printLine("User logged in successfully.")
(53,if (LogonUserW(\\\\n                        username,\\\\n                        domain,\\\\n                        password,\\\\n                        LOGON32_LOGON_NETWORK,\\\\n                        LOGON32_PROVIDER_DEFAULT,\\\\n                        &hUser)
(54,)
(55,)
(56,password)
(57,SecureZeroMemory(password, passwordLen * sizeof(wchar_t)
(58,fgetws(password, 100, stdin)
(59,domain)
(60,printLine("Unable to login.")
(61,LOGON32_LOGON_NETWORK)
(62,passwordLen)
(63,0)
(64,password)
(65,CloseHandle(hUser)
(66,passwordLen > 0)
(67,NULL)
(68,passwordLen)
(69,wchar_t *)
(70,hUser)
(71,password)
(72,0)
(73,(wchar_t *)
(74,NULL)
(75,100)
(76,if(globalReturnsTrueOrFalse()
(77,100)
(78,fgetws(password, 100, stdin)
(79,password)
(80,printLine("fgetws()
(81,passwordLen = wcslen(password)
(82,0)
(83,printLine("fgetws()
(84,(wchar_t *)
(85,passwordLen)
(86,passwordLen = wcslen(password)
(87,0)
(88,passwordLen)
(89,&hUser)
(90,hUser)
(91,LogonUserW(\\\\n                        username,\\\\n                        domain,\\\\n                        password,\\\\n                        LOGON32_LOGON_NETWORK,\\\\n                        LOGON32_PROVIDER_DEFAULT,\\\\n                        &hUser)
(92,passwordLen)
(93,wchar_t)
(94,if (fgetws(password, 100, stdin)
(95,password)
(96,passwordLen > 0)
(97,"User")
(98,if (passwordLen > 0)
(99,)
(100,if (passwordLen > 0)
(101,&hUser)
(102,username)
(103,stdin)
(104,passwordLen)
(105,LogonUserW(\\\\n                        username,\\\\n                        domain,\\\\n                        password,\\\\n                        LOGON32_LOGON_NETWORK,\\\\n                        LOGON32_PROVIDER_DEFAULT,\\\\n                        &hUser)
(106,)
(107,password)
(108,)
(109,"Unable to login.")
(110,passwordLen = wcslen(password)
(111,password)
(112,globalReturnsTrueOrFalse()
(113,passwordLen)
(114,wcslen(password)
(115,100*sizeof(wchar_t)
(116,)
(117,RET)
(118,if (fgetws(password, 100, stdin)
(119,passwordLen)
(120,wchar_t)
(121,* password = (wchar_t *)
(122,passwordLen = 0)
(123,"fgetws()
(124,sizeof(wchar_t)
(125,\\\'\\\\0\\\')
(126,wcslen(password)
(127,fgetws(password, 100, stdin)
(128,0)
(129,* password = (wchar_t *)
(130,passwordLen)
(131,password)
(132,passwordLen)
(133,password)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
