-----label-----
1
-----code-----
void CWE377_Insecure_Temporary_File__wchar_t_tempnam_12_bad()
{
    if(globalReturnsTrueOrFalse())
    {
        {
            wchar_t * filename;
            int fileDesc;
            filename = TEMPNAM(NULL, NULL);
            if (filename == NULL)
            {
                exit(1);
            }
            printWLine(filename);
            /* FLAW: Open a temporary file using open() and flags that do not prevent a race condition */
            fileDesc = OPEN(filename, O_RDWR|O_CREAT, S_IREAD|S_IWRITE);
            if (fileDesc != -1)
            {
                printLine("Temporary file was opened...now closing file");
                CLOSE(fileDesc);
            }
            free(filename);
        }
    }
    else
    {
        {
            wchar_t * filename;
            int fileDesc;
            filename = TEMPNAM(NULL, NULL);
            if (filename == NULL)
            {
                exit(1);
            }
            printWLine(filename);
            /* FIX: Open a temporary file using open() and the O_CREAT and O_EXCL flags
             * NOTE: This is not a perfect solution, but it is the base case scenario */
            fileDesc = OPEN(filename, O_RDWR|O_CREAT|O_EXCL, S_IREAD|S_IWRITE);
            if (fileDesc != -1)
            {
                printLine("Temporary file was opened...now closing file");
                CLOSE(fileDesc);
            }
            free(filename);
        }
    }
}
-----children-----
1,2
1,3
1,4
3,4
5,6
6,7
6,8
6,9
7,8
8,9
10,11
11,12
11,13
11,14
11,15
11,16
11,17
11,18
11,19
12,13
13,14
13,15
15,16
15,17
18,19
19,20
19,21
21,22
23,24
24,25
24,26
25,26
27,28
27,29
27,30
28,29
30,31
32,33
34,35
34,36
35,36
35,37
36,37
38,39
40,41
41,42
42,43
42,44
43,44
46,47
47,48
47,49
48,49
50,51
52,53
53,54
53,55
54,55
56,57
56,58
56,59
56,60
57,58
59,60
61,62
61,63
62,63
64,65
66,67
66,68
67,68
69,70
71,72
71,73
72,73
72,74
73,74
75,76
77,78
77,79
78,79
79,80
79,81
80,81
83,84
84,85
84,86
85,86
87,88
89,90
90,91
90,92
91,92
93,94
95,96
96,97
96,98
96,99
96,100
96,101
96,102
96,103
96,104
97,98
98,99
98,100
100,101
100,102
103,104
104,105
104,106
106,107
108,109
109,110
109,111
110,111
112,113
112,114
112,115
113,114
115,116
117,118
119,120
119,121
120,121
120,122
121,122
123,124
125,126
126,127
127,128
127,129
128,129
131,132
132,133
132,134
133,134
135,136
137,138
138,139
138,140
139,140
141,142
141,143
141,144
141,145
142,143
144,145
146,147
146,148
147,148
147,149
148,149
150,151
152,153
154,155
154,156
155,156
157,158
159,160
159,161
160,161
160,162
161,162
163,164
165,166
165,167
166,167
167,168
167,169
168,169
171,172
172,173
172,174
173,174
175,176
177,178
178,179
178,180
179,180
181,182
-----nextToken-----
2,4,9,14,16,17,20,22,26,29,31,33,37,39,44,45,49,51,55,58,60,63,65,68,70,74,76,81,82,86,88,92,94,99,101,102,105,107,111,114,116,118,122,124,129,130,134,136,140,143,145,149,151,153,156,158,162,164,169,170,174,176,180,182
-----computeFrom-----
24,25
24,26
35,36
35,37
53,54
53,55
61,62
61,63
66,67
66,68
72,73
72,74
109,110
109,111
120,121
120,122
138,139
138,140
146,147
146,148
147,148
147,149
154,155
154,156
160,161
160,162
-----guardedBy-----
74,88
162,176
-----guardedByNegation-----
-----lastLexicalUse-----
-----jump-----
-----attribute-----
FunctionDefinition;SimpleDeclSpecifier;FunctionDeclarator;Name;CompoundStatement;IfStatement;FunctionCallExpression;IdExpression;Name;CompoundStatement;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Pointer;Name;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;IfStatement;BinaryExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;IdExpression;Name;BinaryExpression;IdExpression;Name;IdExpression;Name;BinaryExpression;IdExpression;Name;IdExpression;Name;IfStatement;BinaryExpression;IdExpression;Name;UnaryExpression;LiteralExpression;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Pointer;Name;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;IfStatement;BinaryExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;IdExpression;Name;BinaryExpression;BinaryExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;BinaryExpression;IdExpression;Name;IdExpression;Name;IfStatement;BinaryExpression;IdExpression;Name;UnaryExpression;LiteralExpression;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;
-----ast_node-----
void CWE377_Insecure_Temporary_File__wchar_t_tempnam_12_bad(){    if(globalReturnsTrueOrFalse())    {        {            wchar_t * filename;            int fileDesc;            filename = TEMPNAM(NULL, NULL);            if (filename == NULL)            {                exit(1);            }            printWLine(filename);            /* FLAW: Open a temporary file using open() and flags that do not prevent a race condition */            fileDesc = OPEN(filename, O_RDWR|O_CREAT, S_IREAD|S_IWRITE);            if (fileDesc != -1)            {                printLine("Temporary file was opened...now closing file");                CLOSE(fileDesc);            }            free(filename);        }    }    else    {        {            wchar_t * filename;            int fileDesc;            filename = TEMPNAM(NULL, NULL);            if (filename == NULL)            {                exit(1);            }            printWLine(filename);            /* FIX: Open a temporary file using open() and the O_CREAT and O_EXCL flags             * NOTE: This is not a perfect solution, but it is the base case scenario */            fileDesc = OPEN(filename, O_RDWR|O_CREAT|O_EXCL, S_IREAD|S_IWRITE);            if (fileDesc != -1)            {                printLine("Temporary file was opened...now closing file");                CLOSE(fileDesc);            }            free(filename);        }    }}
void
CWE377_Insecure_Temporary_File__wchar_t_tempnam_12_bad()
CWE377_Insecure_Temporary_File__wchar_t_tempnam_12_bad
{    if(globalReturnsTrueOrFalse())    {        {            wchar_t * filename;            int fileDesc;            filename = TEMPNAM(NULL, NULL);            if (filename == NULL)            {                exit(1);            }            printWLine(filename);            /* FLAW: Open a temporary file using open() and flags that do not prevent a race condition */            fileDesc = OPEN(filename, O_RDWR|O_CREAT, S_IREAD|S_IWRITE);            if (fileDesc != -1)            {                printLine("Temporary file was opened...now closing file");                CLOSE(fileDesc);            }            free(filename);        }    }    else    {        {            wchar_t * filename;            int fileDesc;            filename = TEMPNAM(NULL, NULL);            if (filename == NULL)            {                exit(1);            }            printWLine(filename);            /* FIX: Open a temporary file using open() and the O_CREAT and O_EXCL flags             * NOTE: This is not a perfect solution, but it is the base case scenario */            fileDesc = OPEN(filename, O_RDWR|O_CREAT|O_EXCL, S_IREAD|S_IWRITE);            if (fileDesc != -1)            {                printLine("Temporary file was opened...now closing file");                CLOSE(fileDesc);            }            free(filename);        }    }}
if(globalReturnsTrueOrFalse())    {        {            wchar_t * filename;            int fileDesc;            filename = TEMPNAM(NULL, NULL);            if (filename == NULL)            {                exit(1);            }            printWLine(filename);            /* FLAW: Open a temporary file using open() and flags that do not prevent a race condition */            fileDesc = OPEN(filename, O_RDWR|O_CREAT, S_IREAD|S_IWRITE);            if (fileDesc != -1)            {                printLine("Temporary file was opened...now closing file");                CLOSE(fileDesc);            }            free(filename);        }    }    else    {        {            wchar_t * filename;            int fileDesc;            filename = TEMPNAM(NULL, NULL);            if (filename == NULL)            {                exit(1);            }            printWLine(filename);            /* FIX: Open a temporary file using open() and the O_CREAT and O_EXCL flags             * NOTE: This is not a perfect solution, but it is the base case scenario */            fileDesc = OPEN(filename, O_RDWR|O_CREAT|O_EXCL, S_IREAD|S_IWRITE);            if (fileDesc != -1)            {                printLine("Temporary file was opened...now closing file");                CLOSE(fileDesc);            }            free(filename);        }    }
globalReturnsTrueOrFalse()
globalReturnsTrueOrFalse
globalReturnsTrueOrFalse
{        {            wchar_t * filename;            int fileDesc;            filename = TEMPNAM(NULL, NULL);            if (filename == NULL)            {                exit(1);            }            printWLine(filename);            /* FLAW: Open a temporary file using open() and flags that do not prevent a race condition */            fileDesc = OPEN(filename, O_RDWR|O_CREAT, S_IREAD|S_IWRITE);            if (fileDesc != -1)            {                printLine("Temporary file was opened...now closing file");                CLOSE(fileDesc);            }            free(filename);        }    }
{            wchar_t * filename;            int fileDesc;            filename = TEMPNAM(NULL, NULL);            if (filename == NULL)            {                exit(1);            }            printWLine(filename);            /* FLAW: Open a temporary file using open() and flags that do not prevent a race condition */            fileDesc = OPEN(filename, O_RDWR|O_CREAT, S_IREAD|S_IWRITE);            if (fileDesc != -1)            {                printLine("Temporary file was opened...now closing file");                CLOSE(fileDesc);            }            free(filename);        }
wchar_t * filename;
wchar_t * filename;
wchar_t
* filename
*
filename
int fileDesc;
int fileDesc;
int
fileDesc
fileDesc
filename = TEMPNAM(NULL, NULL);
filename = TEMPNAM(NULL, NULL)
filename
filename
TEMPNAM(NULL, NULL)
TEMPNAM
TEMPNAM
NULL
NULL
NULL
NULL
if (filename == NULL)            {                exit(1);            }
filename == NULL
filename
filename
NULL
NULL
{                exit(1);            }
exit(1);
exit(1)
exit
exit
1
printWLine(filename);
printWLine(filename)
printWLine
printWLine
filename
filename
fileDesc = OPEN(filename, O_RDWR|O_CREAT, S_IREAD|S_IWRITE);
fileDesc = OPEN(filename, O_RDWR|O_CREAT, S_IREAD|S_IWRITE)
fileDesc
fileDesc
OPEN(filename, O_RDWR|O_CREAT, S_IREAD|S_IWRITE)
OPEN
OPEN
filename
filename
O_RDWR|O_CREAT
O_RDWR
O_RDWR
O_CREAT
O_CREAT
S_IREAD|S_IWRITE
S_IREAD
S_IREAD
S_IWRITE
S_IWRITE
if (fileDesc != -1)            {                printLine("Temporary file was opened...now closing file");                CLOSE(fileDesc);            }
fileDesc != -1
fileDesc
fileDesc
-1
1
{                printLine("Temporary file was opened...now closing file");                CLOSE(fileDesc);            }
printLine("Temporary file was opened...now closing file");
printLine("Temporary file was opened...now closing file")
printLine
printLine
"Temporary file was opened...now closing file"
CLOSE(fileDesc);
CLOSE(fileDesc)
CLOSE
CLOSE
fileDesc
fileDesc
free(filename);
free(filename)
free
free
filename
filename
{        {            wchar_t * filename;            int fileDesc;            filename = TEMPNAM(NULL, NULL);            if (filename == NULL)            {                exit(1);            }            printWLine(filename);            /* FIX: Open a temporary file using open() and the O_CREAT and O_EXCL flags             * NOTE: This is not a perfect solution, but it is the base case scenario */            fileDesc = OPEN(filename, O_RDWR|O_CREAT|O_EXCL, S_IREAD|S_IWRITE);            if (fileDesc != -1)            {                printLine("Temporary file was opened...now closing file");                CLOSE(fileDesc);            }            free(filename);        }    }
{            wchar_t * filename;            int fileDesc;            filename = TEMPNAM(NULL, NULL);            if (filename == NULL)            {                exit(1);            }            printWLine(filename);            /* FIX: Open a temporary file using open() and the O_CREAT and O_EXCL flags             * NOTE: This is not a perfect solution, but it is the base case scenario */            fileDesc = OPEN(filename, O_RDWR|O_CREAT|O_EXCL, S_IREAD|S_IWRITE);            if (fileDesc != -1)            {                printLine("Temporary file was opened...now closing file");                CLOSE(fileDesc);            }            free(filename);        }
wchar_t * filename;
wchar_t * filename;
wchar_t
* filename
*
filename
int fileDesc;
int fileDesc;
int
fileDesc
fileDesc
filename = TEMPNAM(NULL, NULL);
filename = TEMPNAM(NULL, NULL)
filename
filename
TEMPNAM(NULL, NULL)
TEMPNAM
TEMPNAM
NULL
NULL
NULL
NULL
if (filename == NULL)            {                exit(1);            }
filename == NULL
filename
filename
NULL
NULL
{                exit(1);            }
exit(1);
exit(1)
exit
exit
1
printWLine(filename);
printWLine(filename)
printWLine
printWLine
filename
filename
fileDesc = OPEN(filename, O_RDWR|O_CREAT|O_EXCL, S_IREAD|S_IWRITE);
fileDesc = OPEN(filename, O_RDWR|O_CREAT|O_EXCL, S_IREAD|S_IWRITE)
fileDesc
fileDesc
OPEN(filename, O_RDWR|O_CREAT|O_EXCL, S_IREAD|S_IWRITE)
OPEN
OPEN
filename
filename
O_RDWR|O_CREAT|O_EXCL
O_RDWR|O_CREAT
O_RDWR
O_RDWR
O_CREAT
O_CREAT
O_EXCL
O_EXCL
S_IREAD|S_IWRITE
S_IREAD
S_IREAD
S_IWRITE
S_IWRITE
if (fileDesc != -1)            {                printLine("Temporary file was opened...now closing file");                CLOSE(fileDesc);            }
fileDesc != -1
fileDesc
fileDesc
-1
1
{                printLine("Temporary file was opened...now closing file");                CLOSE(fileDesc);            }
printLine("Temporary file was opened...now closing file");
printLine("Temporary file was opened...now closing file")
printLine
printLine
"Temporary file was opened...now closing file"
CLOSE(fileDesc);
CLOSE(fileDesc)
CLOSE
CLOSE
fileDesc
fileDesc
free(filename);
free(filename)
free
free
filename
filename
-----joern-----
(57,77,0)
(44,58,0)
(53,73,0)
(21,52,0)
(11,14,0)
(30,8,0)
(22,34,0)
(28,1,0)
(58,36,0)
(48,17,0)
(68,46,0)
(55,17,0)
(1,47,0)
(78,29,0)
(82,58,0)
(6,60,0)
(38,2,0)
(50,35,0)
(60,85,0)
(69,36,0)
(31,58,0)
(60,73,0)
(81,71,0)
(23,56,0)
(77,47,0)
(2,56,0)
(80,17,0)
(20,50,0)
(70,80,0)
(14,85,0)
(31,36,0)
(72,56,0)
(84,76,0)
(25,72,0)
(40,5,0)
(54,80,0)
(85,14,0)
(16,56,0)
(2,17,0)
(49,14,0)
(35,73,0)
(18,42,0)
(43,69,0)
(66,52,0)
(52,58,0)
(26,76,0)
(32,36,0)
(62,56,0)
(19,85,0)
(73,56,0)
(75,51,0)
(29,42,0)
(46,79,0)
(36,7,0)
(15,64,0)
(42,69,0)
(34,43,0)
(13,58,0)
(8,4,0)
(1,69,0)
(73,60,0)
(74,48,0)
(76,60,0)
(82,36,0)
(59,43,0)
(65,31,0)
(85,60,0)
(51,45,0)
(0,82,0)
(67,44,0)
(41,48,0)
(58,52,0)
(37,36,0)
(69,43,0)
(43,58,0)
(33,69,0)
(24,44,0)
(56,63,0)
(83,35,0)
(8,73,0)
(35,50,0)
(43,34,0)
(27,34,0)
(17,56,0)
(42,29,0)
(60,17,0)
(17,48,0)
(61,36,0)
(3,56,0)
(5,4,0)
(60,76,0)
(71,43,0)
(10,36,0)
(43,71,0)
(72,17,0)
(39,71,0)
(22,71,1)
(82,58,1)
(29,78,1)
(60,76,1)
(43,34,1)
(75,80,1)
(6,53,1)
(27,22,1)
(43,71,1)
(67,24,1)
(48,74,1)
(81,59,1)
(30,5,1)
(24,58,1)
(41,55,1)
(59,33,1)
(71,39,1)
(73,60,1)
(14,11,1)
(8,73,1)
(44,58,1)
(8,30,1)
(44,67,1)
(38,80,1)
(54,17,1)
(58,52,1)
(65,1,1)
(84,26,1)
(76,84,1)
(31,65,1)
(80,70,1)
(55,9,1)
(77,57,1)
(25,35,1)
(42,29,1)
(49,19,1)
(60,17,1)
(5,40,1)
(35,73,1)
(57,42,1)
(20,83,1)
(43,58,1)
(70,54,1)
(19,6,1)
(46,68,1)
(66,21,1)
(0,44,1)
(39,81,1)
(11,49,1)
(65,42,1)
(2,17,1)
(78,18,1)
(1,69,1)
(38,51,1)
(82,0,1)
(50,20,1)
(35,50,1)
(26,85,1)
(2,38,1)
(72,25,1)
(21,13,1)
(1,28,1)
(18,69,1)
(69,43,1)
(85,14,1)
(60,85,1)
(12,31,1)
(51,75,1)
(80,17,1)
(40,35,1)
(0,46,1)
(31,58,1)
(33,82,1)
(68,44,1)
(42,69,1)
(28,77,1)
(25,8,1)
(53,2,1)
(34,27,1)
(17,48,1)
(74,41,1)
(12,72,1)
(83,73,1)
(72,17,1)
(52,66,1)
(13,9,1)
(17,48,2)
(53,9,2)
(67,9,2)
(74,9,2)
(80,9,2)
(31,9,2)
(42,9,2)
(8,35,2)
(81,9,2)
(60,17,2)
(71,9,2)
(60,85,2)
(14,9,2)
(72,17,2)
(1,42,2)
(52,9,2)
(69,9,2)
(49,9,2)
(70,9,2)
(73,60,2)
(30,35,2)
(72,9,2)
(1,69,2)
(42,29,2)
(8,73,2)
(82,9,2)
(42,69,2)
(21,9,2)
(58,9,2)
(43,34,2)
(2,9,2)
(54,9,2)
(57,42,2)
(51,80,2)
(55,9,2)
(75,80,2)
(25,9,2)
(19,9,2)
(35,9,2)
(44,9,2)
(73,9,2)
(58,52,2)
(31,58,2)
(60,76,2)
(34,9,2)
(60,9,2)
(35,73,2)
(17,9,2)
(38,9,2)
(33,9,2)
(5,35,2)
(82,58,2)
(6,9,2)
(13,9,2)
(83,9,2)
(78,9,2)
(77,42,2)
(80,17,2)
(28,42,2)
(46,44,2)
(59,9,2)
(43,71,2)
(41,9,2)
(40,35,2)
(68,44,2)
(43,9,2)
(43,58,2)
(24,9,2)
(27,9,2)
(35,50,2)
(2,17,2)
(29,9,2)
(84,9,2)
(65,9,2)
(85,14,2)
(69,43,2)
(39,9,2)
(44,58,2)
(26,9,2)
(18,9,2)
(85,9,2)
(0,9,2)
(48,9,2)
(11,9,2)
(22,9,2)
(50,9,2)
(76,9,2)
(20,9,2)
(66,9,2)
-----------------------------------
(0,filename)
(1,CLOSE(fileDesc)
(2,printWLine(filename)
(3,fileDesc)
(4,)
(5,printLine("Temporary file was opened...now closing file")
(6,filename)
(7,)
(8,CLOSE(fileDesc)
(9,globalReturnsTrueOrFalse()
(10,filename)
(11,O_EXCL)
(12,RET)
(13,filename)
(14,O_CREAT|O_EXCL)
(15,if(globalReturnsTrueOrFalse()
(16,if (fileDesc != -1)
(17,filename = TEMPNAM(NULL, NULL)
(18,fileDesc)
(19,O_RDWR)
(20,1)
(21,NULL)
(22,S_IREAD)
(23,if (filename == NULL)
(24,filename)
(25,filename)
(26,S_IREAD)
(27,S_IWRITE)
(28,fileDesc)
(29,-1)
(30,fileDesc)
(31,free(filename)
(32,fileDesc)
(33,fileDesc)
(34,S_IREAD|S_IWRITE)
(35,fileDesc != -1)
(36,)
(37,if (filename == NULL)
(38,filename)
(39,O_CREAT)
(40,"Temporary file was opened...now closing file")
(41,NULL)
(42,fileDesc != -1)
(43,OPEN(filename, O_RDWR|O_CREAT, S_IREAD|S_IWRITE)
(44,filename == NULL)
(45,)
(46,exit(1)
(47,)
(48,TEMPNAM(NULL, NULL)
(49,O_CREAT)
(50,-1)
(51,exit(1)
(52,TEMPNAM(NULL, NULL)
(53,fileDesc)
(54,filename)
(55,filename)
(56,)
(57,"Temporary file was opened...now closing file")
(58,filename = TEMPNAM(NULL, NULL)
(59,filename)
(60,OPEN(filename, O_RDWR|O_CREAT|O_EXCL, S_IREAD|S_IWRITE)
(61,if (fileDesc != -1)
(62,filename)
(63,)
(64,)
(65,filename)
(66,NULL)
(67,NULL)
(68,1)
(69,fileDesc = OPEN(filename, O_RDWR|O_CREAT, S_IREAD|S_IWRITE)
(70,NULL)
(71,O_RDWR|O_CREAT)
(72,free(filename)
(73,fileDesc = OPEN(filename, O_RDWR|O_CREAT|O_EXCL, S_IREAD|S_IWRITE)
(74,NULL)
(75,1)
(76,S_IREAD|S_IWRITE)
(77,printLine("Temporary file was opened...now closing file")
(78,1)
(79,)
(80,filename == NULL)
(81,O_RDWR)
(82,printWLine(filename)
(83,fileDesc)
(84,S_IWRITE)
(85,O_RDWR|O_CREAT|O_EXCL)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
