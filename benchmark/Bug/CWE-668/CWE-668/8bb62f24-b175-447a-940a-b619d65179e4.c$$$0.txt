-----label-----
1
-----code-----
void CWE256_Plaintext_Storage_of_Password__w32_char_67b_badSink(CWE256_Plaintext_Storage_of_Password__w32_char_67_structType myStruct)
{
    char * data = myStruct.structFirst;
    {
        HANDLE pHandle;
        char * username = "User";
        char * domain = "Domain";
        /* POTENTIAL FLAW: Attempt to login user with password from the source */
        if (LogonUserA(
                    username,
                    domain,
                    data,
                    LOGON32_LOGON_NETWORK,
                    LOGON32_PROVIDER_DEFAULT,
                    &pHandle) != 0)
        {
            printLine("User logged in successfully.");
            CloseHandle(pHandle);
        }
        else
        {
            printLine("Unable to login.");
        }
    }
}
-----children-----
1,2
1,3
1,4
3,4
3,5
5,6
5,7
6,7
8,9
10,11
10,12
11,12
12,13
12,14
14,15
14,16
14,17
17,18
18,19
18,20
19,20
22,23
22,24
22,25
22,26
23,24
24,25
24,26
25,26
27,28
29,30
30,31
30,32
32,33
32,34
32,35
35,36
37,38
38,39
38,40
40,41
40,42
40,43
43,44
45,46
45,47
45,48
46,47
46,48
47,48
47,49
47,50
47,51
47,52
47,53
47,54
48,49
50,51
52,53
54,55
56,57
58,59
60,61
61,62
64,65
64,66
65,66
66,67
66,68
67,68
70,71
71,72
71,73
72,73
74,75
76,77
77,78
78,79
78,80
79,80
-----nextToken-----
2,4,7,9,13,15,16,20,21,26,28,31,33,34,36,39,41,42,44,49,51,53,55,57,59,62,63,68,69,73,75,80,81
-----computeFrom-----
46,47
46,48
-----guardedBy-----
62,75
-----guardedByNegation-----
-----lastLexicalUse-----
-----jump-----
-----attribute-----
FunctionDefinition;SimpleDeclSpecifier;FunctionDeclarator;Name;ParameterDeclaration;NamedTypeSpecifier;Name;Declarator;Name;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Pointer;Name;EqualsInitializer;FieldReference;IdExpression;Name;Name;CompoundStatement;DeclarationStatement;SimpleDeclaration;NamedTypeSpecifier;Name;Declarator;Name;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Pointer;Name;EqualsInitializer;LiteralExpression;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Pointer;Name;EqualsInitializer;LiteralExpression;IfStatement;BinaryExpression;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;IdExpression;Name;IdExpression;Name;IdExpression;Name;UnaryExpression;IdExpression;Name;LiteralExpression;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;LiteralExpression;
-----ast_node-----
void CWE256_Plaintext_Storage_of_Password__w32_char_67b_badSink(CWE256_Plaintext_Storage_of_Password__w32_char_67_structType myStruct){    char * data = myStruct.structFirst;    {        HANDLE pHandle;        char * username = "User";        char * domain = "Domain";        /* POTENTIAL FLAW: Attempt to login user with password from the source */        if (LogonUserA(                    username,                    domain,                    data,                    LOGON32_LOGON_NETWORK,                    LOGON32_PROVIDER_DEFAULT,                    &pHandle) != 0)        {            printLine("User logged in successfully.");            CloseHandle(pHandle);        }        else        {            printLine("Unable to login.");        }    }}
void
CWE256_Plaintext_Storage_of_Password__w32_char_67b_badSink(CWE256_Plaintext_Storage_of_Password__w32_char_67_structType myStruct)
CWE256_Plaintext_Storage_of_Password__w32_char_67b_badSink
CWE256_Plaintext_Storage_of_Password__w32_char_67_structType myStruct
CWE256_Plaintext_Storage_of_Password__w32_char_67_structType
CWE256_Plaintext_Storage_of_Password__w32_char_67_structType
myStruct
myStruct
{    char * data = myStruct.structFirst;    {        HANDLE pHandle;        char * username = "User";        char * domain = "Domain";        /* POTENTIAL FLAW: Attempt to login user with password from the source */        if (LogonUserA(                    username,                    domain,                    data,                    LOGON32_LOGON_NETWORK,                    LOGON32_PROVIDER_DEFAULT,                    &pHandle) != 0)        {            printLine("User logged in successfully.");            CloseHandle(pHandle);        }        else        {            printLine("Unable to login.");        }    }}
char * data = myStruct.structFirst;
char * data = myStruct.structFirst;
char
* data = myStruct.structFirst
*
data
= myStruct.structFirst
myStruct.structFirst
myStruct
myStruct
structFirst
{        HANDLE pHandle;        char * username = "User";        char * domain = "Domain";        /* POTENTIAL FLAW: Attempt to login user with password from the source */        if (LogonUserA(                    username,                    domain,                    data,                    LOGON32_LOGON_NETWORK,                    LOGON32_PROVIDER_DEFAULT,                    &pHandle) != 0)        {            printLine("User logged in successfully.");            CloseHandle(pHandle);        }        else        {            printLine("Unable to login.");        }    }
HANDLE pHandle;
HANDLE pHandle;
HANDLE
HANDLE
pHandle
pHandle
char * username = "User";
char * username = "User";
char
* username = "User"
*
username
= "User"
"User"
char * domain = "Domain";
char * domain = "Domain";
char
* domain = "Domain"
*
domain
= "Domain"
"Domain"
if (LogonUserA(                    username,                    domain,                    data,                    LOGON32_LOGON_NETWORK,                    LOGON32_PROVIDER_DEFAULT,                    &pHandle) != 0)        {            printLine("User logged in successfully.");            CloseHandle(pHandle);        }        else        {            printLine("Unable to login.");        }
LogonUserA(                    username,                    domain,                    data,                    LOGON32_LOGON_NETWORK,                    LOGON32_PROVIDER_DEFAULT,                    &pHandle) != 0
LogonUserA(                    username,                    domain,                    data,                    LOGON32_LOGON_NETWORK,                    LOGON32_PROVIDER_DEFAULT,                    &pHandle)
LogonUserA
LogonUserA
username
username
domain
domain
data
data
LOGON32_LOGON_NETWORK
LOGON32_LOGON_NETWORK
LOGON32_PROVIDER_DEFAULT
LOGON32_PROVIDER_DEFAULT
&pHandle
pHandle
pHandle
0
{            printLine("User logged in successfully.");            CloseHandle(pHandle);        }
printLine("User logged in successfully.");
printLine("User logged in successfully.")
printLine
printLine
"User logged in successfully."
CloseHandle(pHandle);
CloseHandle(pHandle)
CloseHandle
CloseHandle
pHandle
pHandle
{            printLine("Unable to login.");        }
printLine("Unable to login.");
printLine("Unable to login.")
printLine
printLine
"Unable to login."
-----joern-----
(33,27,0)
(1,14,0)
(7,18,0)
(30,27,0)
(6,28,0)
(32,18,0)
(23,25,0)
(3,25,0)
(34,27,0)
(5,14,0)
(20,21,0)
(36,27,0)
(31,13,0)
(28,25,0)
(27,28,0)
(10,36,0)
(27,13,0)
(27,5,0)
(27,8,0)
(27,36,0)
(35,25,0)
(5,18,0)
(22,27,0)
(16,37,0)
(37,11,0)
(18,12,0)
(26,27,0)
(18,5,0)
(9,13,0)
(25,14,0)
(2,19,0)
(13,25,0)
(8,27,0)
(15,8,0)
(0,28,0)
(29,5,0)
(4,25,0)
(17,2,0)
(21,11,0)
(34,26,1)
(24,2,1)
(17,8,1)
(33,22,1)
(10,34,1)
(28,6,1)
(15,27,1)
(27,28,1)
(27,5,1)
(0,13,1)
(7,32,1)
(18,12,1)
(2,17,1)
(21,20,1)
(8,27,1)
(27,13,1)
(26,30,1)
(18,7,1)
(37,16,1)
(24,37,1)
(22,28,1)
(32,29,1)
(9,5,1)
(16,21,1)
(36,10,1)
(27,36,1)
(6,0,1)
(13,31,1)
(30,33,1)
(8,15,1)
(31,9,1)
(5,18,1)
(20,8,1)
(17,8,2)
(27,28,2)
(27,36,2)
(18,12,2)
(27,13,2)
(8,27,2)
(5,18,2)
(16,8,2)
(27,5,2)
(2,8,2)
(21,8,2)
(37,8,2)
(20,8,2)
-----------------------------------
(0,domain)
(1,data)
(2,printLine("Unable to login.")
(3,if (LogonUserA(\\\\n                    username,\\\\n                    domain,\\\\n                    data,\\\\n                    LOGON32_LOGON_NETWORK,\\\\n                    LOGON32_PROVIDER_DEFAULT,\\\\n                    &pHandle)
(4,username)
(5,* data = myStruct.structFirst)
(6,"Domain")
(7,structFirst)
(8,LogonUserA(\\\\n                    username,\\\\n                    domain,\\\\n                    data,\\\\n                    LOGON32_LOGON_NETWORK,\\\\n                    LOGON32_PROVIDER_DEFAULT,\\\\n                    &pHandle)
(9,username)
(10,pHandle)
(11,)
(12,CWE256_Plaintext_Storage_of_Password__w32_char_67_structType myStruct)
(13,* username = "User")
(14,)
(15,0)
(16,pHandle)
(17,"Unable to login.")
(18,myStruct.structFirst)
(19,)
(20,"User logged in successfully.")
(21,printLine("User logged in successfully.")
(22,username)
(23,domain)
(24,RET)
(25,)
(26,LOGON32_LOGON_NETWORK)
(27,LogonUserA(\\\\n                    username,\\\\n                    domain,\\\\n                    data,\\\\n                    LOGON32_LOGON_NETWORK,\\\\n                    LOGON32_PROVIDER_DEFAULT,\\\\n                    &pHandle)
(28,* domain = "Domain")
(29,data)
(30,data)
(31,"User")
(32,myStruct)
(33,domain)
(34,LOGON32_PROVIDER_DEFAULT)
(35,pHandle)
(36,&pHandle)
(37,CloseHandle(pHandle)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
