-----label-----
1
-----code-----
void CWE195_Signed_to_Unsigned_Conversion_Error__rand_memcpy_32_bad()
{
    int data;
    int *dataPtr1 = &data;
    int *dataPtr2 = &data;
    /* Initialize data */
    data = -1;
    {
        int data = *dataPtr1;
        /* POTENTIAL FLAW: Set data to a random value */
        data = RAND32();
        *dataPtr1 = data;
    }
    {
        int data = *dataPtr2;
        {
            char source[100];
            char dest[100] = "";
            memset(source, 'A', 100-1);
            source[100-1] = '\0';
            if (data < 100)
            {
                /* POTENTIAL FLAW: data is interpreted as an unsigned int - if its value is negative,
                 * the sign conversion could result in a very large number */
                memcpy(dest, source, data);
                dest[data] = '\0'; /* NULL terminate */
            }
            printLine(dest);
        }
    }
}
-----children-----
1,2
1,3
1,4
3,4
5,6
5,7
5,8
5,9
5,10
5,11
6,7
7,8
7,9
9,10
11,12
12,13
12,14
14,15
14,16
14,17
17,18
18,19
19,20
21,22
22,23
22,24
24,25
24,26
24,27
27,28
28,29
29,30
31,32
32,33
32,34
33,34
35,36
37,38
37,39
37,40
38,39
39,40
39,41
41,42
41,43
43,44
44,45
45,46
47,48
48,49
48,50
49,50
51,52
52,53
54,55
55,56
55,57
56,57
57,58
59,60
61,62
61,63
62,63
63,64
63,65
65,66
65,67
67,68
68,69
69,70
71,72
71,73
71,74
71,75
71,76
71,77
72,73
73,74
73,75
75,76
75,77
77,78
79,80
80,81
80,82
82,83
82,84
82,85
84,85
86,87
88,89
89,90
89,91
89,92
89,93
90,91
92,93
95,96
95,97
98,99
99,100
99,101
100,101
100,102
101,102
103,104
103,105
107,108
107,109
108,109
108,110
109,110
112,113
112,114
113,114
114,115
114,116
114,117
114,118
115,116
117,118
119,120
121,122
123,124
124,125
124,126
125,126
125,127
126,127
128,129
131,132
132,133
132,134
133,134
135,136
-----nextToken-----
2,4,8,10,13,15,16,20,23,25,26,30,34,36,40,42,46,50,53,58,60,64,66,70,74,76,78,81,83,85,87,91,93,94,96,97,102,104,105,106,110,111,116,118,120,122,127,129,130,134,136
-----computeFrom-----
32,33
32,34
48,49
48,50
55,56
55,57
95,96
95,97
99,100
99,101
103,104
103,105
108,109
108,110
124,125
124,126
-----guardedBy-----
110,129
-----guardedByNegation-----
-----lastLexicalUse-----
-----jump-----
-----attribute-----
FunctionDefinition;SimpleDeclSpecifier;FunctionDeclarator;Name;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Name;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Pointer;Name;EqualsInitializer;UnaryExpression;IdExpression;Name;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Pointer;Name;EqualsInitializer;UnaryExpression;IdExpression;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;UnaryExpression;LiteralExpression;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Name;EqualsInitializer;UnaryExpression;IdExpression;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;ExpressionStatement;BinaryExpression;UnaryExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Name;EqualsInitializer;UnaryExpression;IdExpression;Name;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;ArrayDeclarator;Name;ArrayModifier;LiteralExpression;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;ArrayDeclarator;Name;ArrayModifier;LiteralExpression;EqualsInitializer;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;LiteralExpression;BinaryExpression;LiteralExpression;LiteralExpression;ExpressionStatement;BinaryExpression;ArraySubscriptExpression;IdExpression;Name;BinaryExpression;LiteralExpression;LiteralExpression;LiteralExpression;IfStatement;BinaryExpression;IdExpression;Name;LiteralExpression;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;IdExpression;Name;ExpressionStatement;BinaryExpression;ArraySubscriptExpression;IdExpression;Name;IdExpression;Name;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;
-----ast_node-----
void CWE195_Signed_to_Unsigned_Conversion_Error__rand_memcpy_32_bad(){    int data;    int *dataPtr1 = &data;    int *dataPtr2 = &data;    /* Initialize data */    data = -1;    {        int data = *dataPtr1;        /* POTENTIAL FLAW: Set data to a random value */        data = RAND32();        *dataPtr1 = data;    }    {        int data = *dataPtr2;        {            char source[100];            char dest[100] = "";            memset(source, 'A', 100-1);            source[100-1] = '\0';            if (data < 100)            {                /* POTENTIAL FLAW: data is interpreted as an unsigned int - if its value is negative,                 * the sign conversion could result in a very large number */                memcpy(dest, source, data);                dest[data] = '\0'; /* NULL terminate */            }            printLine(dest);        }    }}
void
CWE195_Signed_to_Unsigned_Conversion_Error__rand_memcpy_32_bad()
CWE195_Signed_to_Unsigned_Conversion_Error__rand_memcpy_32_bad
{    int data;    int *dataPtr1 = &data;    int *dataPtr2 = &data;    /* Initialize data */    data = -1;    {        int data = *dataPtr1;        /* POTENTIAL FLAW: Set data to a random value */        data = RAND32();        *dataPtr1 = data;    }    {        int data = *dataPtr2;        {            char source[100];            char dest[100] = "";            memset(source, 'A', 100-1);            source[100-1] = '\0';            if (data < 100)            {                /* POTENTIAL FLAW: data is interpreted as an unsigned int - if its value is negative,                 * the sign conversion could result in a very large number */                memcpy(dest, source, data);                dest[data] = '\0'; /* NULL terminate */            }            printLine(dest);        }    }}
int data;
int data;
int
data
data
int *dataPtr1 = &data;
int *dataPtr1 = &data;
int
*dataPtr1 = &data
*
dataPtr1
= &data
&data
data
data
int *dataPtr2 = &data;
int *dataPtr2 = &data;
int
*dataPtr2 = &data
*
dataPtr2
= &data
&data
data
data
data = -1;
data = -1
data
data
-1
1
{        int data = *dataPtr1;        /* POTENTIAL FLAW: Set data to a random value */        data = RAND32();        *dataPtr1 = data;    }
int data = *dataPtr1;
int data = *dataPtr1;
int
data = *dataPtr1
data
= *dataPtr1
*dataPtr1
dataPtr1
dataPtr1
data = RAND32();
data = RAND32()
data
data
RAND32()
RAND32
RAND32
*dataPtr1 = data;
*dataPtr1 = data
*dataPtr1
dataPtr1
dataPtr1
data
data
{        int data = *dataPtr2;        {            char source[100];            char dest[100] = "";            memset(source, 'A', 100-1);            source[100-1] = '\0';            if (data < 100)            {                /* POTENTIAL FLAW: data is interpreted as an unsigned int - if its value is negative,                 * the sign conversion could result in a very large number */                memcpy(dest, source, data);                dest[data] = '\0'; /* NULL terminate */            }            printLine(dest);        }    }
int data = *dataPtr2;
int data = *dataPtr2;
int
data = *dataPtr2
data
= *dataPtr2
*dataPtr2
dataPtr2
dataPtr2
{            char source[100];            char dest[100] = "";            memset(source, 'A', 100-1);            source[100-1] = '\0';            if (data < 100)            {                /* POTENTIAL FLAW: data is interpreted as an unsigned int - if its value is negative,                 * the sign conversion could result in a very large number */                memcpy(dest, source, data);                dest[data] = '\0'; /* NULL terminate */            }            printLine(dest);        }
char source[100];
char source[100];
char
source[100]
source
[100]
100
char dest[100] = "";
char dest[100] = "";
char
dest[100] = ""
dest
[100]
100
= ""
""
memset(source, 'A', 100-1);
memset(source, 'A', 100-1)
memset
memset
source
source
'A'
100-1
100
1
source[100-1] = '\0';
source[100-1] = '\0'
source[100-1]
source
source
100-1
100
1
'\0'
if (data < 100)            {                /* POTENTIAL FLAW: data is interpreted as an unsigned int - if its value is negative,                 * the sign conversion could result in a very large number */                memcpy(dest, source, data);                dest[data] = '\0'; /* NULL terminate */            }
data < 100
data
data
100
{                /* POTENTIAL FLAW: data is interpreted as an unsigned int - if its value is negative,                 * the sign conversion could result in a very large number */                memcpy(dest, source, data);                dest[data] = '\0'; /* NULL terminate */            }
memcpy(dest, source, data);
memcpy(dest, source, data)
memcpy
memcpy
dest
dest
source
source
data
data
dest[data] = '\0';
dest[data] = '\0'
dest[data]
dest
dest
data
data
'\0'
printLine(dest);
printLine(dest)
printLine
printLine
dest
dest
-----joern-----
(3,47,0)
(23,38,0)
(55,11,0)
(1,25,0)
(48,20,0)
(58,11,0)
(32,26,0)
(36,57,0)
(66,58,0)
(38,27,0)
(33,25,0)
(57,10,0)
(20,47,0)
(62,68,0)
(31,20,0)
(52,14,0)
(15,18,0)
(27,38,0)
(57,9,0)
(70,27,0)
(69,11,0)
(45,41,0)
(44,11,0)
(40,41,0)
(26,10,0)
(62,64,0)
(4,69,0)
(41,58,0)
(6,47,0)
(35,18,0)
(54,33,0)
(11,64,0)
(9,57,0)
(25,33,0)
(50,22,0)
(17,47,0)
(37,3,0)
(21,55,0)
(18,58,0)
(20,31,0)
(18,50,0)
(53,69,0)
(63,58,0)
(24,4,0)
(51,10,0)
(65,64,0)
(43,41,0)
(41,62,0)
(5,11,0)
(68,62,0)
(8,26,0)
(26,8,0)
(49,50,0)
(2,33,0)
(34,4,0)
(12,31,0)
(46,62,0)
(59,26,0)
(4,34,0)
(3,37,0)
(56,34,0)
(18,62,0)
(61,47,0)
(60,28,0)
(7,34,0)
(42,68,0)
(29,9,0)
(0,25,0)
(14,32,0)
(39,28,0)
(38,47,0)
(41,22,0)
(10,47,0)
(64,47,0)
(13,3,0)
(19,37,0)
(68,3,0)
(9,20,0)
(25,11,0)
(16,32,0)
(28,62,0)
(32,10,0)
(67,11,0)
(14,20,0)
(55,58,0)
(8,59,1)
(49,18,1)
(0,58,1)
(18,35,1)
(58,63,1)
(35,15,1)
(32,16,1)
(19,13,1)
(41,58,1)
(66,62,1)
(14,20,1)
(46,32,1)
(69,53,1)
(39,69,1)
(20,31,1)
(18,58,1)
(38,27,1)
(21,28,1)
(30,55,1)
(63,66,1)
(9,29,1)
(27,70,1)
(70,23,1)
(53,4,1)
(13,20,1)
(59,57,1)
(4,34,1)
(62,68,1)
(43,40,1)
(68,42,1)
(52,26,1)
(24,25,1)
(3,37,1)
(29,36,1)
(25,33,1)
(1,0,1)
(28,60,1)
(42,46,1)
(9,20,1)
(56,7,1)
(32,26,1)
(37,19,1)
(2,1,1)
(34,56,1)
(60,39,1)
(21,50,1)
(28,62,1)
(68,3,1)
(55,58,1)
(55,21,1)
(45,28,1)
(16,14,1)
(33,54,1)
(23,3,1)
(50,49,1)
(12,48,1)
(26,8,1)
(36,38,1)
(31,12,1)
(41,62,1)
(40,45,1)
(41,43,1)
(54,2,1)
(14,52,1)
(18,62,1)
(57,9,1)
(7,24,1)
(15,41,1)
(41,58,2)
(35,28,2)
(40,28,2)
(15,28,2)
(62,68,2)
(25,33,2)
(50,28,2)
(18,28,2)
(28,62,2)
(41,28,2)
(41,62,2)
(68,3,2)
(38,27,2)
(26,8,2)
(4,34,2)
(49,28,2)
(9,20,2)
(3,37,2)
(45,28,2)
(20,31,2)
(55,58,2)
(32,26,2)
(18,58,2)
(18,62,2)
(57,9,2)
(43,28,2)
(14,20,2)
-----------------------------------
(0,source)
(1,\\\'A\\\')
(2,100)
(3,*dataPtr2 = &data)
(4,source[100-1])
(5,dest)
(6,dataPtr1)
(7,100)
(8,RAND32()
(9,*dataPtr1)
(10,)
(11,)
(12,data)
(13,dataPtr2)
(14,*dataPtr1)
(15,dest)
(16,data)
(17,data)
(18,dest[data])
(19,data)
(20,*dataPtr1 = &data)
(21,dest)
(22,)
(23,data)
(24,source)
(25,memset(source, \\\'A\\\', 100-1)
(26,data = RAND32()
(27,-1)
(28,data < 100)
(29,dataPtr1)
(30,RET)
(31,&data)
(32,*dataPtr1 = data)
(33,100-1)
(34,100-1)
(35,data)
(36,data)
(37,&data)
(38,data = -1)
(39,data)
(40,source)
(41,memcpy(dest, source, data)
(42,dataPtr2)
(43,data)
(44,if (data < 100)
(45,dest)
(46,data)
(47,)
(48,dataPtr1)
(49,\\\'\\\\0\\\')
(50,dest[data] = \\\'\\\\0\\\')
(51,data)
(52,dataPtr1)
(53,\\\'\\\\0\\\')
(54,1)
(55,printLine(dest)
(56,1)
(57,data = *dataPtr1)
(58,dest[100] = "")
(59,data)
(60,100)
(61,dataPtr2)
(62,data = *dataPtr2)
(63,"")
(64,)
(65,data)
(66,dest)
(67,source)
(68,*dataPtr2)
(69,source[100-1] = \\\'\\\\0\\\')
(70,1)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^