-----label-----
1
-----code-----
void CWE681_Incorrect_Conversion_Between_Numeric_Types__double2int_12_bad()
{
    if(globalReturnsTrueOrFalse())
    {
        {
            char inputBuffer[CHAR_ARRAY_SIZE];
            double doubleNumber = 0;
            /* Enter: 1e20f, result should be 2147483647 (for bad case) */
            if (fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin) != NULL)
            {
                /* Read a double */
                doubleNumber = atof(inputBuffer);
            }
            else
            {
                printLine("fgets() failed.");
            }
            /* FLAW: should not cast without checking if conversion is safe */
            printIntLine((int)doubleNumber);
        }
    }
    else
    {
        {
            char inputBuffer[CHAR_ARRAY_SIZE];
            double doubleNumber = 0;
            /* Enter: 1e-50, result should be 0.0 (for bad case)
             *
             * Note: alternate input
             * 999999999999999999999999999999999999999999999999999999999999999
             */
            if (fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin) != NULL)
            {
                /* Read a double */
                doubleNumber = atof(inputBuffer);
            }
            else
            {
                printLine("fgets() failed.");
            }
            /* FIX: check to make sure conversion is safe */
            if (doubleNumber > INT_MAX || doubleNumber < INT_MIN)
            {
                printLine("Value is too small or large to be represented as an int");
            }
            else
            {
                printIntLine((int)doubleNumber);
            }
        }
    }
}
-----children-----
1,2
1,3
1,4
3,4
5,6
6,7
6,8
6,9
7,8
8,9
10,11
11,12
11,13
11,14
11,15
12,13
13,14
13,15
15,16
15,17
17,18
18,19
20,21
21,22
21,23
23,24
23,25
25,26
27,28
27,29
27,30
28,29
28,30
29,30
29,31
29,32
29,33
30,31
32,33
34,35
36,37
38,39
40,41
41,42
42,43
42,44
43,44
45,46
45,47
46,47
48,49
50,51
51,52
52,53
52,54
53,54
56,57
57,58
57,59
58,59
60,61
60,62
61,62
61,63
64,65
66,67
67,68
67,69
67,70
67,71
68,69
69,70
69,71
71,72
71,73
73,74
74,75
76,77
77,78
77,79
79,80
79,81
81,82
83,84
83,85
83,86
84,85
84,86
85,86
85,87
85,88
85,89
86,87
88,89
90,91
92,93
94,95
96,97
97,98
98,99
98,100
99,100
101,102
101,103
102,103
104,105
106,107
107,108
108,109
108,110
109,110
112,113
112,114
112,115
113,114
113,115
114,115
114,116
115,116
117,118
119,120
119,121
120,121
122,123
124,125
125,126
126,127
126,128
127,128
130,131
131,132
132,133
132,134
133,134
135,136
135,137
136,137
136,138
139,140
-----nextToken-----
2,4,9,14,16,19,22,24,26,31,33,35,37,39,44,47,49,54,55,59,62,63,65,70,72,75,78,80,82,87,89,91,93,95,100,103,105,110,111,116,118,121,123,128,129,134,137,138,140
-----computeFrom-----
28,29
28,30
42,43
42,44
84,85
84,86
98,99
98,100
113,114
113,115
114,115
114,116
119,120
119,121
-----guardedBy-----
33,49
89,105
-----guardedByNegation-----
121,140
-----lastLexicalUse-----
-----jump-----
-----attribute-----
FunctionDefinition;SimpleDeclSpecifier;FunctionDeclarator;Name;CompoundStatement;IfStatement;FunctionCallExpression;IdExpression;Name;CompoundStatement;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;ArrayDeclarator;Name;ArrayModifier;IdExpression;Name;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Name;EqualsInitializer;LiteralExpression;IfStatement;BinaryExpression;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;IdExpression;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;CastExpression;TypeId;SimpleDeclSpecifier;Declarator;IdExpression;Name;CompoundStatement;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;ArrayDeclarator;Name;ArrayModifier;IdExpression;Name;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Name;EqualsInitializer;LiteralExpression;IfStatement;BinaryExpression;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;IdExpression;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;LiteralExpression;IfStatement;BinaryExpression;BinaryExpression;IdExpression;Name;IdExpression;Name;BinaryExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;LiteralExpression;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;CastExpression;TypeId;SimpleDeclSpecifier;Declarator;IdExpression;Name;
-----ast_node-----
void CWE681_Incorrect_Conversion_Between_Numeric_Types__double2int_12_bad(){    if(globalReturnsTrueOrFalse())    {        {            char inputBuffer[CHAR_ARRAY_SIZE];            double doubleNumber = 0;            /* Enter: 1e20f, result should be 2147483647 (for bad case) */            if (fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin) != NULL)            {                /* Read a double */                doubleNumber = atof(inputBuffer);            }            else            {                printLine("fgets() failed.");            }            /* FLAW: should not cast without checking if conversion is safe */            printIntLine((int)doubleNumber);        }    }    else    {        {            char inputBuffer[CHAR_ARRAY_SIZE];            double doubleNumber = 0;            /* Enter: 1e-50, result should be 0.0 (for bad case)             *             * Note: alternate input             * 999999999999999999999999999999999999999999999999999999999999999             */            if (fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin) != NULL)            {                /* Read a double */                doubleNumber = atof(inputBuffer);            }            else            {                printLine("fgets() failed.");            }            /* FIX: check to make sure conversion is safe */            if (doubleNumber > INT_MAX || doubleNumber < INT_MIN)            {                printLine("Value is too small or large to be represented as an int");            }            else            {                printIntLine((int)doubleNumber);            }        }    }}
void
CWE681_Incorrect_Conversion_Between_Numeric_Types__double2int_12_bad()
CWE681_Incorrect_Conversion_Between_Numeric_Types__double2int_12_bad
{    if(globalReturnsTrueOrFalse())    {        {            char inputBuffer[CHAR_ARRAY_SIZE];            double doubleNumber = 0;            /* Enter: 1e20f, result should be 2147483647 (for bad case) */            if (fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin) != NULL)            {                /* Read a double */                doubleNumber = atof(inputBuffer);            }            else            {                printLine("fgets() failed.");            }            /* FLAW: should not cast without checking if conversion is safe */            printIntLine((int)doubleNumber);        }    }    else    {        {            char inputBuffer[CHAR_ARRAY_SIZE];            double doubleNumber = 0;            /* Enter: 1e-50, result should be 0.0 (for bad case)             *             * Note: alternate input             * 999999999999999999999999999999999999999999999999999999999999999             */            if (fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin) != NULL)            {                /* Read a double */                doubleNumber = atof(inputBuffer);            }            else            {                printLine("fgets() failed.");            }            /* FIX: check to make sure conversion is safe */            if (doubleNumber > INT_MAX || doubleNumber < INT_MIN)            {                printLine("Value is too small or large to be represented as an int");            }            else            {                printIntLine((int)doubleNumber);            }        }    }}
if(globalReturnsTrueOrFalse())    {        {            char inputBuffer[CHAR_ARRAY_SIZE];            double doubleNumber = 0;            /* Enter: 1e20f, result should be 2147483647 (for bad case) */            if (fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin) != NULL)            {                /* Read a double */                doubleNumber = atof(inputBuffer);            }            else            {                printLine("fgets() failed.");            }            /* FLAW: should not cast without checking if conversion is safe */            printIntLine((int)doubleNumber);        }    }    else    {        {            char inputBuffer[CHAR_ARRAY_SIZE];            double doubleNumber = 0;            /* Enter: 1e-50, result should be 0.0 (for bad case)             *             * Note: alternate input             * 999999999999999999999999999999999999999999999999999999999999999             */            if (fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin) != NULL)            {                /* Read a double */                doubleNumber = atof(inputBuffer);            }            else            {                printLine("fgets() failed.");            }            /* FIX: check to make sure conversion is safe */            if (doubleNumber > INT_MAX || doubleNumber < INT_MIN)            {                printLine("Value is too small or large to be represented as an int");            }            else            {                printIntLine((int)doubleNumber);            }        }    }
globalReturnsTrueOrFalse()
globalReturnsTrueOrFalse
globalReturnsTrueOrFalse
{        {            char inputBuffer[CHAR_ARRAY_SIZE];            double doubleNumber = 0;            /* Enter: 1e20f, result should be 2147483647 (for bad case) */            if (fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin) != NULL)            {                /* Read a double */                doubleNumber = atof(inputBuffer);            }            else            {                printLine("fgets() failed.");            }            /* FLAW: should not cast without checking if conversion is safe */            printIntLine((int)doubleNumber);        }    }
{            char inputBuffer[CHAR_ARRAY_SIZE];            double doubleNumber = 0;            /* Enter: 1e20f, result should be 2147483647 (for bad case) */            if (fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin) != NULL)            {                /* Read a double */                doubleNumber = atof(inputBuffer);            }            else            {                printLine("fgets() failed.");            }            /* FLAW: should not cast without checking if conversion is safe */            printIntLine((int)doubleNumber);        }
char inputBuffer[CHAR_ARRAY_SIZE];
char inputBuffer[CHAR_ARRAY_SIZE];
char
inputBuffer[CHAR_ARRAY_SIZE]
inputBuffer
[CHAR_ARRAY_SIZE]
CHAR_ARRAY_SIZE
CHAR_ARRAY_SIZE
double doubleNumber = 0;
double doubleNumber = 0;
double
doubleNumber = 0
doubleNumber
= 0
0
if (fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin) != NULL)            {                /* Read a double */                doubleNumber = atof(inputBuffer);            }            else            {                printLine("fgets() failed.");            }
fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin) != NULL
fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin)
fgets
fgets
inputBuffer
inputBuffer
CHAR_ARRAY_SIZE
CHAR_ARRAY_SIZE
stdin
stdin
NULL
NULL
{                /* Read a double */                doubleNumber = atof(inputBuffer);            }
doubleNumber = atof(inputBuffer);
doubleNumber = atof(inputBuffer)
doubleNumber
doubleNumber
atof(inputBuffer)
atof
atof
inputBuffer
inputBuffer
{                printLine("fgets() failed.");            }
printLine("fgets() failed.");
printLine("fgets() failed.")
printLine
printLine
"fgets() failed."
printIntLine((int)doubleNumber);
printIntLine((int)doubleNumber)
printIntLine
printIntLine
(int)doubleNumber
int
int

doubleNumber
doubleNumber
{        {            char inputBuffer[CHAR_ARRAY_SIZE];            double doubleNumber = 0;            /* Enter: 1e-50, result should be 0.0 (for bad case)             *             * Note: alternate input             * 999999999999999999999999999999999999999999999999999999999999999             */            if (fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin) != NULL)            {                /* Read a double */                doubleNumber = atof(inputBuffer);            }            else            {                printLine("fgets() failed.");            }            /* FIX: check to make sure conversion is safe */            if (doubleNumber > INT_MAX || doubleNumber < INT_MIN)            {                printLine("Value is too small or large to be represented as an int");            }            else            {                printIntLine((int)doubleNumber);            }        }    }
{            char inputBuffer[CHAR_ARRAY_SIZE];            double doubleNumber = 0;            /* Enter: 1e-50, result should be 0.0 (for bad case)             *             * Note: alternate input             * 999999999999999999999999999999999999999999999999999999999999999             */            if (fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin) != NULL)            {                /* Read a double */                doubleNumber = atof(inputBuffer);            }            else            {                printLine("fgets() failed.");            }            /* FIX: check to make sure conversion is safe */            if (doubleNumber > INT_MAX || doubleNumber < INT_MIN)            {                printLine("Value is too small or large to be represented as an int");            }            else            {                printIntLine((int)doubleNumber);            }        }
char inputBuffer[CHAR_ARRAY_SIZE];
char inputBuffer[CHAR_ARRAY_SIZE];
char
inputBuffer[CHAR_ARRAY_SIZE]
inputBuffer
[CHAR_ARRAY_SIZE]
CHAR_ARRAY_SIZE
CHAR_ARRAY_SIZE
double doubleNumber = 0;
double doubleNumber = 0;
double
doubleNumber = 0
doubleNumber
= 0
0
if (fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin) != NULL)            {                /* Read a double */                doubleNumber = atof(inputBuffer);            }            else            {                printLine("fgets() failed.");            }
fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin) != NULL
fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin)
fgets
fgets
inputBuffer
inputBuffer
CHAR_ARRAY_SIZE
CHAR_ARRAY_SIZE
stdin
stdin
NULL
NULL
{                /* Read a double */                doubleNumber = atof(inputBuffer);            }
doubleNumber = atof(inputBuffer);
doubleNumber = atof(inputBuffer)
doubleNumber
doubleNumber
atof(inputBuffer)
atof
atof
inputBuffer
inputBuffer
{                printLine("fgets() failed.");            }
printLine("fgets() failed.");
printLine("fgets() failed.")
printLine
printLine
"fgets() failed."
if (doubleNumber > INT_MAX || doubleNumber < INT_MIN)            {                printLine("Value is too small or large to be represented as an int");            }            else            {                printIntLine((int)doubleNumber);            }
doubleNumber > INT_MAX || doubleNumber < INT_MIN
doubleNumber > INT_MAX
doubleNumber
doubleNumber
INT_MAX
INT_MAX
doubleNumber < INT_MIN
doubleNumber
doubleNumber
INT_MIN
INT_MIN
{                printLine("Value is too small or large to be represented as an int");            }
printLine("Value is too small or large to be represented as an int");
printLine("Value is too small or large to be represented as an int")
printLine
printLine
"Value is too small or large to be represented as an int"
{                printIntLine((int)doubleNumber);            }
printIntLine((int)doubleNumber);
printIntLine((int)doubleNumber)
printIntLine
printIntLine
(int)doubleNumber
int
int

doubleNumber
doubleNumber
-----joern-----
(44,22,0)
(16,21,0)
(32,24,0)
(7,17,0)
(16,11,0)
(11,35,0)
(40,67,0)
(53,24,0)
(12,10,0)
(42,62,0)
(45,63,0)
(39,35,0)
(6,16,0)
(24,62,0)
(46,60,0)
(13,62,0)
(21,17,0)
(60,46,0)
(5,2,0)
(0,64,0)
(15,42,0)
(62,49,0)
(61,58,0)
(25,13,0)
(2,18,0)
(54,47,0)
(47,54,0)
(31,67,0)
(1,35,0)
(21,30,0)
(47,67,0)
(66,60,0)
(34,64,0)
(38,47,0)
(20,44,0)
(9,24,0)
(64,63,0)
(56,11,0)
(28,16,0)
(55,60,0)
(19,47,0)
(47,38,0)
(52,21,0)
(35,57,0)
(62,42,0)
(24,32,0)
(17,21,0)
(24,67,0)
(29,12,0)
(23,16,0)
(41,64,0)
(3,2,0)
(63,64,0)
(51,2,0)
(16,6,0)
(23,35,0)
(67,2,0)
(47,62,0)
(33,13,0)
(8,60,0)
(43,46,0)
(54,36,0)
(50,62,0)
(13,67,0)
(48,35,0)
(13,32,0)
(58,4,0)
(37,26,0)
(65,2,0)
(32,13,0)
(16,23,0)
(14,11,0)
(54,47,1)
(42,15,1)
(34,0,1)
(29,63,1)
(53,9,1)
(67,40,1)
(24,53,1)
(19,32,1)
(60,55,1)
(28,21,1)
(31,59,1)
(15,50,1)
(9,62,1)
(32,13,1)
(44,20,1)
(27,54,1)
(24,62,1)
(55,8,1)
(33,25,1)
(45,64,1)
(63,45,1)
(66,11,1)
(13,33,1)
(47,19,1)
(47,62,1)
(40,31,1)
(20,46,1)
(0,67,1)
(52,46,1)
(32,24,1)
(56,59,1)
(12,29,1)
(58,61,1)
(63,64,1)
(23,16,1)
(25,24,1)
(61,32,1)
(7,52,1)
(9,12,1)
(47,38,1)
(47,67,1)
(62,42,1)
(13,67,1)
(28,44,1)
(64,41,1)
(16,21,1)
(27,23,1)
(21,17,1)
(24,67,1)
(14,56,1)
(41,34,1)
(11,14,1)
(43,60,1)
(13,62,1)
(16,11,1)
(50,63,1)
(17,7,1)
(8,66,1)
(27,58,1)
(16,6,1)
(46,43,1)
(16,28,1)
(46,60,1)
(16,6,2)
(62,63,2)
(54,32,2)
(52,46,2)
(32,59,2)
(55,59,2)
(24,67,2)
(14,59,2)
(13,24,2)
(11,59,2)
(43,59,2)
(16,11,2)
(40,59,2)
(62,42,2)
(17,46,2)
(8,59,2)
(12,63,2)
(45,59,2)
(47,62,2)
(61,32,2)
(13,62,2)
(64,59,2)
(21,17,2)
(32,13,2)
(24,59,2)
(63,64,2)
(25,24,2)
(63,59,2)
(31,59,2)
(47,38,2)
(56,59,2)
(42,63,2)
(60,59,2)
(7,46,2)
(19,32,2)
(28,59,2)
(54,47,2)
(13,67,2)
(53,59,2)
(33,24,2)
(44,46,2)
(20,46,2)
(58,32,2)
(16,21,2)
(21,46,2)
(0,59,2)
(67,59,2)
(24,62,2)
(15,63,2)
(41,59,2)
(50,63,2)
(66,59,2)
(29,63,2)
(16,59,2)
(47,67,2)
(47,32,2)
(46,59,2)
(32,24,2)
(46,60,2)
(23,59,2)
(34,59,2)
(9,59,2)
(23,16,2)
-----------------------------------
(0,inputBuffer)
(1,inputBuffer)
(2,)
(3,inputBuffer)
(4,)
(5,if (fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin)
(6,int)
(7,inputBuffer)
(8,CHAR_ARRAY_SIZE)
(9,doubleNumber)
(10,)
(11,doubleNumber = 0)
(12,printLine("fgets()
(13,doubleNumber < INT_MIN)
(14,0)
(15,inputBuffer)
(16,(int)
(17,atof(inputBuffer)
(18,)
(19,doubleNumber)
(20,"fgets()
(21,doubleNumber = atof(inputBuffer)
(22,)
(23,printIntLine((int)
(24,doubleNumber > INT_MAX)
(25,doubleNumber)
(26,)
(27,RET)
(28,doubleNumber)
(29,"fgets()
(30,)
(31,doubleNumber)
(32,doubleNumber > INT_MAX || doubleNumber < INT_MIN)
(33,INT_MIN)
(34,CHAR_ARRAY_SIZE)
(35,)
(36,)
(37,if(globalReturnsTrueOrFalse()
(38,int)
(39,doubleNumber)
(40,0)
(41,stdin)
(42,atof(inputBuffer)
(43,NULL)
(44,printLine("fgets()
(45,NULL)
(46,fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin)
(47,(int)
(48,if (fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin)
(49,)
(50,doubleNumber)
(51,if (doubleNumber > INT_MAX || doubleNumber < INT_MIN)
(52,doubleNumber)
(53,INT_MAX)
(54,printIntLine((int)
(55,stdin)
(56,doubleNumber)
(57,)
(58,printLine("Value is too small or large to be represented as an int")
(59,globalReturnsTrueOrFalse()
(60,fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin)
(61,"Value is too small or large to be represented as an int")
(62,doubleNumber = atof(inputBuffer)
(63,fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin)
(64,fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin)
(65,doubleNumber)
(66,inputBuffer)
(67,doubleNumber = 0)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^