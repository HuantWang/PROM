-----label-----
1
-----code-----
void CWE195_Signed_to_Unsigned_Conversion_Error__fscanf_strncpy_32_bad()
{
    int data;
    int *dataPtr1 = &data;
    int *dataPtr2 = &data;
    /* Initialize data */
    data = -1;
    {
        int data = *dataPtr1;
        /* POTENTIAL FLAW: Read data from the console using fscanf() */
        fscanf(stdin, "%d", &data);
        *dataPtr1 = data;
    }
    {
        int data = *dataPtr2;
        {
            char source[100];
            char dest[100] = "";
            memset(source, 'A', 100-1);
            source[100-1] = '\0';
            if (data < 100)
            {
                /* POTENTIAL FLAW: data is interpreted as an unsigned int - if its value is negative,
                 * the sign conversion could result in a very large number */
                strncpy(dest, source, data);
                dest[data] = '\0'; /* strncpy() does not always NULL terminate */
            }
            printLine(dest);
        }
    }
}
-----children-----
1,2
1,3
1,4
3,4
5,6
5,7
5,8
5,9
5,10
5,11
6,7
7,8
7,9
9,10
11,12
12,13
12,14
14,15
14,16
14,17
17,18
18,19
19,20
21,22
22,23
22,24
24,25
24,26
24,27
27,28
28,29
29,30
31,32
32,33
32,34
33,34
35,36
37,38
37,39
37,40
38,39
39,40
39,41
41,42
41,43
43,44
44,45
45,46
47,48
48,49
48,50
48,51
48,52
49,50
51,52
54,55
55,56
57,58
58,59
58,60
59,60
60,61
62,63
64,65
64,66
65,66
66,67
66,68
68,69
68,70
70,71
71,72
72,73
74,75
74,76
74,77
74,78
74,79
74,80
75,76
76,77
76,78
78,79
78,80
80,81
82,83
83,84
83,85
85,86
85,87
85,88
87,88
89,90
91,92
92,93
92,94
92,95
92,96
93,94
95,96
98,99
98,100
101,102
102,103
102,104
103,104
103,105
104,105
106,107
106,108
110,111
110,112
111,112
111,113
112,113
115,116
115,117
116,117
117,118
117,119
117,120
117,121
118,119
120,121
122,123
124,125
126,127
127,128
127,129
128,129
128,130
129,130
131,132
134,135
135,136
135,137
136,137
138,139
-----nextToken-----
2,4,8,10,13,15,16,20,23,25,26,30,34,36,40,42,46,50,52,53,56,61,63,67,69,73,77,79,81,84,86,88,90,94,96,97,99,100,105,107,108,109,113,114,119,121,123,125,130,132,133,137,139
-----computeFrom-----
32,33
32,34
58,59
58,60
98,99
98,100
102,103
102,104
106,107
106,108
111,112
111,113
127,128
127,129
-----guardedBy-----
113,132
-----guardedByNegation-----
-----lastLexicalUse-----
-----jump-----
-----attribute-----
FunctionDefinition;SimpleDeclSpecifier;FunctionDeclarator;Name;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Name;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Pointer;Name;EqualsInitializer;UnaryExpression;IdExpression;Name;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Pointer;Name;EqualsInitializer;UnaryExpression;IdExpression;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;UnaryExpression;LiteralExpression;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Name;EqualsInitializer;UnaryExpression;IdExpression;Name;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;LiteralExpression;UnaryExpression;IdExpression;Name;ExpressionStatement;BinaryExpression;UnaryExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Name;EqualsInitializer;UnaryExpression;IdExpression;Name;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;ArrayDeclarator;Name;ArrayModifier;LiteralExpression;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;ArrayDeclarator;Name;ArrayModifier;LiteralExpression;EqualsInitializer;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;LiteralExpression;BinaryExpression;LiteralExpression;LiteralExpression;ExpressionStatement;BinaryExpression;ArraySubscriptExpression;IdExpression;Name;BinaryExpression;LiteralExpression;LiteralExpression;LiteralExpression;IfStatement;BinaryExpression;IdExpression;Name;LiteralExpression;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;IdExpression;Name;ExpressionStatement;BinaryExpression;ArraySubscriptExpression;IdExpression;Name;IdExpression;Name;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;
-----ast_node-----
void CWE195_Signed_to_Unsigned_Conversion_Error__fscanf_strncpy_32_bad(){    int data;    int *dataPtr1 = &data;    int *dataPtr2 = &data;    /* Initialize data */    data = -1;    {        int data = *dataPtr1;        /* POTENTIAL FLAW: Read data from the console using fscanf() */        fscanf(stdin, "%d", &data);        *dataPtr1 = data;    }    {        int data = *dataPtr2;        {            char source[100];            char dest[100] = "";            memset(source, 'A', 100-1);            source[100-1] = '\0';            if (data < 100)            {                /* POTENTIAL FLAW: data is interpreted as an unsigned int - if its value is negative,                 * the sign conversion could result in a very large number */                strncpy(dest, source, data);                dest[data] = '\0'; /* strncpy() does not always NULL terminate */            }            printLine(dest);        }    }}
void
CWE195_Signed_to_Unsigned_Conversion_Error__fscanf_strncpy_32_bad()
CWE195_Signed_to_Unsigned_Conversion_Error__fscanf_strncpy_32_bad
{    int data;    int *dataPtr1 = &data;    int *dataPtr2 = &data;    /* Initialize data */    data = -1;    {        int data = *dataPtr1;        /* POTENTIAL FLAW: Read data from the console using fscanf() */        fscanf(stdin, "%d", &data);        *dataPtr1 = data;    }    {        int data = *dataPtr2;        {            char source[100];            char dest[100] = "";            memset(source, 'A', 100-1);            source[100-1] = '\0';            if (data < 100)            {                /* POTENTIAL FLAW: data is interpreted as an unsigned int - if its value is negative,                 * the sign conversion could result in a very large number */                strncpy(dest, source, data);                dest[data] = '\0'; /* strncpy() does not always NULL terminate */            }            printLine(dest);        }    }}
int data;
int data;
int
data
data
int *dataPtr1 = &data;
int *dataPtr1 = &data;
int
*dataPtr1 = &data
*
dataPtr1
= &data
&data
data
data
int *dataPtr2 = &data;
int *dataPtr2 = &data;
int
*dataPtr2 = &data
*
dataPtr2
= &data
&data
data
data
data = -1;
data = -1
data
data
-1
1
{        int data = *dataPtr1;        /* POTENTIAL FLAW: Read data from the console using fscanf() */        fscanf(stdin, "%d", &data);        *dataPtr1 = data;    }
int data = *dataPtr1;
int data = *dataPtr1;
int
data = *dataPtr1
data
= *dataPtr1
*dataPtr1
dataPtr1
dataPtr1
fscanf(stdin, "%d", &data);
fscanf(stdin, "%d", &data)
fscanf
fscanf
stdin
stdin
"%d"
&data
data
data
*dataPtr1 = data;
*dataPtr1 = data
*dataPtr1
dataPtr1
dataPtr1
data
data
{        int data = *dataPtr2;        {            char source[100];            char dest[100] = "";            memset(source, 'A', 100-1);            source[100-1] = '\0';            if (data < 100)            {                /* POTENTIAL FLAW: data is interpreted as an unsigned int - if its value is negative,                 * the sign conversion could result in a very large number */                strncpy(dest, source, data);                dest[data] = '\0'; /* strncpy() does not always NULL terminate */            }            printLine(dest);        }    }
int data = *dataPtr2;
int data = *dataPtr2;
int
data = *dataPtr2
data
= *dataPtr2
*dataPtr2
dataPtr2
dataPtr2
{            char source[100];            char dest[100] = "";            memset(source, 'A', 100-1);            source[100-1] = '\0';            if (data < 100)            {                /* POTENTIAL FLAW: data is interpreted as an unsigned int - if its value is negative,                 * the sign conversion could result in a very large number */                strncpy(dest, source, data);                dest[data] = '\0'; /* strncpy() does not always NULL terminate */            }            printLine(dest);        }
char source[100];
char source[100];
char
source[100]
source
[100]
100
char dest[100] = "";
char dest[100] = "";
char
dest[100] = ""
dest
[100]
100
= ""
""
memset(source, 'A', 100-1);
memset(source, 'A', 100-1)
memset
memset
source
source
'A'
100-1
100
1
source[100-1] = '\0';
source[100-1] = '\0'
source[100-1]
source
source
100-1
100
1
'\0'
if (data < 100)            {                /* POTENTIAL FLAW: data is interpreted as an unsigned int - if its value is negative,                 * the sign conversion could result in a very large number */                strncpy(dest, source, data);                dest[data] = '\0'; /* strncpy() does not always NULL terminate */            }
data < 100
data
data
100
{                /* POTENTIAL FLAW: data is interpreted as an unsigned int - if its value is negative,                 * the sign conversion could result in a very large number */                strncpy(dest, source, data);                dest[data] = '\0'; /* strncpy() does not always NULL terminate */            }
strncpy(dest, source, data);
strncpy(dest, source, data)
strncpy
strncpy
dest
dest
source
source
data
data
dest[data] = '\0';
dest[data] = '\0'
dest[data]
dest
dest
data
data
'\0'
printLine(dest);
printLine(dest)
printLine
printLine
dest
dest
-----joern-----
(63,65,0)
(16,28,0)
(36,28,0)
(19,38,0)
(4,48,0)
(50,63,0)
(10,27,0)
(7,57,0)
(54,46,0)
(69,4,0)
(10,48,0)
(15,65,0)
(5,22,0)
(33,36,0)
(30,57,0)
(20,0,0)
(26,64,0)
(52,22,0)
(56,66,0)
(65,15,0)
(58,28,0)
(66,47,0)
(0,41,0)
(18,36,0)
(2,38,0)
(60,36,0)
(65,38,0)
(21,48,0)
(47,66,0)
(0,28,0)
(67,38,0)
(64,49,0)
(3,44,0)
(59,65,0)
(72,46,0)
(12,67,0)
(49,64,0)
(43,47,0)
(70,67,0)
(13,23,0)
(17,46,0)
(16,0,0)
(41,0,0)
(17,5,0)
(57,3,0)
(6,64,0)
(57,46,0)
(72,44,0)
(1,3,0)
(63,16,0)
(62,38,0)
(35,46,0)
(49,5,0)
(29,32,0)
(24,5,0)
(32,5,0)
(46,5,0)
(57,48,0)
(51,41,0)
(72,48,0)
(55,27,0)
(60,0,0)
(40,72,0)
(27,23,0)
(8,66,0)
(67,12,0)
(45,60,0)
(68,15,0)
(28,38,0)
(23,27,0)
(53,4,0)
(61,72,0)
(48,22,0)
(36,60,0)
(9,5,0)
(14,72,0)
(31,10,0)
(41,65,0)
(47,32,0)
(34,12,0)
(39,5,0)
(48,10,0)
(22,38,0)
(42,17,0)
(37,49,0)
(11,49,0)
(27,38,0)
(71,16,0)
(41,51,1)
(17,42,1)
(10,27,1)
(26,11,1)
(65,15,1)
(31,21,1)
(16,71,1)
(7,30,1)
(68,59,1)
(40,14,1)
(72,40,1)
(21,16,1)
(14,61,1)
(17,46,1)
(42,3,1)
(3,1,1)
(20,67,1)
(51,20,1)
(57,48,1)
(4,48,1)
(50,36,1)
(16,0,1)
(49,64,1)
(11,37,1)
(4,53,1)
(60,45,1)
(55,65,1)
(41,65,1)
(13,55,1)
(46,54,1)
(18,0,1)
(34,70,1)
(29,47,1)
(47,66,1)
(30,72,1)
(63,65,1)
(63,50,1)
(45,33,1)
(33,18,1)
(37,46,1)
(0,41,1)
(1,57,1)
(8,56,1)
(35,48,1)
(48,10,1)
(60,0,1)
(54,35,1)
(27,23,1)
(71,63,1)
(53,69,1)
(67,12,1)
(66,8,1)
(42,4,1)
(64,6,1)
(72,46,1)
(32,29,1)
(72,48,1)
(61,4,1)
(12,34,1)
(69,32,1)
(36,60,1)
(25,17,1)
(56,43,1)
(57,46,1)
(6,26,1)
(43,49,1)
(23,13,1)
(70,27,1)
(57,7,1)
(10,31,1)
(15,68,1)
(72,46,2)
(72,48,2)
(7,4,2)
(36,60,2)
(60,0,2)
(16,0,2)
(49,64,2)
(61,4,2)
(14,4,2)
(30,4,2)
(0,41,2)
(10,27,2)
(1,4,2)
(47,66,2)
(57,46,2)
(67,12,2)
(3,4,2)
(40,4,2)
(57,4,2)
(27,23,2)
(41,65,2)
(17,46,2)
(4,48,2)
(72,4,2)
(57,48,2)
(48,10,2)
(63,65,2)
(65,15,2)
-----------------------------------
(0,data = *dataPtr1)
(1,\\\'\\\\0\\\')
(2,dataPtr2)
(3,dest[data] = \\\'\\\\0\\\')
(4,data < 100)
(5,)
(6,1)
(7,data)
(8,1)
(9,source)
(10,*dataPtr2)
(11,\\\'A\\\')
(12,-1)
(13,data)
(14,source)
(15,&data)
(16,*dataPtr1 = data)
(17,printLine(dest)
(18,stdin)
(19,dataPtr1)
(20,data)
(21,data)
(22,)
(23,&data)
(24,if (data < 100)
(25,RET)
(26,100)
(27,*dataPtr2 = &data)
(28,)
(29,\\\'\\\\0\\\')
(30,dest)
(31,dataPtr2)
(32,source[100-1] = \\\'\\\\0\\\')
(33,"%d")
(34,1)
(35,dest)
(36,fscanf(stdin, "%d", &data)
(37,source)
(38,)
(39,dest)
(40,data)
(41,*dataPtr1)
(42,dest)
(43,source)
(44,)
(45,data)
(46,dest[100] = "")
(47,source[100-1])
(48,data = *dataPtr2)
(49,memset(source, \\\'A\\\', 100-1)
(50,dataPtr1)
(51,dataPtr1)
(52,data)
(53,100)
(54,"")
(55,dataPtr2)
(56,100)
(57,dest[data])
(58,data)
(59,dataPtr1)
(60,&data)
(61,dest)
(62,data)
(63,*dataPtr1)
(64,100-1)
(65,*dataPtr1 = &data)
(66,100-1)
(67,data = -1)
(68,data)
(69,data)
(70,data)
(71,data)
(72,strncpy(dest, source, data)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^