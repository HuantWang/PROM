-----label-----
1
-----code-----
void CWE195_Signed_to_Unsigned_Conversion_Error__fgets_strncpy_32_bad()
{
    int data;
    int *dataPtr1 = &data;
    int *dataPtr2 = &data;
    /* Initialize data */
    data = -1;
    {
        int data = *dataPtr1;
        {
            char inputBuffer[CHAR_ARRAY_SIZE] = "";
            /* POTENTIAL FLAW: Read data from the console using fgets() */
            if (fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin) != NULL)
            {
                /* Convert to int */
                data = atoi(inputBuffer);
            }
            else
            {
                printLine("fgets() failed.");
            }
        }
        *dataPtr1 = data;
    }
    {
        int data = *dataPtr2;
        {
            char source[100];
            char dest[100] = "";
            memset(source, 'A', 100-1);
            source[100-1] = '\0';
            if (data < 100)
            {
                /* POTENTIAL FLAW: data is interpreted as an unsigned int - if its value is negative,
                 * the sign conversion could result in a very large number */
                strncpy(dest, source, data);
                dest[data] = '\0'; /* strncpy() does not always NULL terminate */
            }
            printLine(dest);
        }
    }
}
-----children-----
1,2
1,3
1,4
3,4
5,6
5,7
5,8
5,9
5,10
5,11
6,7
7,8
7,9
9,10
11,12
12,13
12,14
14,15
14,16
14,17
17,18
18,19
19,20
21,22
22,23
22,24
24,25
24,26
24,27
27,28
28,29
29,30
31,32
32,33
32,34
33,34
35,36
37,38
37,39
37,40
38,39
39,40
39,41
41,42
41,43
43,44
44,45
45,46
47,48
47,49
48,49
49,50
49,51
51,52
51,53
51,54
53,54
54,55
56,57
58,59
58,60
58,61
59,60
59,61
60,61
60,62
60,63
60,64
61,62
63,64
65,66
67,68
69,70
71,72
72,73
73,74
73,75
74,75
76,77
76,78
77,78
79,80
81,82
82,83
83,84
83,85
84,85
87,88
88,89
88,90
89,90
90,91
92,93
94,95
94,96
95,96
96,97
96,98
98,99
98,100
100,101
101,102
102,103
104,105
104,106
104,107
104,108
104,109
104,110
105,106
106,107
106,108
108,109
108,110
110,111
112,113
113,114
113,115
115,116
115,117
115,118
117,118
119,120
121,122
122,123
122,124
122,125
122,126
123,124
125,126
128,129
128,130
131,132
132,133
132,134
133,134
133,135
134,135
136,137
136,138
140,141
140,142
141,142
141,143
142,143
145,146
145,147
146,147
147,148
147,149
147,150
147,151
148,149
150,151
152,153
154,155
156,157
157,158
157,159
158,159
158,160
159,160
161,162
164,165
165,166
165,167
166,167
168,169
-----nextToken-----
2,4,8,10,13,15,16,20,23,25,26,30,34,36,40,42,46,50,52,55,57,62,64,66,68,70,75,78,80,85,86,91,93,97,99,103,107,109,111,114,116,118,120,124,126,127,129,130,135,137,138,139,143,144,149,151,153,155,160,162,163,167,169
-----computeFrom-----
32,33
32,34
59,60
59,61
73,74
73,75
88,89
88,90
128,129
128,130
132,133
132,134
136,137
136,138
141,142
141,143
157,158
157,159
-----guardedBy-----
64,80
143,162
-----guardedByNegation-----
-----lastLexicalUse-----
-----jump-----
-----attribute-----
FunctionDefinition;SimpleDeclSpecifier;FunctionDeclarator;Name;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Name;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Pointer;Name;EqualsInitializer;UnaryExpression;IdExpression;Name;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Pointer;Name;EqualsInitializer;UnaryExpression;IdExpression;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;UnaryExpression;LiteralExpression;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Name;EqualsInitializer;UnaryExpression;IdExpression;Name;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;ArrayDeclarator;Name;ArrayModifier;IdExpression;Name;EqualsInitializer;LiteralExpression;IfStatement;BinaryExpression;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;IdExpression;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;BinaryExpression;IdExpression;Name;FunctionCallExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;LiteralExpression;ExpressionStatement;BinaryExpression;UnaryExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Name;EqualsInitializer;UnaryExpression;IdExpression;Name;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;ArrayDeclarator;Name;ArrayModifier;LiteralExpression;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;ArrayDeclarator;Name;ArrayModifier;LiteralExpression;EqualsInitializer;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;LiteralExpression;BinaryExpression;LiteralExpression;LiteralExpression;ExpressionStatement;BinaryExpression;ArraySubscriptExpression;IdExpression;Name;BinaryExpression;LiteralExpression;LiteralExpression;LiteralExpression;IfStatement;BinaryExpression;IdExpression;Name;LiteralExpression;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;IdExpression;Name;ExpressionStatement;BinaryExpression;ArraySubscriptExpression;IdExpression;Name;IdExpression;Name;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;
-----ast_node-----
void CWE195_Signed_to_Unsigned_Conversion_Error__fgets_strncpy_32_bad(){    int data;    int *dataPtr1 = &data;    int *dataPtr2 = &data;    /* Initialize data */    data = -1;    {        int data = *dataPtr1;        {            char inputBuffer[CHAR_ARRAY_SIZE] = "";            /* POTENTIAL FLAW: Read data from the console using fgets() */            if (fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin) != NULL)            {                /* Convert to int */                data = atoi(inputBuffer);            }            else            {                printLine("fgets() failed.");            }        }        *dataPtr1 = data;    }    {        int data = *dataPtr2;        {            char source[100];            char dest[100] = "";            memset(source, 'A', 100-1);            source[100-1] = '\0';            if (data < 100)            {                /* POTENTIAL FLAW: data is interpreted as an unsigned int - if its value is negative,                 * the sign conversion could result in a very large number */                strncpy(dest, source, data);                dest[data] = '\0'; /* strncpy() does not always NULL terminate */            }            printLine(dest);        }    }}
void
CWE195_Signed_to_Unsigned_Conversion_Error__fgets_strncpy_32_bad()
CWE195_Signed_to_Unsigned_Conversion_Error__fgets_strncpy_32_bad
{    int data;    int *dataPtr1 = &data;    int *dataPtr2 = &data;    /* Initialize data */    data = -1;    {        int data = *dataPtr1;        {            char inputBuffer[CHAR_ARRAY_SIZE] = "";            /* POTENTIAL FLAW: Read data from the console using fgets() */            if (fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin) != NULL)            {                /* Convert to int */                data = atoi(inputBuffer);            }            else            {                printLine("fgets() failed.");            }        }        *dataPtr1 = data;    }    {        int data = *dataPtr2;        {            char source[100];            char dest[100] = "";            memset(source, 'A', 100-1);            source[100-1] = '\0';            if (data < 100)            {                /* POTENTIAL FLAW: data is interpreted as an unsigned int - if its value is negative,                 * the sign conversion could result in a very large number */                strncpy(dest, source, data);                dest[data] = '\0'; /* strncpy() does not always NULL terminate */            }            printLine(dest);        }    }}
int data;
int data;
int
data
data
int *dataPtr1 = &data;
int *dataPtr1 = &data;
int
*dataPtr1 = &data
*
dataPtr1
= &data
&data
data
data
int *dataPtr2 = &data;
int *dataPtr2 = &data;
int
*dataPtr2 = &data
*
dataPtr2
= &data
&data
data
data
data = -1;
data = -1
data
data
-1
1
{        int data = *dataPtr1;        {            char inputBuffer[CHAR_ARRAY_SIZE] = "";            /* POTENTIAL FLAW: Read data from the console using fgets() */            if (fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin) != NULL)            {                /* Convert to int */                data = atoi(inputBuffer);            }            else            {                printLine("fgets() failed.");            }        }        *dataPtr1 = data;    }
int data = *dataPtr1;
int data = *dataPtr1;
int
data = *dataPtr1
data
= *dataPtr1
*dataPtr1
dataPtr1
dataPtr1
{            char inputBuffer[CHAR_ARRAY_SIZE] = "";            /* POTENTIAL FLAW: Read data from the console using fgets() */            if (fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin) != NULL)            {                /* Convert to int */                data = atoi(inputBuffer);            }            else            {                printLine("fgets() failed.");            }        }
char inputBuffer[CHAR_ARRAY_SIZE] = "";
char inputBuffer[CHAR_ARRAY_SIZE] = "";
char
inputBuffer[CHAR_ARRAY_SIZE] = ""
inputBuffer
[CHAR_ARRAY_SIZE]
CHAR_ARRAY_SIZE
CHAR_ARRAY_SIZE
= ""
""
if (fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin) != NULL)            {                /* Convert to int */                data = atoi(inputBuffer);            }            else            {                printLine("fgets() failed.");            }
fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin) != NULL
fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin)
fgets
fgets
inputBuffer
inputBuffer
CHAR_ARRAY_SIZE
CHAR_ARRAY_SIZE
stdin
stdin
NULL
NULL
{                /* Convert to int */                data = atoi(inputBuffer);            }
data = atoi(inputBuffer);
data = atoi(inputBuffer)
data
data
atoi(inputBuffer)
atoi
atoi
inputBuffer
inputBuffer
{                printLine("fgets() failed.");            }
printLine("fgets() failed.");
printLine("fgets() failed.")
printLine
printLine
"fgets() failed."
*dataPtr1 = data;
*dataPtr1 = data
*dataPtr1
dataPtr1
dataPtr1
data
data
{        int data = *dataPtr2;        {            char source[100];            char dest[100] = "";            memset(source, 'A', 100-1);            source[100-1] = '\0';            if (data < 100)            {                /* POTENTIAL FLAW: data is interpreted as an unsigned int - if its value is negative,                 * the sign conversion could result in a very large number */                strncpy(dest, source, data);                dest[data] = '\0'; /* strncpy() does not always NULL terminate */            }            printLine(dest);        }    }
int data = *dataPtr2;
int data = *dataPtr2;
int
data = *dataPtr2
data
= *dataPtr2
*dataPtr2
dataPtr2
dataPtr2
{            char source[100];            char dest[100] = "";            memset(source, 'A', 100-1);            source[100-1] = '\0';            if (data < 100)            {                /* POTENTIAL FLAW: data is interpreted as an unsigned int - if its value is negative,                 * the sign conversion could result in a very large number */                strncpy(dest, source, data);                dest[data] = '\0'; /* strncpy() does not always NULL terminate */            }            printLine(dest);        }
char source[100];
char source[100];
char
source[100]
source
[100]
100
char dest[100] = "";
char dest[100] = "";
char
dest[100] = ""
dest
[100]
100
= ""
""
memset(source, 'A', 100-1);
memset(source, 'A', 100-1)
memset
memset
source
source
'A'
100-1
100
1
source[100-1] = '\0';
source[100-1] = '\0'
source[100-1]
source
source
100-1
100
1
'\0'
if (data < 100)            {                /* POTENTIAL FLAW: data is interpreted as an unsigned int - if its value is negative,                 * the sign conversion could result in a very large number */                strncpy(dest, source, data);                dest[data] = '\0'; /* strncpy() does not always NULL terminate */            }
data < 100
data
data
100
{                /* POTENTIAL FLAW: data is interpreted as an unsigned int - if its value is negative,                 * the sign conversion could result in a very large number */                strncpy(dest, source, data);                dest[data] = '\0'; /* strncpy() does not always NULL terminate */            }
strncpy(dest, source, data);
strncpy(dest, source, data)
strncpy
strncpy
dest
dest
source
source
data
data
dest[data] = '\0';
dest[data] = '\0'
dest[data]
dest
dest
data
data
'\0'
printLine(dest);
printLine(dest)
printLine
printLine
dest
dest
-----joern-----
(69,66,0)
(67,24,0)
(45,9,0)
(34,0,0)
(80,17,0)
(85,66,0)
(59,50,0)
(47,10,0)
(63,45,0)
(87,6,0)
(78,58,0)
(24,68,0)
(0,31,0)
(79,47,0)
(2,9,0)
(66,69,0)
(49,18,0)
(84,22,0)
(86,75,0)
(43,33,0)
(18,24,0)
(41,69,0)
(62,6,0)
(48,75,0)
(70,45,0)
(13,1,0)
(23,22,0)
(11,61,0)
(6,1,0)
(7,26,0)
(25,6,0)
(26,15,0)
(44,86,0)
(25,8,0)
(8,6,0)
(24,1,0)
(16,3,0)
(83,6,0)
(46,31,0)
(68,24,0)
(39,70,0)
(10,69,0)
(54,65,0)
(81,8,0)
(26,21,0)
(86,65,0)
(22,24,0)
(82,10,0)
(38,8,0)
(30,77,0)
(20,31,0)
(18,40,0)
(42,15,0)
(43,70,0)
(61,15,0)
(18,8,0)
(64,58,0)
(12,15,0)
(69,9,0)
(68,3,0)
(74,3,0)
(35,43,0)
(17,57,0)
(32,18,0)
(71,15,0)
(51,58,0)
(4,18,0)
(29,74,0)
(10,9,0)
(72,78,0)
(27,21,0)
(31,70,0)
(33,28,0)
(66,61,0)
(36,78,0)
(73,45,0)
(76,77,0)
(77,24,0)
(5,31,0)
(61,56,0)
(9,15,0)
(1,15,0)
(3,74,0)
(56,61,0)
(78,6,0)
(58,78,0)
(37,56,0)
(53,33,0)
(47,61,0)
(19,75,0)
(52,25,0)
(10,33,0)
(60,70,0)
(33,43,0)
(50,40,0)
(77,50,0)
(65,6,0)
(31,0,0)
(14,68,0)
(21,26,0)
(75,86,0)
(77,8,0)
(3,15,0)
(5,20,1)
(21,27,1)
(69,66,1)
(30,18,1)
(14,67,1)
(74,29,1)
(26,21,1)
(77,24,1)
(86,75,1)
(78,58,1)
(58,51,1)
(84,65,1)
(68,3,1)
(85,41,1)
(3,74,1)
(80,0,1)
(20,46,1)
(79,17,1)
(77,8,1)
(31,5,1)
(41,26,1)
(35,53,1)
(66,85,1)
(52,22,1)
(38,24,1)
(77,76,1)
(18,24,1)
(25,52,1)
(56,37,1)
(43,70,1)
(16,61,1)
(32,49,1)
(66,61,1)
(22,24,1)
(24,68,1)
(76,30,1)
(81,38,1)
(25,8,1)
(10,33,1)
(47,61,1)
(27,7,1)
(70,39,1)
(60,69,1)
(64,36,1)
(65,54,1)
(23,84,1)
(49,4,1)
(34,31,1)
(54,86,1)
(55,25,1)
(8,81,1)
(43,35,1)
(75,48,1)
(61,56,1)
(39,60,1)
(53,0,1)
(31,70,1)
(18,32,1)
(0,31,1)
(51,64,1)
(68,14,1)
(18,8,1)
(72,8,1)
(47,79,1)
(82,47,1)
(10,82,1)
(48,19,1)
(37,11,1)
(33,43,1)
(22,23,1)
(50,59,1)
(19,44,1)
(29,16,1)
(46,70,1)
(67,10,1)
(4,22,1)
(7,3,1)
(44,78,1)
(79,33,1)
(36,72,1)
(17,80,1)
(0,34,1)
(59,77,1)
(10,69,1)
(52,50,1)
(18,22,2)
(59,22,2)
(49,22,2)
(66,61,2)
(4,22,2)
(26,21,2)
(53,0,2)
(50,22,2)
(78,58,2)
(77,22,2)
(47,61,2)
(35,0,2)
(31,70,2)
(69,66,2)
(0,31,2)
(76,22,2)
(43,0,2)
(77,24,2)
(25,8,2)
(18,24,2)
(80,0,2)
(30,22,2)
(3,74,2)
(10,33,2)
(18,8,2)
(24,68,2)
(77,8,2)
(61,56,2)
(22,24,2)
(43,70,2)
(33,43,2)
(33,0,2)
(10,69,2)
(32,22,2)
(86,75,2)
(17,0,2)
(68,3,2)
-----------------------------------
(0,fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin)
(1,)
(2,data)
(3,*dataPtr2 = &data)
(4,dest)
(5,stdin)
(6,)
(7,data)
(8,dest[100] = "")
(9,)
(10,*dataPtr1 = data)
(11,dataPtr1)
(12,dataPtr2)
(13,data)
(14,dataPtr2)
(15,)
(16,dataPtr2)
(17,printLine("fgets()
(18,strncpy(dest, source, data)
(19,100)
(20,CHAR_ARRAY_SIZE)
(21,-1)
(22,data < 100)
(23,100)
(24,data = *dataPtr2)
(25,printLine(dest)
(26,data = -1)
(27,1)
(28,)
(29,data)
(30,dest)
(31,fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin)
(32,data)
(33,data = atoi(inputBuffer)
(34,NULL)
(35,inputBuffer)
(36,\\\'A\\\')
(37,data)
(38,dest)
(39,"")
(40,)
(41,data)
(42,dataPtr1)
(43,atoi(inputBuffer)
(44,source)
(45,)
(46,inputBuffer)
(47,*dataPtr1)
(48,1)
(49,source)
(50,dest[data] = \\\'\\\\0\\\')
(51,1)
(52,dest)
(53,data)
(54,\\\'\\\\0\\\')
(55,RET)
(56,&data)
(57,)
(58,100-1)
(59,\\\'\\\\0\\\')
(60,inputBuffer)
(61,*dataPtr1 = &data)
(62,dest)
(63,inputBuffer)
(64,100)
(65,source[100-1] = \\\'\\\\0\\\')
(66,*dataPtr1)
(67,data)
(68,*dataPtr2)
(69,data = *dataPtr1)
(70,inputBuffer[CHAR_ARRAY_SIZE] = "")
(71,data)
(72,source)
(73,if (fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin)
(74,&data)
(75,100-1)
(76,data)
(77,dest[data])
(78,memset(source, \\\'A\\\', 100-1)
(79,dataPtr1)
(80,"fgets()
(81,"")
(82,data)
(83,if (data < 100)
(84,data)
(85,dataPtr1)
(86,source[100-1])
(87,source)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^