-----label-----
1
-----code-----
void CWE194_Unexpected_Sign_Extension__negative_memmove_32_bad()
{
    short data;
    short *dataPtr1 = &data;
    short *dataPtr2 = &data;
    /* Initialize data */
    data = 0;
    {
        short data = *dataPtr1;
        /* FLAW: Use a negative number */
        data = -1;
        *dataPtr1 = data;
    }
    {
        short data = *dataPtr2;
        {
            char source[100];
            char dest[100] = "";
            memset(source, 'A', 100-1);
            source[100-1] = '\0';
            if (data < 100)
            {
                /* POTENTIAL FLAW: data is interpreted as an unsigned int - if its value is negative,
                 * the sign extension could result in a very large number */
                memmove(dest, source, data);
                dest[data] = '\0'; /* NULL terminate */
            }
            printLine(dest);
        }
    }
}
-----children-----
1,2
1,3
1,4
3,4
5,6
5,7
5,8
5,9
5,10
5,11
6,7
7,8
7,9
9,10
11,12
12,13
12,14
14,15
14,16
14,17
17,18
18,19
19,20
21,22
22,23
22,24
24,25
24,26
24,27
27,28
28,29
29,30
31,32
32,33
32,34
33,34
36,37
36,38
36,39
37,38
38,39
38,40
40,41
40,42
42,43
43,44
44,45
46,47
47,48
47,49
48,49
50,51
52,53
53,54
53,55
54,55
55,56
57,58
59,60
59,61
60,61
61,62
61,63
63,64
63,65
65,66
66,67
67,68
69,70
69,71
69,72
69,73
69,74
69,75
70,71
71,72
71,73
73,74
73,75
75,76
77,78
78,79
78,80
80,81
80,82
80,83
82,83
84,85
86,87
87,88
87,89
87,90
87,91
88,89
90,91
93,94
93,95
96,97
97,98
97,99
98,99
98,100
99,100
101,102
101,103
105,106
105,107
106,107
106,108
107,108
110,111
110,112
111,112
112,113
112,114
112,115
112,116
113,114
115,116
117,118
119,120
121,122
122,123
122,124
123,124
123,125
124,125
126,127
129,130
130,131
130,132
131,132
133,134
-----nextToken-----
2,4,8,10,13,15,16,20,23,25,26,30,34,35,39,41,45,49,51,56,58,62,64,68,72,74,76,79,81,83,85,89,91,92,94,95,100,102,103,104,108,109,114,116,118,120,125,127,128,132,134
-----computeFrom-----
32,33
32,34
47,48
47,49
53,54
53,55
93,94
93,95
97,98
97,99
101,102
101,103
106,107
106,108
122,123
122,124
-----guardedBy-----
108,127
-----guardedByNegation-----
-----lastLexicalUse-----
-----jump-----
-----attribute-----
FunctionDefinition;SimpleDeclSpecifier;FunctionDeclarator;Name;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Name;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Pointer;Name;EqualsInitializer;UnaryExpression;IdExpression;Name;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Pointer;Name;EqualsInitializer;UnaryExpression;IdExpression;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;LiteralExpression;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Name;EqualsInitializer;UnaryExpression;IdExpression;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;UnaryExpression;LiteralExpression;ExpressionStatement;BinaryExpression;UnaryExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Name;EqualsInitializer;UnaryExpression;IdExpression;Name;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;ArrayDeclarator;Name;ArrayModifier;LiteralExpression;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;ArrayDeclarator;Name;ArrayModifier;LiteralExpression;EqualsInitializer;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;LiteralExpression;BinaryExpression;LiteralExpression;LiteralExpression;ExpressionStatement;BinaryExpression;ArraySubscriptExpression;IdExpression;Name;BinaryExpression;LiteralExpression;LiteralExpression;LiteralExpression;IfStatement;BinaryExpression;IdExpression;Name;LiteralExpression;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;IdExpression;Name;ExpressionStatement;BinaryExpression;ArraySubscriptExpression;IdExpression;Name;IdExpression;Name;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;
-----ast_node-----
void CWE194_Unexpected_Sign_Extension__negative_memmove_32_bad(){    short data;    short *dataPtr1 = &data;    short *dataPtr2 = &data;    /* Initialize data */    data = 0;    {        short data = *dataPtr1;        /* FLAW: Use a negative number */        data = -1;        *dataPtr1 = data;    }    {        short data = *dataPtr2;        {            char source[100];            char dest[100] = "";            memset(source, 'A', 100-1);            source[100-1] = '\0';            if (data < 100)            {                /* POTENTIAL FLAW: data is interpreted as an unsigned int - if its value is negative,                 * the sign extension could result in a very large number */                memmove(dest, source, data);                dest[data] = '\0'; /* NULL terminate */            }            printLine(dest);        }    }}
void
CWE194_Unexpected_Sign_Extension__negative_memmove_32_bad()
CWE194_Unexpected_Sign_Extension__negative_memmove_32_bad
{    short data;    short *dataPtr1 = &data;    short *dataPtr2 = &data;    /* Initialize data */    data = 0;    {        short data = *dataPtr1;        /* FLAW: Use a negative number */        data = -1;        *dataPtr1 = data;    }    {        short data = *dataPtr2;        {            char source[100];            char dest[100] = "";            memset(source, 'A', 100-1);            source[100-1] = '\0';            if (data < 100)            {                /* POTENTIAL FLAW: data is interpreted as an unsigned int - if its value is negative,                 * the sign extension could result in a very large number */                memmove(dest, source, data);                dest[data] = '\0'; /* NULL terminate */            }            printLine(dest);        }    }}
short data;
short data;
short
data
data
short *dataPtr1 = &data;
short *dataPtr1 = &data;
short
*dataPtr1 = &data
*
dataPtr1
= &data
&data
data
data
short *dataPtr2 = &data;
short *dataPtr2 = &data;
short
*dataPtr2 = &data
*
dataPtr2
= &data
&data
data
data
data = 0;
data = 0
data
data
0
{        short data = *dataPtr1;        /* FLAW: Use a negative number */        data = -1;        *dataPtr1 = data;    }
short data = *dataPtr1;
short data = *dataPtr1;
short
data = *dataPtr1
data
= *dataPtr1
*dataPtr1
dataPtr1
dataPtr1
data = -1;
data = -1
data
data
-1
1
*dataPtr1 = data;
*dataPtr1 = data
*dataPtr1
dataPtr1
dataPtr1
data
data
{        short data = *dataPtr2;        {            char source[100];            char dest[100] = "";            memset(source, 'A', 100-1);            source[100-1] = '\0';            if (data < 100)            {                /* POTENTIAL FLAW: data is interpreted as an unsigned int - if its value is negative,                 * the sign extension could result in a very large number */                memmove(dest, source, data);                dest[data] = '\0'; /* NULL terminate */            }            printLine(dest);        }    }
short data = *dataPtr2;
short data = *dataPtr2;
short
data = *dataPtr2
data
= *dataPtr2
*dataPtr2
dataPtr2
dataPtr2
{            char source[100];            char dest[100] = "";            memset(source, 'A', 100-1);            source[100-1] = '\0';            if (data < 100)            {                /* POTENTIAL FLAW: data is interpreted as an unsigned int - if its value is negative,                 * the sign extension could result in a very large number */                memmove(dest, source, data);                dest[data] = '\0'; /* NULL terminate */            }            printLine(dest);        }
char source[100];
char source[100];
char
source[100]
source
[100]
100
char dest[100] = "";
char dest[100] = "";
char
dest[100] = ""
dest
[100]
100
= ""
""
memset(source, 'A', 100-1);
memset(source, 'A', 100-1)
memset
memset
source
source
'A'
100-1
100
1
source[100-1] = '\0';
source[100-1] = '\0'
source[100-1]
source
source
100-1
100
1
'\0'
if (data < 100)            {                /* POTENTIAL FLAW: data is interpreted as an unsigned int - if its value is negative,                 * the sign extension could result in a very large number */                memmove(dest, source, data);                dest[data] = '\0'; /* NULL terminate */            }
data < 100
data
data
100
{                /* POTENTIAL FLAW: data is interpreted as an unsigned int - if its value is negative,                 * the sign extension could result in a very large number */                memmove(dest, source, data);                dest[data] = '\0'; /* NULL terminate */            }
memmove(dest, source, data);
memmove(dest, source, data)
memmove
memmove
dest
dest
source
source
data
data
dest[data] = '\0';
dest[data] = '\0'
dest[data]
dest
dest
data
data
'\0'
printLine(dest);
printLine(dest)
printLine
printLine
dest
dest
-----joern-----
(23,12,0)
(0,1,0)
(17,32,0)
(69,27,0)
(54,31,0)
(64,39,0)
(7,31,0)
(19,43,0)
(40,43,0)
(47,38,0)
(3,65,0)
(15,1,0)
(53,34,0)
(58,40,0)
(62,34,0)
(27,39,0)
(65,43,0)
(0,39,0)
(8,24,0)
(0,32,0)
(37,2,0)
(42,67,0)
(67,60,0)
(32,49,0)
(14,30,0)
(52,6,0)
(46,2,0)
(16,68,0)
(50,0,0)
(64,23,0)
(18,35,0)
(39,65,0)
(39,64,0)
(68,49,0)
(61,26,0)
(5,68,0)
(56,27,0)
(59,31,0)
(22,62,0)
(21,43,0)
(51,68,0)
(26,35,0)
(68,39,0)
(1,31,0)
(36,54,0)
(6,30,0)
(24,19,0)
(41,1,0)
(30,62,0)
(19,24,0)
(30,38,0)
(66,43,0)
(68,1,0)
(23,43,0)
(67,38,0)
(60,19,0)
(45,64,0)
(2,46,0)
(12,23,0)
(60,67,0)
(33,46,0)
(57,12,0)
(38,43,0)
(34,62,0)
(44,40,0)
(28,35,0)
(29,48,0)
(48,1,0)
(11,19,0)
(46,54,0)
(35,26,0)
(55,2,0)
(35,31,0)
(70,0,0)
(6,19,0)
(62,38,0)
(48,31,0)
(20,23,0)
(31,65,0)
(13,43,0)
(4,26,0)
(9,31,0)
(63,60,0)
(10,39,0)
(39,64,1)
(44,23,1)
(27,56,1)
(68,39,1)
(23,12,1)
(6,52,1)
(34,53,1)
(45,10,1)
(69,54,1)
(63,42,1)
(32,17,1)
(64,23,1)
(0,39,1)
(51,27,1)
(54,36,1)
(16,5,1)
(4,61,1)
(68,16,1)
(50,70,1)
(22,67,1)
(29,27,1)
(8,11,1)
(28,1,1)
(25,48,1)
(52,62,1)
(0,50,1)
(20,19,1)
(46,2,1)
(62,34,1)
(1,15,1)
(5,51,1)
(57,20,1)
(17,0,1)
(2,37,1)
(19,24,1)
(30,14,1)
(33,35,1)
(58,44,1)
(41,39,1)
(48,29,1)
(37,55,1)
(14,6,1)
(53,22,1)
(55,33,1)
(36,46,1)
(12,57,1)
(18,28,1)
(48,1,1)
(56,69,1)
(24,8,1)
(30,62,1)
(0,1,1)
(29,32,1)
(35,26,1)
(60,63,1)
(68,1,1)
(42,40,1)
(60,19,1)
(27,39,1)
(26,4,1)
(15,41,1)
(61,18,1)
(67,60,1)
(40,58,1)
(64,45,1)
(70,68,1)
(10,30,1)
(6,19,1)
(0,27,2)
(67,60,2)
(50,27,2)
(51,27,2)
(5,27,2)
(35,26,2)
(0,1,2)
(68,1,2)
(30,62,2)
(70,27,2)
(16,27,2)
(48,1,2)
(0,39,2)
(60,19,2)
(23,12,2)
(32,27,2)
(19,24,2)
(17,27,2)
(39,64,2)
(68,39,2)
(46,2,2)
(6,19,2)
(64,23,2)
(27,39,2)
(62,34,2)
(68,27,2)
-----------------------------------
(0,dest[data])
(1,dest[100] = "")
(2,100-1)
(3,data)
(4,1)
(5,source)
(6,*dataPtr1)
(7,source)
(8,data)
(9,dest)
(10,data)
(11,dataPtr1)
(12,&data)
(13,data)
(14,data)
(15,"")
(16,data)
(17,\\\'\\\\0\\\')
(18,\\\'A\\\')
(19,*dataPtr1 = &data)
(20,dataPtr2)
(21,dataPtr2)
(22,data)
(23,*dataPtr2 = &data)
(24,&data)
(25,RET)
(26,100-1)
(27,data < 100)
(28,source)
(29,dest)
(30,*dataPtr1 = data)
(31,)
(32,dest[data] = \\\'\\\\0\\\')
(33,source)
(34,-1)
(35,memset(source, \\\'A\\\', 100-1)
(36,\\\'\\\\0\\\')
(37,1)
(38,)
(39,data = *dataPtr2)
(40,data = 0)
(41,dest)
(42,data)
(43,)
(44,data)
(45,dataPtr2)
(46,source[100-1])
(47,data)
(48,printLine(dest)
(49,)
(50,data)
(51,dest)
(52,dataPtr1)
(53,1)
(54,source[100-1] = \\\'\\\\0\\\')
(55,100)
(56,100)
(57,data)
(58,0)
(59,if (data < 100)
(60,*dataPtr1)
(61,100)
(62,data = -1)
(63,dataPtr1)
(64,*dataPtr2)
(65,)
(66,dataPtr1)
(67,data = *dataPtr1)
(68,memmove(dest, source, data)
(69,data)
(70,dest)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^