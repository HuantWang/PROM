-----label-----
1
-----code-----
void CWE194_Unexpected_Sign_Extension__fgets_strncpy_17_bad()
{
    int i;
    short data;
    /* Initialize data */
    data = 0;
    for(i = 0; i < 1; i++)
    {
        {
            char inputBuffer[CHAR_ARRAY_SIZE] = "";
            /* FLAW: Use a value input from the console using fgets() */
            if (fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin) != NULL)
            {
                /* Convert to short */
                data = (short)atoi(inputBuffer);
            }
            else
            {
                printLine("fgets() failed.");
            }
        }
    }
    {
        char source[100];
        char dest[100] = "";
        memset(source, 'A', 100-1);
        source[100-1] = '\0';
        if (data < 100)
        {
            /* POTENTIAL FLAW: data is interpreted as an unsigned int - if its value is negative,
             * the sign extension could result in a very large number */
            strncpy(dest, source, data);
            dest[data] = '\0'; /* strncpy() does not always NULL terminate */
        }
        printLine(dest);
    }
}
-----children-----
1,2
1,3
1,4
3,4
5,6
5,7
5,8
5,9
5,10
6,7
7,8
7,9
9,10
11,12
12,13
12,14
14,15
16,17
17,18
17,19
18,19
21,22
21,23
21,24
21,25
22,23
23,24
23,25
24,25
27,28
27,29
28,29
31,32
32,33
34,35
35,36
35,37
36,37
37,38
37,39
39,40
39,41
39,42
41,42
42,43
44,45
46,47
46,48
46,49
47,48
47,49
48,49
48,50
48,51
48,52
49,50
51,52
53,54
55,56
57,58
59,60
60,61
61,62
61,63
62,63
64,65
64,66
65,66
65,67
68,69
68,70
69,70
71,72
73,74
74,75
75,76
75,77
76,77
79,80
79,81
79,82
79,83
79,84
79,85
80,81
81,82
81,83
83,84
83,85
85,86
87,88
88,89
88,90
90,91
90,92
90,93
92,93
94,95
96,97
97,98
97,99
97,100
97,101
98,99
100,101
103,104
103,105
106,107
107,108
107,109
108,109
108,110
109,110
111,112
111,113
115,116
115,117
116,117
116,118
117,118
120,121
120,122
121,122
122,123
122,124
122,125
122,126
123,124
125,126
127,128
129,130
131,132
132,133
132,134
133,134
133,135
134,135
136,137
139,140
140,141
140,142
141,142
143,144
-----nextToken-----
2,4,8,10,13,15,19,20,25,26,29,30,33,38,40,43,45,50,52,54,56,58,63,66,67,70,72,77,78,82,84,86,89,91,93,95,99,101,102,104,105,110,112,113,114,118,119,124,126,128,130,135,137,138,142,144
-----computeFrom-----
17,18
17,19
23,24
23,25
27,28
27,29
47,48
47,49
61,62
61,63
103,104
103,105
107,108
107,109
111,112
111,113
116,117
116,118
132,133
132,134
-----guardedBy-----
52,72
118,137
-----guardedByNegation-----
-----lastLexicalUse-----
-----jump-----
-----attribute-----
FunctionDefinition;SimpleDeclSpecifier;FunctionDeclarator;Name;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Name;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;LiteralExpression;ForStatement;ExpressionStatement;BinaryExpression;IdExpression;Name;LiteralExpression;BinaryExpression;IdExpression;Name;LiteralExpression;UnaryExpression;IdExpression;Name;CompoundStatement;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;ArrayDeclarator;Name;ArrayModifier;IdExpression;Name;EqualsInitializer;LiteralExpression;IfStatement;BinaryExpression;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;IdExpression;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;BinaryExpression;IdExpression;Name;CastExpression;TypeId;SimpleDeclSpecifier;Declarator;FunctionCallExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;LiteralExpression;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;ArrayDeclarator;Name;ArrayModifier;LiteralExpression;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;ArrayDeclarator;Name;ArrayModifier;LiteralExpression;EqualsInitializer;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;LiteralExpression;BinaryExpression;LiteralExpression;LiteralExpression;ExpressionStatement;BinaryExpression;ArraySubscriptExpression;IdExpression;Name;BinaryExpression;LiteralExpression;LiteralExpression;LiteralExpression;IfStatement;BinaryExpression;IdExpression;Name;LiteralExpression;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;IdExpression;Name;ExpressionStatement;BinaryExpression;ArraySubscriptExpression;IdExpression;Name;IdExpression;Name;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;
-----ast_node-----
void CWE194_Unexpected_Sign_Extension__fgets_strncpy_17_bad(){    int i;    short data;    /* Initialize data */    data = 0;    for(i = 0; i < 1; i++)    {        {            char inputBuffer[CHAR_ARRAY_SIZE] = "";            /* FLAW: Use a value input from the console using fgets() */            if (fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin) != NULL)            {                /* Convert to short */                data = (short)atoi(inputBuffer);            }            else            {                printLine("fgets() failed.");            }        }    }    {        char source[100];        char dest[100] = "";        memset(source, 'A', 100-1);        source[100-1] = '\0';        if (data < 100)        {            /* POTENTIAL FLAW: data is interpreted as an unsigned int - if its value is negative,             * the sign extension could result in a very large number */            strncpy(dest, source, data);            dest[data] = '\0'; /* strncpy() does not always NULL terminate */        }        printLine(dest);    }}
void
CWE194_Unexpected_Sign_Extension__fgets_strncpy_17_bad()
CWE194_Unexpected_Sign_Extension__fgets_strncpy_17_bad
{    int i;    short data;    /* Initialize data */    data = 0;    for(i = 0; i < 1; i++)    {        {            char inputBuffer[CHAR_ARRAY_SIZE] = "";            /* FLAW: Use a value input from the console using fgets() */            if (fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin) != NULL)            {                /* Convert to short */                data = (short)atoi(inputBuffer);            }            else            {                printLine("fgets() failed.");            }        }    }    {        char source[100];        char dest[100] = "";        memset(source, 'A', 100-1);        source[100-1] = '\0';        if (data < 100)        {            /* POTENTIAL FLAW: data is interpreted as an unsigned int - if its value is negative,             * the sign extension could result in a very large number */            strncpy(dest, source, data);            dest[data] = '\0'; /* strncpy() does not always NULL terminate */        }        printLine(dest);    }}
int i;
int i;
int
i
i
short data;
short data;
short
data
data
data = 0;
data = 0
data
data
0
for(i = 0; i < 1; i++)    {        {            char inputBuffer[CHAR_ARRAY_SIZE] = "";            /* FLAW: Use a value input from the console using fgets() */            if (fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin) != NULL)            {                /* Convert to short */                data = (short)atoi(inputBuffer);            }            else            {                printLine("fgets() failed.");            }        }    }
i = 0;
i = 0
i
i
0
i < 1
i
i
1
i++
i
i
{        {            char inputBuffer[CHAR_ARRAY_SIZE] = "";            /* FLAW: Use a value input from the console using fgets() */            if (fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin) != NULL)            {                /* Convert to short */                data = (short)atoi(inputBuffer);            }            else            {                printLine("fgets() failed.");            }        }    }
{            char inputBuffer[CHAR_ARRAY_SIZE] = "";            /* FLAW: Use a value input from the console using fgets() */            if (fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin) != NULL)            {                /* Convert to short */                data = (short)atoi(inputBuffer);            }            else            {                printLine("fgets() failed.");            }        }
char inputBuffer[CHAR_ARRAY_SIZE] = "";
char inputBuffer[CHAR_ARRAY_SIZE] = "";
char
inputBuffer[CHAR_ARRAY_SIZE] = ""
inputBuffer
[CHAR_ARRAY_SIZE]
CHAR_ARRAY_SIZE
CHAR_ARRAY_SIZE
= ""
""
if (fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin) != NULL)            {                /* Convert to short */                data = (short)atoi(inputBuffer);            }            else            {                printLine("fgets() failed.");            }
fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin) != NULL
fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin)
fgets
fgets
inputBuffer
inputBuffer
CHAR_ARRAY_SIZE
CHAR_ARRAY_SIZE
stdin
stdin
NULL
NULL
{                /* Convert to short */                data = (short)atoi(inputBuffer);            }
data = (short)atoi(inputBuffer);
data = (short)atoi(inputBuffer)
data
data
(short)atoi(inputBuffer)
short
short

atoi(inputBuffer)
atoi
atoi
inputBuffer
inputBuffer
{                printLine("fgets() failed.");            }
printLine("fgets() failed.");
printLine("fgets() failed.")
printLine
printLine
"fgets() failed."
{        char source[100];        char dest[100] = "";        memset(source, 'A', 100-1);        source[100-1] = '\0';        if (data < 100)        {            /* POTENTIAL FLAW: data is interpreted as an unsigned int - if its value is negative,             * the sign extension could result in a very large number */            strncpy(dest, source, data);            dest[data] = '\0'; /* strncpy() does not always NULL terminate */        }        printLine(dest);    }
char source[100];
char source[100];
char
source[100]
source
[100]
100
char dest[100] = "";
char dest[100] = "";
char
dest[100] = ""
dest
[100]
100
= ""
""
memset(source, 'A', 100-1);
memset(source, 'A', 100-1)
memset
memset
source
source
'A'
100-1
100
1
source[100-1] = '\0';
source[100-1] = '\0'
source[100-1]
source
source
100-1
100
1
'\0'
if (data < 100)        {            /* POTENTIAL FLAW: data is interpreted as an unsigned int - if its value is negative,             * the sign extension could result in a very large number */            strncpy(dest, source, data);            dest[data] = '\0'; /* strncpy() does not always NULL terminate */        }
data < 100
data
data
100
{            /* POTENTIAL FLAW: data is interpreted as an unsigned int - if its value is negative,             * the sign extension could result in a very large number */            strncpy(dest, source, data);            dest[data] = '\0'; /* strncpy() does not always NULL terminate */        }
strncpy(dest, source, data);
strncpy(dest, source, data)
strncpy
strncpy
dest
dest
source
source
data
data
dest[data] = '\0';
dest[data] = '\0'
dest[data]
dest
dest
data
data
'\0'
printLine(dest);
printLine(dest)
printLine
printLine
dest
dest
-----joern-----
(19,18,0)
(21,25,0)
(11,71,0)
(72,18,0)
(31,45,0)
(42,18,0)
(17,58,0)
(44,4,0)
(5,64,0)
(54,46,0)
(9,19,0)
(58,65,0)
(31,62,0)
(25,19,0)
(38,34,0)
(26,57,0)
(71,11,0)
(25,57,0)
(40,44,0)
(31,44,0)
(51,29,0)
(32,62,0)
(31,29,0)
(48,64,0)
(64,45,0)
(23,45,0)
(8,34,0)
(53,32,0)
(50,0,0)
(23,51,0)
(20,56,0)
(22,11,0)
(12,63,0)
(60,42,0)
(15,31,0)
(35,45,0)
(47,38,0)
(33,50,0)
(36,62,0)
(67,31,0)
(70,65,0)
(16,45,0)
(55,71,0)
(58,17,0)
(3,56,0)
(6,60,0)
(23,62,0)
(30,51,0)
(28,50,0)
(66,18,0)
(1,57,0)
(52,60,0)
(42,60,0)
(64,44,0)
(43,71,0)
(44,58,0)
(14,71,0)
(24,46,0)
(65,33,0)
(37,42,0)
(41,34,0)
(10,31,0)
(39,50,0)
(69,46,0)
(58,44,0)
(23,44,0)
(71,33,0)
(63,73,0)
(61,33,0)
(27,23,0)
(65,58,0)
(62,18,0)
(2,42,0)
(59,23,0)
(13,62,0)
(7,18,0)
(45,46,0)
(32,18,0)
(56,34,0)
(68,33,0)
(18,46,0)
(57,25,0)
(31,45,1)
(55,33,1)
(41,45,1)
(6,2,1)
(56,3,1)
(1,26,1)
(14,55,1)
(63,12,1)
(67,10,1)
(58,65,1)
(68,61,1)
(26,21,1)
(31,44,1)
(5,48,1)
(23,59,1)
(43,14,1)
(9,25,1)
(32,53,1)
(38,47,1)
(40,11,1)
(11,71,1)
(32,62,1)
(56,34,1)
(13,36,1)
(30,23,1)
(59,27,1)
(48,19,1)
(37,62,1)
(61,56,1)
(23,62,1)
(20,34,1)
(71,33,1)
(45,16,1)
(47,44,1)
(64,44,1)
(38,34,1)
(36,56,1)
(20,38,1)
(16,35,1)
(65,70,1)
(23,44,1)
(21,42,1)
(33,68,1)
(34,8,1)
(23,45,1)
(47,63,1)
(49,32,1)
(42,60,1)
(64,5,1)
(65,33,1)
(57,1,1)
(3,20,1)
(44,58,1)
(31,15,1)
(58,17,1)
(62,13,1)
(11,22,1)
(19,9,1)
(25,57,1)
(31,62,1)
(8,41,1)
(12,11,1)
(53,64,1)
(15,67,1)
(64,45,1)
(60,52,1)
(53,51,1)
(51,30,1)
(27,31,1)
(52,6,1)
(70,40,1)
(10,64,1)
(71,43,1)
(22,71,1)
(2,37,1)
(51,64,2)
(11,71,2)
(58,17,2)
(56,56,2)
(25,57,2)
(43,56,2)
(63,11,2)
(55,56,2)
(58,65,2)
(70,11,2)
(71,33,2)
(38,34,2)
(31,45,2)
(23,62,2)
(12,11,2)
(32,62,2)
(31,62,2)
(23,64,2)
(68,56,2)
(15,64,2)
(61,56,2)
(64,45,2)
(27,64,2)
(23,45,2)
(67,64,2)
(71,56,2)
(59,64,2)
(3,56,2)
(30,64,2)
(65,33,2)
(31,44,2)
(44,11,2)
(38,56,2)
(42,60,2)
(64,44,2)
(40,11,2)
(14,56,2)
(44,58,2)
(58,11,2)
(31,64,2)
(11,56,2)
(33,56,2)
(20,56,2)
(65,11,2)
(47,56,2)
(10,64,2)
(56,34,2)
(22,56,2)
(23,44,2)
-----------------------------------
(0,)
(1,1)
(2,\\\'A\\\')
(3,1)
(4,)
(5,100)
(6,100)
(7,dest)
(8,0)
(9,\\\'\\\\0\\\')
(10,dest)
(11,fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin)
(12,"fgets()
(13,"")
(14,CHAR_ARRAY_SIZE)
(15,data)
(16,0)
(17,short)
(18,)
(19,source[100-1] = \\\'\\\\0\\\')
(20,i)
(21,source)
(22,NULL)
(23,dest[data])
(24,data)
(25,source[100-1])
(26,100)
(27,dest)
(28,inputBuffer)
(29,)
(30,\\\'\\\\0\\\')
(31,strncpy(dest, source, data)
(32,printLine(dest)
(33,inputBuffer[CHAR_ARRAY_SIZE] = "")
(34,i = 0)
(35,data)
(36,dest)
(37,source)
(38,i++)
(39,if (fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin)
(40,data)
(41,i)
(42,memset(source, \\\'A\\\', 100-1)
(43,stdin)
(44,data = (short)
(45,data = 0)
(46,)
(47,i)
(48,data)
(49,RET)
(50,)
(51,dest[data] = \\\'\\\\0\\\')
(52,1)
(53,dest)
(54,for(i = 0; i < 1; i++)
(55,inputBuffer)
(56,i < 1)
(57,100-1)
(58,(short)
(59,data)
(60,100-1)
(61,inputBuffer)
(62,dest[100] = "")
(63,printLine("fgets()
(64,data < 100)
(65,atoi(inputBuffer)
(66,if (data < 100)
(67,source)
(68,"")
(69,i)
(70,inputBuffer)
(71,fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin)
(72,source)
(73,)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^