-----label-----
1
-----code-----
void CWE195_Signed_to_Unsigned_Conversion_Error__negative_strncpy_32_bad()
{
    int data;
    int *dataPtr1 = &data;
    int *dataPtr2 = &data;
    /* Initialize data */
    data = -1;
    {
        int data = *dataPtr1;
        /* FLAW: Use a negative number */
        data = -1;
        *dataPtr1 = data;
    }
    {
        int data = *dataPtr2;
        {
            char source[100];
            char dest[100] = "";
            memset(source, 'A', 100-1);
            source[100-1] = '\0';
            if (data < 100)
            {
                /* POTENTIAL FLAW: data is interpreted as an unsigned int - if its value is negative,
                 * the sign conversion could result in a very large number */
                strncpy(dest, source, data);
                dest[data] = '\0'; /* strncpy() does not always NULL terminate */
            }
            printLine(dest);
        }
    }
}
-----children-----
1,2
1,3
1,4
3,4
5,6
5,7
5,8
5,9
5,10
5,11
6,7
7,8
7,9
9,10
11,12
12,13
12,14
14,15
14,16
14,17
17,18
18,19
19,20
21,22
22,23
22,24
24,25
24,26
24,27
27,28
28,29
29,30
31,32
32,33
32,34
33,34
35,36
37,38
37,39
37,40
38,39
39,40
39,41
41,42
41,43
43,44
44,45
45,46
47,48
48,49
48,50
49,50
51,52
53,54
54,55
54,56
55,56
56,57
58,59
60,61
60,62
61,62
62,63
62,64
64,65
64,66
66,67
67,68
68,69
70,71
70,72
70,73
70,74
70,75
70,76
71,72
72,73
72,74
74,75
74,76
76,77
78,79
79,80
79,81
81,82
81,83
81,84
83,84
85,86
87,88
88,89
88,90
88,91
88,92
89,90
91,92
94,95
94,96
97,98
98,99
98,100
99,100
99,101
100,101
102,103
102,104
106,107
106,108
107,108
107,109
108,109
111,112
111,113
112,113
113,114
113,115
113,116
113,117
114,115
116,117
118,119
120,121
122,123
123,124
123,125
124,125
124,126
125,126
127,128
130,131
131,132
131,133
132,133
134,135
-----nextToken-----
2,4,8,10,13,15,16,20,23,25,26,30,34,36,40,42,46,50,52,57,59,63,65,69,73,75,77,80,82,84,86,90,92,93,95,96,101,103,104,105,109,110,115,117,119,121,126,128,129,133,135
-----computeFrom-----
32,33
32,34
48,49
48,50
54,55
54,56
94,95
94,96
98,99
98,100
102,103
102,104
107,108
107,109
123,124
123,125
-----guardedBy-----
109,128
-----guardedByNegation-----
-----lastLexicalUse-----
-----jump-----
-----attribute-----
FunctionDefinition;SimpleDeclSpecifier;FunctionDeclarator;Name;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Name;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Pointer;Name;EqualsInitializer;UnaryExpression;IdExpression;Name;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Pointer;Name;EqualsInitializer;UnaryExpression;IdExpression;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;UnaryExpression;LiteralExpression;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Name;EqualsInitializer;UnaryExpression;IdExpression;Name;ExpressionStatement;BinaryExpression;IdExpression;Name;UnaryExpression;LiteralExpression;ExpressionStatement;BinaryExpression;UnaryExpression;IdExpression;Name;IdExpression;Name;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;Declarator;Name;EqualsInitializer;UnaryExpression;IdExpression;Name;CompoundStatement;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;ArrayDeclarator;Name;ArrayModifier;LiteralExpression;DeclarationStatement;SimpleDeclaration;SimpleDeclSpecifier;ArrayDeclarator;Name;ArrayModifier;LiteralExpression;EqualsInitializer;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;LiteralExpression;BinaryExpression;LiteralExpression;LiteralExpression;ExpressionStatement;BinaryExpression;ArraySubscriptExpression;IdExpression;Name;BinaryExpression;LiteralExpression;LiteralExpression;LiteralExpression;IfStatement;BinaryExpression;IdExpression;Name;LiteralExpression;CompoundStatement;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;IdExpression;Name;IdExpression;Name;ExpressionStatement;BinaryExpression;ArraySubscriptExpression;IdExpression;Name;IdExpression;Name;LiteralExpression;ExpressionStatement;FunctionCallExpression;IdExpression;Name;IdExpression;Name;
-----ast_node-----
void CWE195_Signed_to_Unsigned_Conversion_Error__negative_strncpy_32_bad(){    int data;    int *dataPtr1 = &data;    int *dataPtr2 = &data;    /* Initialize data */    data = -1;    {        int data = *dataPtr1;        /* FLAW: Use a negative number */        data = -1;        *dataPtr1 = data;    }    {        int data = *dataPtr2;        {            char source[100];            char dest[100] = "";            memset(source, 'A', 100-1);            source[100-1] = '\0';            if (data < 100)            {                /* POTENTIAL FLAW: data is interpreted as an unsigned int - if its value is negative,                 * the sign conversion could result in a very large number */                strncpy(dest, source, data);                dest[data] = '\0'; /* strncpy() does not always NULL terminate */            }            printLine(dest);        }    }}
void
CWE195_Signed_to_Unsigned_Conversion_Error__negative_strncpy_32_bad()
CWE195_Signed_to_Unsigned_Conversion_Error__negative_strncpy_32_bad
{    int data;    int *dataPtr1 = &data;    int *dataPtr2 = &data;    /* Initialize data */    data = -1;    {        int data = *dataPtr1;        /* FLAW: Use a negative number */        data = -1;        *dataPtr1 = data;    }    {        int data = *dataPtr2;        {            char source[100];            char dest[100] = "";            memset(source, 'A', 100-1);            source[100-1] = '\0';            if (data < 100)            {                /* POTENTIAL FLAW: data is interpreted as an unsigned int - if its value is negative,                 * the sign conversion could result in a very large number */                strncpy(dest, source, data);                dest[data] = '\0'; /* strncpy() does not always NULL terminate */            }            printLine(dest);        }    }}
int data;
int data;
int
data
data
int *dataPtr1 = &data;
int *dataPtr1 = &data;
int
*dataPtr1 = &data
*
dataPtr1
= &data
&data
data
data
int *dataPtr2 = &data;
int *dataPtr2 = &data;
int
*dataPtr2 = &data
*
dataPtr2
= &data
&data
data
data
data = -1;
data = -1
data
data
-1
1
{        int data = *dataPtr1;        /* FLAW: Use a negative number */        data = -1;        *dataPtr1 = data;    }
int data = *dataPtr1;
int data = *dataPtr1;
int
data = *dataPtr1
data
= *dataPtr1
*dataPtr1
dataPtr1
dataPtr1
data = -1;
data = -1
data
data
-1
1
*dataPtr1 = data;
*dataPtr1 = data
*dataPtr1
dataPtr1
dataPtr1
data
data
{        int data = *dataPtr2;        {            char source[100];            char dest[100] = "";            memset(source, 'A', 100-1);            source[100-1] = '\0';            if (data < 100)            {                /* POTENTIAL FLAW: data is interpreted as an unsigned int - if its value is negative,                 * the sign conversion could result in a very large number */                strncpy(dest, source, data);                dest[data] = '\0'; /* strncpy() does not always NULL terminate */            }            printLine(dest);        }    }
int data = *dataPtr2;
int data = *dataPtr2;
int
data = *dataPtr2
data
= *dataPtr2
*dataPtr2
dataPtr2
dataPtr2
{            char source[100];            char dest[100] = "";            memset(source, 'A', 100-1);            source[100-1] = '\0';            if (data < 100)            {                /* POTENTIAL FLAW: data is interpreted as an unsigned int - if its value is negative,                 * the sign conversion could result in a very large number */                strncpy(dest, source, data);                dest[data] = '\0'; /* strncpy() does not always NULL terminate */            }            printLine(dest);        }
char source[100];
char source[100];
char
source[100]
source
[100]
100
char dest[100] = "";
char dest[100] = "";
char
dest[100] = ""
dest
[100]
100
= ""
""
memset(source, 'A', 100-1);
memset(source, 'A', 100-1)
memset
memset
source
source
'A'
100-1
100
1
source[100-1] = '\0';
source[100-1] = '\0'
source[100-1]
source
source
100-1
100
1
'\0'
if (data < 100)            {                /* POTENTIAL FLAW: data is interpreted as an unsigned int - if its value is negative,                 * the sign conversion could result in a very large number */                strncpy(dest, source, data);                dest[data] = '\0'; /* strncpy() does not always NULL terminate */            }
data < 100
data
data
100
{                /* POTENTIAL FLAW: data is interpreted as an unsigned int - if its value is negative,                 * the sign conversion could result in a very large number */                strncpy(dest, source, data);                dest[data] = '\0'; /* strncpy() does not always NULL terminate */            }
strncpy(dest, source, data);
strncpy(dest, source, data)
strncpy
strncpy
dest
dest
source
source
data
data
dest[data] = '\0';
dest[data] = '\0'
dest[data]
dest
dest
data
data
'\0'
printLine(dest);
printLine(dest)
printLine
printLine
dest
dest
-----joern-----
(61,32,0)
(8,5,0)
(37,58,0)
(69,26,0)
(0,32,0)
(62,17,0)
(13,18,0)
(59,7,0)
(2,48,0)
(19,5,0)
(44,14,0)
(17,52,0)
(10,14,0)
(67,68,0)
(16,64,0)
(26,33,0)
(41,48,0)
(9,16,0)
(49,32,0)
(45,32,0)
(50,10,0)
(11,0,0)
(8,24,0)
(58,67,0)
(64,11,0)
(43,64,0)
(63,68,0)
(24,28,0)
(1,44,0)
(25,17,0)
(29,41,0)
(30,11,0)
(12,27,0)
(42,32,0)
(67,58,0)
(28,24,0)
(3,64,0)
(60,0,0)
(33,61,0)
(25,48,0)
(38,15,0)
(52,61,0)
(44,24,0)
(51,56,0)
(65,67,0)
(46,44,0)
(55,8,0)
(22,28,0)
(27,24,0)
(52,56,0)
(66,24,0)
(33,26,0)
(34,5,0)
(53,61,0)
(64,16,0)
(21,27,0)
(17,61,0)
(5,11,0)
(18,5,0)
(47,35,0)
(7,35,0)
(48,41,0)
(4,33,0)
(31,58,0)
(35,7,0)
(40,32,0)
(70,16,0)
(20,8,0)
(26,48,0)
(39,40,0)
(44,5,0)
(15,40,0)
(23,25,0)
(54,11,0)
(57,44,0)
(56,52,0)
(8,10,0)
(48,32,0)
(24,0,0)
(28,40,0)
(68,11,0)
(40,15,0)
(71,11,0)
(7,32,0)
(36,52,0)
(18,11,0)
(38,39,1)
(19,34,1)
(28,22,1)
(55,20,1)
(67,58,1)
(31,65,1)
(28,40,1)
(33,26,1)
(39,48,1)
(47,59,1)
(35,47,1)
(68,63,1)
(27,24,1)
(25,48,1)
(66,17,1)
(26,48,1)
(40,15,1)
(17,62,1)
(4,7,1)
(44,46,1)
(41,29,1)
(59,40,1)
(22,66,1)
(8,55,1)
(25,23,1)
(26,69,1)
(64,16,1)
(63,67,1)
(70,43,1)
(58,37,1)
(21,12,1)
(18,5,1)
(37,31,1)
(48,41,1)
(1,57,1)
(27,21,1)
(3,5,1)
(65,64,1)
(24,28,1)
(13,10,1)
(15,38,1)
(17,52,1)
(6,18,1)
(52,56,1)
(8,5,1)
(12,68,1)
(13,27,1)
(50,8,1)
(18,13,1)
(29,2,1)
(46,1,1)
(69,4,1)
(57,27,1)
(23,52,1)
(5,19,1)
(20,44,1)
(44,24,1)
(34,24,1)
(43,3,1)
(44,5,1)
(36,33,1)
(10,50,1)
(7,35,1)
(62,25,1)
(8,24,1)
(9,70,1)
(16,9,1)
(56,51,1)
(51,36,1)
(26,48,2)
(10,27,2)
(25,48,2)
(48,41,2)
(8,5,2)
(46,27,2)
(8,27,2)
(44,24,2)
(24,28,2)
(20,27,2)
(17,52,2)
(44,5,2)
(64,16,2)
(7,35,2)
(8,24,2)
(1,27,2)
(50,27,2)
(55,27,2)
(33,26,2)
(44,27,2)
(57,27,2)
(28,40,2)
(27,24,2)
(67,58,2)
(40,15,2)
(52,56,2)
(18,5,2)
-----------------------------------
(0,)
(1,source)
(2,dataPtr1)
(3,source)
(4,data)
(5,dest[100] = "")
(6,RET)
(7,data = -1)
(8,dest[data])
(9,1)
(10,dest[data] = \\\'\\\\0\\\')
(11,)
(12,data)
(13,dest)
(14,)
(15,&data)
(16,100-1)
(17,*dataPtr1 = data)
(18,printLine(dest)
(19,"")
(20,dest)
(21,100)
(22,dataPtr2)
(23,dataPtr1)
(24,data = *dataPtr2)
(25,*dataPtr1)
(26,*dataPtr1)
(27,data < 100)
(28,*dataPtr2)
(29,data)
(30,source)
(31,100)
(32,)
(33,data = *dataPtr1)
(34,dest)
(35,-1)
(36,data)
(37,1)
(38,data)
(39,dataPtr2)
(40,*dataPtr2 = &data)
(41,&data)
(42,data)
(43,\\\'A\\\')
(44,strncpy(dest, source, data)
(45,dataPtr1)
(46,data)
(47,1)
(48,*dataPtr1 = &data)
(49,dataPtr2)
(50,\\\'\\\\0\\\')
(51,1)
(52,data = -1)
(53,data)
(54,if (data < 100)
(55,data)
(56,-1)
(57,dest)
(58,100-1)
(59,data)
(60,data)
(61,)
(62,data)
(63,\\\'\\\\0\\\')
(64,memset(source, \\\'A\\\', 100-1)
(65,source)
(66,data)
(67,source[100-1])
(68,source[100-1] = \\\'\\\\0\\\')
(69,dataPtr1)
(70,100)
(71,dest)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^